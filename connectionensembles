{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 87,
   "id": "b1fb8d78-96cd-44cb-8e4e-6567d3bf6f70",
   "metadata": {
    "tags": []
   },
   "outputs": [],
   "source": [
    "import pandas as pd\n",
    "import matplotlib.pyplot as plt\n",
    "import numpy as np\n",
    "from scipy import stats\n",
    "from scipy import signal\n",
    "import datetime\n",
    "# from pykalman import KalmanFilter\n",
    "import statsmodels.api as sm\n",
    "from sklearn.preprocessing import PolynomialFeatures\n",
    "from statsmodels.tsa.stattools import grangercausalitytests\n",
    "from sklearn.preprocessing import StandardScaler\n",
    "from sklearn.ensemble import IsolationForest\n",
    "from sklearn.impute import KNNImputer\n",
    "from sklearn.preprocessing import MinMaxScaler\n",
    "from scipy.stats import ks_2samp\n",
    "import xgboost as xgb\n",
    "from sklearn.ensemble import RandomForestRegressor\n",
    "from sklearn.linear_model import LinearRegression\n",
    "from sklearn.metrics import mean_squared_error, r2_score, mean_absolute_error\n",
    "from sklearn.model_selection import train_test_split\n",
    "from sklearn.preprocessing import MaxAbsScaler\n",
    "from scipy.special import inv_boxcox\n",
    "from sklearn.decomposition import PCA\n",
    "import catboost as cb\n",
    "import logging\n",
    "import lightgbm as lgb\n",
    "import json\n",
    "from io import StringIO\n",
    "from itertools import combinations\n",
    "from sklearn.metrics import mean_absolute_error, mean_squared_error, r2_score\n",
    "from scipy.stats import pearsonr\n",
    "import re\n",
    "import warnings\n",
    "import glob\n",
    "import pickle\n",
    "warnings.filterwarnings('ignore')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 88,
   "id": "16248ac3-6f07-4731-9bbc-23ad70116ecc",
   "metadata": {
    "tags": []
   },
   "outputs": [],
   "source": [
    "PRED_LEN = 1\n",
    "\n",
    "constants = {\n",
    "    'threshold': 0.07,\n",
    "    'imput_linear': True,\n",
    "    'post_process_data_mode': {\n",
    "        'Box-Cox': {'active': False},\n",
    "        'YeoJohnson': {'active': False},\n",
    "        'FirstDiff': {'active': False},\n",
    "        'Log_return': {'active': False},\n",
    "        'Log': {'active': False},\n",
    "        'None': {'active': True}}\n",
    "}\n",
    "\n",

    "PREDICTORS_PATH = f\"predictors.csv\"\n",
    "TARGET_PATH = f\"target.csv\"\n",
    "\n",
    "# Создаем шаблон для поиска файла\n",
    "search_pattern_log = '*.log'\n",
    "search_pattern_trata = 'trata*.csv'\n",
    "search_pattern_comb = '*.parquet'\n",
    "\n",
    "\n",
    "# Используем glob для поиска файла в текущей директории\n",
    "FILES_LOG = glob.glob(search_pattern_log)[0]\n",
    "FILES_TRATA = glob.glob(search_pattern_trata)[0]\n",
    "FILES_COMB = glob.glob(search_pattern_comb)[0]\n",
    "\n",
    "FILES_CONSTS = {\n",
    "    'data':FILES_TRATA,\n",
    "    'comb_models':FILES_COMB,\n",
    "    'df_predictors':PREDICTORS_PATH,\n",
    "    'df_target':TARGET_PATH\n",
    "}"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 89,
   "id": "7addf920-6e0f-4380-bfad-90ce68815167",
   "metadata": {
    "tags": []
   },
   "outputs": [],
   "source": [
    "class Model_filter:\n",
    "    def __init__(self,data):\n",
    "        self.data = data\n",
    "        self.logger = logging.getLogger('my_logger')\n",
    "        \n",
    "    def normalizer_predictions(self):\n",
    "        cols = ['Cat_data_act_pred', 'Xgb_data_act_pred', 'Lgb_data_act_pred']\n",
    "        for col in cols:\n",
    "            self.data[col] = self.data[col].apply(lambda x: pd.read_csv(StringIO(x), delim_whitespace=True, index_col=0))\n",
    "            \n",
    "    def output_model_filter(self):\n",
    "        self.logger.info(f\"Cleaned Preds and Actual in {self.__class__.__name__}\")\n",
    "        self.normalizer_predictions()\n",
    "        \n",
    "        return self.data"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 90,
   "id": "e8522542-2abc-438a-a632-a01a5289d710",
   "metadata": {
    "tags": []
   },
   "outputs": [],
   "source": [
    "class Selected_models:\n",
    "    def __init__(self, data):\n",
    "        self.data = data\n",
    "        self.top_models = None\n",
    "        self.combination_list = None\n",
    "        self.top_ensembles = None\n",
    "        self.logger = logging.getLogger('my_logger')\n",
    "        \n",
    "    def sorter_mae(self):\n",
    "        # sorted_data = self.data.copy()\n",
    "        # sorted_data['MAE'] = sorted_data['Pred'].apply(lambda x: mean_absolute_error(sorted_data['True'][0], x))\n",
    "        \n",
    "        sorted_data = self.data.sort_values(by='Mape').copy()\n",
    "        sorted_data = sorted_data.drop_duplicates(subset='Index')\n",
    "        sorted_data.reset_index(drop=True, inplace=True)\n",
    "        self.top_models = sorted_data.nsmallest(12, 'Mape')\n",
    "        return self.top_models\n",
    "        \n",
    "    def combination_models(self):\n",
    "        self.combination_list = list(combinations(self.top_models['Index'].unique(), 2)) + list(combinations(self.top_models['Index'].unique(), 3)) + list(combinations(self.top_models['Index'].unique(), 4))\n",
    "        return self.combination_list\n",
    "    \n",
    "    def final_selector(self):\n",
    "        # Инициализируем пустой список для средних значений True\n",
    "        average_pred_values = []\n",
    "\n",
    "        # Обходим каждую комбинацию\n",
    "        for combination in self.combination_list:\n",
    "            \n",
    "            # Выбираем строки, соответствующие текущей комбинации моделей\n",
    "            subset = self.top_models[self.top_models['Index'].isin(combination)]\n",
    "\n",
    "            # Считаем среднее значение по колонке 'True'\n",
    "            average_pred = subset['Pred'].mean()\n",
    "\n",
    "            # Добавляем среднее значение в список\n",
    "            average_pred_values.append(average_pred)\n",
    "\n",
    "        # Создаем датафрейм с результатами\n",
    "        result_df = pd.DataFrame({'Model Combination': self.combination_list, 'Prediction': average_pred_values, 'True': [self.top_models['True'][0]] * len(average_pred_values)})\n",
    "\n",
    "        # Вывод результата\n",
    "        result_df['Correlation'] = result_df['Prediction'].apply(lambda x: pearsonr(x, result_df['True'][0])[0])\n",
    "        result_df['Mape'] = result_df['Prediction'].apply(lambda x: np.mean(np.abs((result_df['True'][0] - np.array(x)) / result_df['True'][0])) * 100)\n",
    "        result_df['MSE'] = result_df['Prediction'].apply(lambda x: mean_squared_error(result_df['True'][0], x))\n",
    "        result_df['MAE'] = result_df['Prediction'].apply(lambda x: mean_absolute_error(result_df['True'][0], x))\n",
    "        result_df['RMSE'] = result_df['Prediction'].apply(lambda x: np.sqrt(mean_squared_error(result_df['True'][0], x)))\n",
    "        result_df['R2'] = result_df['Prediction'].apply(lambda x: r2_score(result_df['True'][0], x))\n",
    "        result_df['Ensemble_n'] = result_df['Model Combination'].apply(lambda x: len(x))\n",
    "        \n",
    "        self.top_ensembles = result_df.nlargest(1, 'Correlation')\n",
    "        self.top_ensembles.reset_index(drop=True, inplace=True)\n",
    "        \n",
    "        return self.top_ensembles\n",
    "    \n",
    "    def selected_models_output(self):\n",
    "        self.sorter_mae()\n",
    "        self.combination_models()\n",
    "        self.final_selector()\n",
    "        self.logger.info(f\"Models have been sorted in {self.__class__.__name__}\")\n",
    "        \n",
    "        return self.top_ensembles['Model Combination'][0]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 91,
   "id": "72e2192c-8fe5-4657-be0f-f5e83450cf9d",
   "metadata": {
    "tags": []
   },
   "outputs": [],
   "source": [
    "class DataFrameProcessor:\n",
    "    \n",
    "    '''\n",
    "    Class состоит из двух датафреймов, которые будут подвергается обработке для передачи в последующий класс\n",
    "    \n",
    "    Методы класса:\n",
    "    Очистка по уровню thresh\n",
    "    Линейная и Кубическая интерполяция пропущенных переменных\n",
    "    Преобразование данных по нескольким принципам, чтобы в конце рассмаотреть перфомансы решений в моделях\n",
    "    \n",
    "    df_predictors - датасет фичей\n",
    "    df_target - датасет таргета\n",
    "    '''\n",
    "    \n",
    "    def __init__(self, df_predictors, df_target, columns_predictors, constants):\n",
    "        self.df_predictors = df_predictors\n",
    "        self.df_target = df_target\n",
    "        self.columns_predictors = columns_predictors\n",
    "        self.constants = constants\n",
    "        self.retransform = None\n",
    "        self.df_combined = None\n",
    "        self.logger = logging.getLogger('my_logger')\n",
    "        \n",
    "        \n",
    "    def handle_exceptions(self, func, *args, **kwargs):\n",
    "        try:\n",
    "            return func(*args, **kwargs)\n",
    "        except ValueError as ve:\n",
    "            self.logger.error(f\"Our Value Error in {func.__name__}: {ve}\")\n",
    "        except KeyError as ke:\n",
    "            self.logger.error(f\"Our KeyError in {func.__name__}: {ke}\")\n",
    "        except Exception as e:\n",
    "            self.logger.error(f\"Ошибка в методе {func.__name__}: {e}\")\n",
    "        \n",
    "    def find_date_column(self, df):\n",
    "        # Статика на возможные колонки для проверки есть ли они в датафреймах\n",
    "        date_column_names = ['date', 'datetime', 'datetimeindex', 'dateindex', \n",
    "                             'time', 'timeindex', 'timestamp', 'period_from']\n",
    "\n",
    "        for column_name in df.columns:\n",
    "            # Приводим имя столбца к нижнему регистру для сравнения\n",
    "            lower_column_name = column_name.lower()\n",
    "            for date_name in date_column_names:\n",
    "                if date_name.lower() in lower_column_name:\n",
    "                    return column_name\n",
    "        \n",
    "    def transform_and_sort_dates(self):\n",
    "        # Оставляем нужные колонки через лист оп предиктору\n",
    "        self.df_predictors = self.df_predictors[self.columns_predictors]\n",
    "        \n",
    "        # Проверка индексов фреймов и возможный резет их в колонку\n",
    "        if self.df_predictors.index.name == None:\n",
    "            Index_col = self.find_date_column(self.df_predictors)\n",
    "            self.df_predictors = self.df_predictors.rename(columns={Index_col: 'date'})\n",
    "            \n",
    "        else:\n",
    "            Index_col = self.df_predictors.index.name\n",
    "            self.df_predictors = self.df_predictors.reset_index()\n",
    "            self.df_predictors = self.df_predictors.rename(columns={Index_col: 'date'})\n",
    "            \n",
    "        if self.df_target.index.name == None:\n",
    "            Index_col = self.find_date_column(self.df_target)\n",
    "            self.df_target = self.df_target.rename(columns={Index_col: 'date'})\n",
    "            \n",
    "        else:\n",
    "            Index_col = self.df_target.index.name\n",
    "            self.df_target = self.df_target.reset_index()\n",
    "            self.df_target = self.df_target.rename(columns={Index_col: 'date'})\n",
    "        \n",
    "        \n",
    "        # Преобразуем колонку 'date' в формат datetime\n",
    "        self.df_predictors['date'] = pd.to_datetime(self.df_predictors['date']).dt.date\n",
    "        self.df_target['date'] = pd.to_datetime(self.df_target['date']).dt.date\n",
    "\n",
    "        # Сортируем данные по колонке 'date'\n",
    "        self.df_predictors.sort_values(by=['date'], ascending=True, inplace=True)\n",
    "        self.df_target.sort_values(by=['date'], ascending=True, inplace=True)\n",
    "        \n",
    "        # Переименовываем таргет колонку таргет сета\n",
    "        self.df_target.rename(columns={self.df_target.columns[1]: 'Target'}, inplace=True)\n",
    "\n",
    "        # Резетим индексы\n",
    "        self.df_predictors.reset_index(drop=True, inplace=True)\n",
    "        ####\n",
    "        self.df_target = self.df_target[(self.df_target['date'] >= self.df_predictors['date'].iloc[0]) & (self.df_target['date'] <= self.df_predictors['date'].iloc[-1])]\n",
    "        ####\n",
    "        self.df_target.reset_index(drop=True, inplace=True)\n",
    "        \n",
    "        # Запись в лог debug\n",
    "        self.logger.debug(f\"Data transformed in {self.__class__.__name__}\")\n",
    "\n",
    "    def process_data(self):\n",
    "        \n",
    "        '''\n",
    "        Дроп колонок с первыми двумя и одним пропущенным значениями\n",
    "        Imputations пропущенных переменных двумя выбранными методами\n",
    "        Linear - линеный\n",
    "        Cubic - кубический сплайн\n",
    "        '''\n",
    "        \n",
    "        self.threshold = self.constants.get('threshold')\n",
    "        self.imput_linear = self.constants.get('imput_linear')\n",
    "        self.logger.debug(f\"Linear: {self.imput_linear}, Thresh: {self.threshold} in {self.__class__.__name__}\")\n",
    "        \n",
    "        # Проверка первых двух значений колонок на NaN\n",
    "        for column in self.df_predictors.columns.drop('date'):\n",
    "            if (pd.isna(self.df_predictors[column].iloc[0]) == True and pd.isna(self.df_predictors[column].iloc[1]) == True) or pd.isna(self.df_predictors[column].iloc[0]) == True:\n",
    "                self.df_predictors = self.df_predictors.drop(column, axis=1)\n",
    "        \n",
    "        # Обработка первого датафрейма: удаление столбцов с более чем threshold NaN\n",
    "        self.df_predictors = self.df_predictors.dropna(thresh = len(self.df_predictors) - round(len(self.df_predictors) * self.threshold), axis=1)\n",
    "        \n",
    "         # Интерполяция двумя методами        \n",
    "        if self.imput_linear == True:\n",
    "            self.df_predictors = self.df_predictors.interpolate(method='linear')\n",
    "            \n",
    "        elif self.imput_linear == False:\n",
    "            self.df_predictors = self.df_predictors.interpolate(method='cubic')\n",
    "        \n",
    "    def post_process_data(self):\n",
    "        \n",
    "        '''\n",
    "        Функция преобразует ряды следующими вариантами трансформаций:\n",
    "        \n",
    "        Box-Cox:\n",
    "        Преобразование Бокса-Кокса (Box-Cox Transformation) - это статистический метод, который используется для стабилизации дисперсии и сделать данные более нормально распределенными.\n",
    "        Этот метод особенно полезен при работе с данными, которые не соответствуют предположениям линейной регрессии или других статистических методов, так как они требуют нормального распределения ошибок\n",
    "        \n",
    "        Yeo-Johnson:\n",
    "        Преобразование Yeo-Johnson - это статистический метод для преобразования данных, подобно методу Бокса-Кокса, но с расширенными возможностями.\n",
    "        Этот метод может быть использован для стабилизации дисперсии и нормализации данных, делая их ближе к нормальному распределению.\n",
    "        Преобразование Yeo-Johnson более гибкое по сравнению с методом Бокса-Кокса, поскольку оно позволяет работать с данными, включая отрицательные значения\n",
    "        \n",
    "        FirstDiff:\n",
    "        Первые разности - это один из методов преобразования временных рядов для устранения нестационарности и создания стационарных данных.\n",
    "        При анализе временных рядов часто сталкиваются с проблемой, когда ряд нестационарен, что может усложнить анализ и прогнозирование.\n",
    "        Первые разности помогают сделать ряд стационарным, путем вычитания значения предыдущего периода из значения текущего периода.\n",
    "        Преобразование первых разностей определяется как разница между текущим значением временного ряда и предыдущим значением\n",
    "        \n",
    "        Log_return:\n",
    "        Метод Log Return (логарифмическая доходность) используется для анализа временных рядов и финансовых данных\n",
    "        Логарифмическая доходность представляет собой нормализованное процентное изменение величины относительно предыдущего периода.\n",
    "        Она позволяет анализировать изменения в данных в процентном выражении, что упрощает сравнение различных активов и временных рядов.\n",
    "        Этот метод часто используется в финансовом анализе для изучения доходности инвестиций, оценки рисков и построения моделей\n",
    "        \n",
    "        Log:\n",
    "        Логарифмирование - это преобразование данных путем взятия натурального логарифма от значений.\n",
    "        Этот метод применяется для уменьшения разброса между значениями и для изменения их масштаба.\n",
    "        Логарифмирование часто используется в анализе данных и статистике с целью линеаризации отклика на независимую переменную.\n",
    "        \n",
    "        '''\n",
    "        \n",
    "        self.post_process_data_mode = self.constants.get('post_process_data_mode')\n",
    "        self.logger.debug(f\"Transormation method is {[method for method, params in self.post_process_data_mode.items() if params['active']][0]} in {self.__class__.__name__}\")\n",
    "        \n",
    "        # Box-Cox трансформация\n",
    "        if self.post_process_data_mode['Box-Cox']['active'] == True:\n",
    "            \n",
    "            # Lambda boxcox таргета\n",
    "            self.retransform = stats.boxcox(self.df_target['Target'])[1]\n",
    "            \n",
    "            self.df_predictors = self.df_predictors.apply(lambda x: stats.boxcox(x)[0] if x.name != 'date' else x)\n",
    "            self.df_target = self.df_target.apply(lambda x: stats.boxcox(x)[0] if x.name != 'date' else x)\n",
    "            \n",
    "        \n",
    "        # YeoJohnson трансформация    \n",
    "        elif self.post_process_data_mode['YeoJohnson']['active'] == True:\n",
    "            \n",
    "            # Lambda yeojohnson таргета\n",
    "            self.retransform = stats.yeojohnson(self.df_target['Target'])[1]\n",
    "            \n",
    "            self.df_predictors = self.df_predictors.apply(lambda x: stats.yeojohnson(x)[0] if x.name != 'date' else x)\n",
    "            self.df_target = self.df_target.apply(lambda x: stats.yeojohnson(x)[0] if x.name != 'date' else x)\n",
    "            \n",
    "            \n",
    "        # FirstDiff трансформация \n",
    "        elif self.post_process_data_mode['FirstDiff']['active'] == True:\n",
    "            # FirstDiff таргета\n",
    "            self.retransform = self.df_target['Target']\n",
    "            \n",
    "            # Преобразованеие первых разностей с дропом колонки 'date' по первому df\n",
    "            for column in self.df_predictors.columns.drop('date'):\n",
    "                self.df_predictors[column] = self.df_predictors[column].diff().dropna()\n",
    "                \n",
    "            self.df_predictors = self.df_predictors.iloc[1:,:]\n",
    "            \n",
    "            # Преобразованеие первых разностей с дропом колонки 'date' по второму df\n",
    "            for column in self.df_target.columns.drop('date'):\n",
    "                self.df_target[column] = self.df_target[column].diff().dropna()\n",
    "                \n",
    "            self.df_target = self.df_target.iloc[1:,:]\n",
    "                \n",
    "        # Log_return трансформация \n",
    "        elif self.post_process_data_mode['Log_return']['active'] == True:\n",
    "            # Log_return таргета\n",
    "            self.retransform = self.df_target['Target']\n",
    "            \n",
    "            # Преобразованеие Log_return с дропом колонки 'date' по первому df\n",
    "            for column in self.df_predictors.columns.drop('date'):\n",
    "                self.df_predictors[column] = self.df_predictors[column].pct_change().dropna()\n",
    "       \n",
    "            self.df_predictors = self.df_predictors.iloc[1:,:]\n",
    "            \n",
    "            # Преобразованеие Log_return с дропом колонки 'date' по второму df\n",
    "            for column in self.df_target.columns.drop('date'):\n",
    "                self.df_target[column] = self.df_target[column].pct_change().dropna()\n",
    "                \n",
    "            self.df_target = self.df_target.iloc[1:,:]\n",
    "            \n",
    "        # Log трансформация \n",
    "        elif self.post_process_data_mode['Log']['active'] == True:\n",
    "            # Log таргета\n",
    "            self.retransform = None\n",
    "            self.df_predictors = self.df_predictors.apply(lambda x: np.log(x) if x.name != 'date' else x)\n",
    "            self.df_target = self.df_target.apply(lambda x: np.log(x) if x.name != 'date' else x)\n",
    "            \n",
    "        elif self.post_process_data_mode['None']['active'] == True:\n",
    "            self.retransform = None\n",
    "            self.df_predictors = self.df_predictors\n",
    "            self.df_target = self.df_target\n",
    " \n",
    "        else: # запишем под else ввод 'None'\n",
    "            self.retransform = None\n",
    "            self.df_predictors = self.df_predictors\n",
    "            self.df_target = self.df_target\n",
    "            \n",
    "    # def merge_dfs(self):\n",
    "    #     self.df_target['date'] = pd.to_datetime(self.df_target['date'])\n",
    "    #     self.df_target.set_index('date',inplace=True)\n",
    "    #     self.df_target = self.df_target.resample(\"1W\").mean()\n",
    "    #     self.df_predictors['date'] = pd.to_datetime(self.df_predictors['date'])\n",
    "    #     self.df_predictors.set_index('date',inplace=True)\n",
    "    #     self.df_predictors = self.df_predictors.resample(\"1W\").mean()\n",
    "    #     # Комбинируем два сета левым мерджем\n",
    "    #     self.df_combined = pd.merge(self.df_target, self.df_predictors, how='inner', left_index=True,right_index=True)\n",
    "    #     self.df_combined = self.df_combined.reset_index()\n",
    "        \n",
    "    #     # Интерполяция двумя методами        \n",
    "    #     if self.imput_linear == True:\n",
    "    #         self.df_combined = self.df_combined.interpolate(method='linear')\n",
    "            \n",
    "    #     elif self.imput_linear == False:\n",
    "    #         self.df_combined = self.df_combined.interpolate(method='cubic')\n",
    "            \n",
    "    #     self.df_combined = self.df_combined.dropna()\n",
    "    #     self.df_combined.reset_index(drop=True,inplace=True)\n",
    "    def merge_dfs(self):\n",
    "\n",
    "        # Комбинируем два сета левым мерджем\n",
    "        self.df_combined = pd.merge(self.df_target, self.df_predictors, how='left', on='date')\n",
    "        \n",
    "        # Интерполяция двумя методами        \n",
    "        if self.imput_linear == True:\n",
    "            self.df_combined = self.df_combined.interpolate(method='linear')\n",
    "            \n",
    "        elif self.imput_linear == False:\n",
    "            self.df_combined = self.df_combined.interpolate(method='cubic')\n",
    "            \n",
    "        self.df_combined = self.df_combined.dropna()\n",
    "        self.df_combined.reset_index(drop=True,inplace=True)\n",
    "\n",
    "    def get_processed_data(self):\n",
    "        self.logger.info(f\"All transformations have been done in {self.__class__.__name__}\")\n",
    "        return self.df_combined, self.retransform"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 92,
   "id": "7fa05468-2095-4563-a357-04a5556aa76b",
   "metadata": {
    "tags": []
   },
   "outputs": [],
   "source": [
    "class Ensemble_prediction:\n",
    "    def __init__(self, processed_df, selected_models, comb_models, models):\n",
    "        self.processed_df = processed_df\n",
    "        self.selected_models = selected_models\n",
    "        self.comb_models = comb_models\n",
    "        self.models = models\n",
    "        self.logger = logging.getLogger('my_logger')\n",
    "        \n",
    "    def select_features_models(self):\n",
    "        result = []\n",
    "        pattern = re.compile(r'([A-Za-z]+)(\\d+)')\n",
    "\n",
    "        for entry in self.selected_models:\n",
    "            matches = pattern.findall(entry)\n",
    "            names_and_numbers = [(match[0], int(match[1])) for match in matches]\n",
    "            result.append(names_and_numbers)\n",
    "            \n",
    "        numbers = []\n",
    "        pattern = re.compile(r'\\d+')\n",
    "\n",
    "        for entry in result:\n",
    "            numbers.extend(map(int, pattern.findall(str(entry))))\n",
    "            \n",
    "        features_all = []\n",
    "        for i in numbers:\n",
    "            features_all.append(json.loads(self.models.loc[i, 'features'].replace(\"'\", \"\\\"\")))\n",
    "            \n",
    "        features_all = list(set(sum(features_all, [])))\n",
    "        features_all.remove('Target')\n",
    "        \n",
    "        self.processed_df = self.processed_df[['date', 'Target'] + features_all]\n",
    "        \n",
    "        ready_models = []\n",
    "        for comb in list(set(sum(result, []))):\n",
    "            name = comb[0]\n",
    "            ix = comb[1]\n",
    "\n",
    "            pred_len = PRED_LEN\n",
    "            lookback = models.loc[ix]['lookback']\n",
    "            features_model = json.loads(models.loc[ix, 'features'].replace(\"'\", \"\\\"\"))\n",
    "            features_model.remove('Target')\n",
    "            subframe = self.processed_df[['date', 'Target'] + features_model].copy()\n",
    "            subframe = subframe.drop('date', axis=1).values.astype('float32')\n",
    "\n",
    "            X, y, X_pred = [], [], []\n",
    "            for i in range(len(subframe)-lookback-pred_len):\n",
    "                feature = subframe[i:i+lookback]\n",
    "                target = subframe[i+pred_len+lookback:i+pred_len+lookback+1,0].reshape(-1,1)\n",
    "                feature_pred = subframe[i+pred_len+1:i+pred_len+lookback+1]\n",
    "                X.append(feature)\n",
    "                X_pred.append(feature_pred)\n",
    "                y.append(target)\n",
    "            X, X_pred, y = np.asarray(X, dtype=np.float32), np.asarray(X_pred, dtype=np.float32), np.asarray(y, dtype=np.float32)\n",
    "\n",
    "            data_back = []\n",
    "            data_future_all = []\n",
    "\n",
    "            for i in range(-25-pred_len-1,0,1):\n",
    "                if i != -1:\n",
    "                    backtest_set_X_train = X[:i].reshape(X[:i].shape[0], -1)\n",
    "                    backtest_set_y_train = y[:i].reshape(y[:i].shape[0], -1)\n",
    "                else:\n",
    "                    backtest_set_X_train = X[:].reshape(X[:].shape[0], -1)\n",
    "                    backtest_set_y_train = y[:].reshape(y[:].shape[0], -1)\n",
    "\n",
    "                backtest_set_X_test = X_pred[i].reshape(X_pred[i].shape[0], -1)\n",
    "\n",
    "                if name == 'Lgb':\n",
    "                    model = lgb.LGBMRegressor(verbose = -1)\n",
    "\n",
    "                elif name == 'Xgb':\n",
    "                    model = xgb.XGBRegressor()\n",
    "\n",
    "                elif name == 'Cat':\n",
    "                    model = cb.CatBoostRegressor(verbose=0)\n",
    "\n",
    "                model = model.fit(backtest_set_X_train, backtest_set_y_train)\n",
    "                y_pred = model.predict(backtest_set_X_train[-1].reshape(1,backtest_set_X_train[-1].shape[0]))\n",
    "                data_back.append(round(y_pred[0],2))\n",
    "\n",
    "                data_future_all.append(model.predict(backtest_set_X_test.reshape(1,backtest_set_X_test.shape[0] * backtest_set_X_test.shape[1]))[0])\n",
    "\n",
    "            ready_models.append([name+str(ix), np.array(data_back), processed_df['Target'].values[-25-pred_len-1:], np.array(data_future_all)])\n",
    "\n",
    "        ready_models = pd.DataFrame(ready_models, columns = ['Model', 'Back', 'Real', 'Pred'])\n",
    "        \n",
    "        super_ens = []\n",
    "        for comb in self.selected_models:\n",
    "            model_list = comb.split(', ')\n",
    "            uni = ready_models[ready_models['Model'].isin(model_list)]\n",
    "            super_ens.append([comb, np.round(uni['Back'].mean(),2), uni['Real'].mean(), np.round(uni['Pred'].mean(),2)])\n",
    "            \n",
    "        super_ens = pd.DataFrame(super_ens, columns = ['Model', 'Back', 'Real', 'Pred'])\n",
    "            \n",
    "        new_row = {'Model': self.selected_models,\n",
    "           'Back': np.round(super_ens['Back'].mean(),2),\n",
    "           'Real': super_ens['Real'].mean(),\n",
    "           'Pred': np.round(super_ens['Pred'].mean(),2)}\n",
    "\n",
    "        # Добавление новой строки в DataFrame\n",
    "        super_ens = pd.concat([super_ens, pd.DataFrame([new_row])], ignore_index=True)\n",
    "        \n",
    "        # Финальная сборка датафрейма моделей\n",
    "        ready_models = pd.concat([ready_models, super_ens], ignore_index=True)\n",
    "        \n",
    "        ready_models['Correlation'] = ready_models['Back'].apply(lambda x: pearsonr(x, ready_models['Real'][0])[0])\n",
    "        ready_models['Mape'] = ready_models['Back'].apply(lambda x: np.mean(np.abs((ready_models['Real'][0] - np.array(x)) / ready_models['Real'][0])) * 100)\n",
    "        ready_models['MSE'] = ready_models['Back'].apply(lambda x: mean_squared_error(ready_models['Real'][0], x))\n",
    "        ready_models['MAE'] = ready_models['Back'].apply(lambda x: mean_absolute_error(ready_models['Real'][0], x))\n",
    "        ready_models['RMSE'] = ready_models['Back'].apply(lambda x: np.sqrt(mean_squared_error(ready_models['Real'][0], x)))\n",
    "        ready_models['R2'] = ready_models['Back'].apply(lambda x: r2_score(ready_models['Real'][0], x))\n",
    "        self.logger.info(f\"Ensembles have been done in {self.__class__.__name__}\")\n",
    "        return ready_models"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 93,
   "id": "43861535-888b-4d1a-a065-6b981f7f65c6",
   "metadata": {
    "tags": []
   },
   "outputs": [],
   "source": [
    "class Output_ensemble:\n",
    "    def __init__(self, processed_df, ensemble_models):\n",
    "        self.processed_df = processed_df\n",
    "        self.ensemble_models = ensemble_models\n",
    "        self.logger = logging.getLogger('my_logger')\n",
    "        \n",
    "    def last_keep(self):\n",
    "        keep_model = self.ensemble_models[-1:]\n",
    "        keep_model = keep_model.reset_index()\n",
    "        \n",
    "        keep_data = pd.DataFrame(keep_model['Pred'][0], columns = [f'{PRED_LEN+1}W'])\n",
    "        keep_data.insert(0, 'date', self.processed_df['date'][-25-PRED_LEN-1:].values)\n",
    "        keep_data.insert(1, 'Back', keep_model['Pred'][0])\n",
    "        keep_data.insert(2, 'Real', self.processed_df['Target'][-25-PRED_LEN-1:].values)\n",
    "\n",
    "        keep_data[f'Back'] = keep_data[f'Back'].shift(PRED_LEN+1)\n",
    "\n",
    "        keep_data.dropna(inplace=True)\n",
    "        keep_data.reset_index(drop=True, inplace=True)\n",
    "        \n",
    "        self.logger.info(f\"Final Result is ready {self.__class__.__name__}\")\n",
    "        return keep_data"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 94,
   "id": "20d68397-d97d-4469-b1a3-07f9dec221e0",
   "metadata": {
    "tags": []
   },
   "outputs": [],
   "source": [
    "# Загрузка пути из файла\n",
    "with open('pred.pkl', 'rb') as file:\n",
    "    PREDICTORS_PATH = pickle.load(file)\n",
    "    \n",
    "# Загрузка пути из файла\n",
    "with open('target.pkl', 'rb') as file:\n",
    "    TARGET_PATH = pickle.load(file)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 95,
   "id": "928c58cd-27de-4081-b026-9b85e15bb18b",
   "metadata": {
    "tags": []
   },
   "outputs": [],
   "source": [
    "log_format = '%(asctime)s - %(name)s - %(levelname)s - %(message)s'\n",
    "datefmt = '%Y-%m-%d %H:%M:%S'\n",
    "formatter = logging.Formatter(log_format, datefmt=datefmt)\n",
    "\n",
    "logger = logging.getLogger('my_logger')\n",
    "\n",
    "# Обработчик для записи логов в файл\n",
    "log_handler = logging.FileHandler(FILES_LOG, encoding='utf-8')\n",
    "\n",
    "# Форматтер для логов\n",
    "log_handler.setFormatter(formatter)\n",
    "\n",
    "# Обработчик к логгеру\n",
    "logger.addHandler(log_handler)\n",
    "logger.setLevel(logging.DEBUG)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 96,
   "id": "a26dc627-a676-49da-85ff-3915dd176cd7",
   "metadata": {
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>lookback</th>\n",
       "      <th>granger_lags</th>\n",
       "      <th>granger_pval</th>\n",
       "      <th>cross_lag_max</th>\n",
       "      <th>ls_corr</th>\n",
       "      <th>result_Cat_mse</th>\n",
       "      <th>result_Cat_mae</th>\n",
       "      <th>result_Cat_mape</th>\n",
       "      <th>result_Cat_R2</th>\n",
       "      <th>Cat_data_act_pred</th>\n",
       "      <th>...</th>\n",
       "      <th>result_Xgb_mape</th>\n",
       "      <th>result_Xgb_R2</th>\n",
       "      <th>Xgb_data_act_pred</th>\n",
       "      <th>result_Lgb_mse</th>\n",
       "      <th>result_Lgb_mae</th>\n",
       "      <th>result_Lgb_mape</th>\n",
       "      <th>result_Lgb_R2</th>\n",
       "      <th>Lgb_data_act_pred</th>\n",
       "      <th>features</th>\n",
       "      <th>n_features</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>8</td>\n",
       "      <td>5</td>\n",
       "      <td>0.156241</td>\n",
       "      <td>-7</td>\n",
       "      <td>18.461274</td>\n",
       "      <td>0.499196</td>\n",
       "      <td>0.584276</td>\n",
       "      <td>1.696125</td>\n",
       "      <td>0.307331</td>\n",
       "      <td>True       Pred\\n0   36.299999  36.92...</td>\n",
       "      <td>...</td>\n",
       "      <td>1.306573</td>\n",
       "      <td>0.510202</td>\n",
       "      <td>True       Pred\\n0   36.299999  36.45...</td>\n",
       "      <td>0.641888</td>\n",
       "      <td>0.584613</td>\n",
       "      <td>1.711977</td>\n",
       "      <td>0.109335</td>\n",
       "      <td>True       Pred\\n0   36.299999  36.44...</td>\n",
       "      <td>['Target', 'TMUS', 'INTU']</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>6</td>\n",
       "      <td>4</td>\n",
       "      <td>0.092686</td>\n",
       "      <td>-4</td>\n",
       "      <td>24.377353</td>\n",
       "      <td>0.509682</td>\n",
       "      <td>0.575972</td>\n",
       "      <td>1.685484</td>\n",
       "      <td>0.292781</td>\n",
       "      <td>True       Pred\\n0   36.299999  36.49...</td>\n",
       "      <td>...</td>\n",
       "      <td>1.442724</td>\n",
       "      <td>0.402126</td>\n",
       "      <td>True       Pred\\n0   36.299999  36.21...</td>\n",
       "      <td>0.493983</td>\n",
       "      <td>0.556832</td>\n",
       "      <td>1.628692</td>\n",
       "      <td>0.314563</td>\n",
       "      <td>True       Pred\\n0   36.299999  36.84...</td>\n",
       "      <td>['Target', 'INTU', 'BKNG']</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>7</td>\n",
       "      <td>4</td>\n",
       "      <td>0.097010</td>\n",
       "      <td>-6</td>\n",
       "      <td>18.843823</td>\n",
       "      <td>0.401006</td>\n",
       "      <td>0.546323</td>\n",
       "      <td>1.588377</td>\n",
       "      <td>0.443576</td>\n",
       "      <td>True       Pred\\n0   36.299999  36.64...</td>\n",
       "      <td>...</td>\n",
       "      <td>1.229129</td>\n",
       "      <td>0.604572</td>\n",
       "      <td>True       Pred\\n0   36.299999  36.18...</td>\n",
       "      <td>0.462211</td>\n",
       "      <td>0.529034</td>\n",
       "      <td>1.544198</td>\n",
       "      <td>0.358649</td>\n",
       "      <td>True       Pred\\n0   36.299999  36.23...</td>\n",
       "      <td>['Target', 'AMD', 'INTU']</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>4</td>\n",
       "      <td>5</td>\n",
       "      <td>0.149273</td>\n",
       "      <td>-3</td>\n",
       "      <td>35.099774</td>\n",
       "      <td>0.329603</td>\n",
       "      <td>0.454062</td>\n",
       "      <td>1.324876</td>\n",
       "      <td>0.542653</td>\n",
       "      <td>True       Pred\\n0   36.299999  36.67...</td>\n",
       "      <td>...</td>\n",
       "      <td>1.403558</td>\n",
       "      <td>0.431673</td>\n",
       "      <td>True       Pred\\n0   36.299999  36.17...</td>\n",
       "      <td>0.467467</td>\n",
       "      <td>0.525373</td>\n",
       "      <td>1.530577</td>\n",
       "      <td>0.351356</td>\n",
       "      <td>True       Pred\\n0   36.299999  36.69...</td>\n",
       "      <td>['Target', 'TMUS', 'INTU']</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>3</td>\n",
       "      <td>3</td>\n",
       "      <td>0.041269</td>\n",
       "      <td>-5</td>\n",
       "      <td>33.142119</td>\n",
       "      <td>0.315066</td>\n",
       "      <td>0.432751</td>\n",
       "      <td>1.265961</td>\n",
       "      <td>0.562824</td>\n",
       "      <td>True       Pred\\n0   36.299999  36.31...</td>\n",
       "      <td>...</td>\n",
       "      <td>1.481581</td>\n",
       "      <td>0.428186</td>\n",
       "      <td>True       Pred\\n0   36.299999  36.61...</td>\n",
       "      <td>0.453607</td>\n",
       "      <td>0.534512</td>\n",
       "      <td>1.555020</td>\n",
       "      <td>0.370588</td>\n",
       "      <td>True       Pred\\n0   36.299999  36.75...</td>\n",
       "      <td>['Target', 'TMUS', 'INTU']</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>5 rows × 22 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "   lookback  granger_lags  granger_pval  cross_lag_max    ls_corr  \\\n",
       "0         8             5      0.156241             -7  18.461274   \n",
       "1         6             4      0.092686             -4  24.377353   \n",
       "2         7             4      0.097010             -6  18.843823   \n",
       "3         4             5      0.149273             -3  35.099774   \n",
       "4         3             3      0.041269             -5  33.142119   \n",
       "\n",
       "   result_Cat_mse  result_Cat_mae  result_Cat_mape  result_Cat_R2  \\\n",
       "0        0.499196        0.584276         1.696125       0.307331   \n",
       "1        0.509682        0.575972         1.685484       0.292781   \n",
       "2        0.401006        0.546323         1.588377       0.443576   \n",
       "3        0.329603        0.454062         1.324876       0.542653   \n",
       "4        0.315066        0.432751         1.265961       0.562824   \n",
       "\n",
       "                                   Cat_data_act_pred  ...  result_Xgb_mape  \\\n",
       "0           True       Pred\\n0   36.299999  36.92...  ...         1.306573   \n",
       "1           True       Pred\\n0   36.299999  36.49...  ...         1.442724   \n",
       "2           True       Pred\\n0   36.299999  36.64...  ...         1.229129   \n",
       "3           True       Pred\\n0   36.299999  36.67...  ...         1.403558   \n",
       "4           True       Pred\\n0   36.299999  36.31...  ...         1.481581   \n",
       "\n",
       "   result_Xgb_R2                                  Xgb_data_act_pred  \\\n",
       "0       0.510202           True       Pred\\n0   36.299999  36.45...   \n",
       "1       0.402126           True       Pred\\n0   36.299999  36.21...   \n",
       "2       0.604572           True       Pred\\n0   36.299999  36.18...   \n",
       "3       0.431673           True       Pred\\n0   36.299999  36.17...   \n",
       "4       0.428186           True       Pred\\n0   36.299999  36.61...   \n",
       "\n",
       "   result_Lgb_mse result_Lgb_mae  result_Lgb_mape  result_Lgb_R2  \\\n",
       "0        0.641888       0.584613         1.711977       0.109335   \n",
       "1        0.493983       0.556832         1.628692       0.314563   \n",
       "2        0.462211       0.529034         1.544198       0.358649   \n",
       "3        0.467467       0.525373         1.530577       0.351356   \n",
       "4        0.453607       0.534512         1.555020       0.370588   \n",
       "\n",
       "                                   Lgb_data_act_pred  \\\n",
       "0           True       Pred\\n0   36.299999  36.44...   \n",
       "1           True       Pred\\n0   36.299999  36.84...   \n",
       "2           True       Pred\\n0   36.299999  36.23...   \n",
       "3           True       Pred\\n0   36.299999  36.69...   \n",
       "4           True       Pred\\n0   36.299999  36.75...   \n",
       "\n",
       "                     features n_features  \n",
       "0  ['Target', 'TMUS', 'INTU']          3  \n",
       "1  ['Target', 'INTU', 'BKNG']          3  \n",
       "2   ['Target', 'AMD', 'INTU']          3  \n",
       "3  ['Target', 'TMUS', 'INTU']          3  \n",
       "4  ['Target', 'TMUS', 'INTU']          3  \n",
       "\n",
       "[5 rows x 22 columns]"
      ]
     },
     "execution_count": 96,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "data = pd.read_csv(FILES_CONSTS.get('data'))\n",
    "data.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 97,
   "id": "70084685-1e3f-4239-b1ff-5e0ada8682fc",
   "metadata": {
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>lookback</th>\n",
       "      <th>granger_lags</th>\n",
       "      <th>granger_pval</th>\n",
       "      <th>cross_lag_max</th>\n",
       "      <th>ls_corr</th>\n",
       "      <th>result_Cat_mse</th>\n",
       "      <th>result_Cat_mae</th>\n",
       "      <th>result_Cat_mape</th>\n",
       "      <th>result_Cat_R2</th>\n",
       "      <th>Cat_data_act_pred</th>\n",
       "      <th>...</th>\n",
       "      <th>result_Xgb_mape</th>\n",
       "      <th>result_Xgb_R2</th>\n",
       "      <th>Xgb_data_act_pred</th>\n",
       "      <th>result_Lgb_mse</th>\n",
       "      <th>result_Lgb_mae</th>\n",
       "      <th>result_Lgb_mape</th>\n",
       "      <th>result_Lgb_R2</th>\n",
       "      <th>Lgb_data_act_pred</th>\n",
       "      <th>features</th>\n",
       "      <th>n_features</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>8</td>\n",
       "      <td>5</td>\n",
       "      <td>0.156241</td>\n",
       "      <td>-7</td>\n",
       "      <td>18.461274</td>\n",
       "      <td>0.499196</td>\n",
       "      <td>0.584276</td>\n",
       "      <td>1.696125</td>\n",
       "      <td>0.307331</td>\n",
       "      <td>True       Pred\n",
       "0   36.299999  36.924...</td>\n",
       "      <td>...</td>\n",
       "      <td>1.306573</td>\n",
       "      <td>0.510202</td>\n",
       "      <td>True       Pred\n",
       "0   36.299999  36.456...</td>\n",
       "      <td>0.641888</td>\n",
       "      <td>0.584613</td>\n",
       "      <td>1.711977</td>\n",
       "      <td>0.109335</td>\n",
       "      <td>True       Pred\n",
       "0   36.299999  36.446...</td>\n",
       "      <td>['Target', 'TMUS', 'INTU']</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>6</td>\n",
       "      <td>4</td>\n",
       "      <td>0.092686</td>\n",
       "      <td>-4</td>\n",
       "      <td>24.377353</td>\n",
       "      <td>0.509682</td>\n",
       "      <td>0.575972</td>\n",
       "      <td>1.685484</td>\n",
       "      <td>0.292781</td>\n",
       "      <td>True       Pred\n",
       "0   36.299999  36.493...</td>\n",
       "      <td>...</td>\n",
       "      <td>1.442724</td>\n",
       "      <td>0.402126</td>\n",
       "      <td>True       Pred\n",
       "0   36.299999  36.217...</td>\n",
       "      <td>0.493983</td>\n",
       "      <td>0.556832</td>\n",
       "      <td>1.628692</td>\n",
       "      <td>0.314563</td>\n",
       "      <td>True       Pred\n",
       "0   36.299999  36.843...</td>\n",
       "      <td>['Target', 'INTU', 'BKNG']</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>7</td>\n",
       "      <td>4</td>\n",
       "      <td>0.097010</td>\n",
       "      <td>-6</td>\n",
       "      <td>18.843823</td>\n",
       "      <td>0.401006</td>\n",
       "      <td>0.546323</td>\n",
       "      <td>1.588377</td>\n",
       "      <td>0.443576</td>\n",
       "      <td>True       Pred\n",
       "0   36.299999  36.649...</td>\n",
       "      <td>...</td>\n",
       "      <td>1.229129</td>\n",
       "      <td>0.604572</td>\n",
       "      <td>True       Pred\n",
       "0   36.299999  36.188...</td>\n",
       "      <td>0.462211</td>\n",
       "      <td>0.529034</td>\n",
       "      <td>1.544198</td>\n",
       "      <td>0.358649</td>\n",
       "      <td>True       Pred\n",
       "0   36.299999  36.237...</td>\n",
       "      <td>['Target', 'AMD', 'INTU']</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>4</td>\n",
       "      <td>5</td>\n",
       "      <td>0.149273</td>\n",
       "      <td>-3</td>\n",
       "      <td>35.099774</td>\n",
       "      <td>0.329603</td>\n",
       "      <td>0.454062</td>\n",
       "      <td>1.324876</td>\n",
       "      <td>0.542653</td>\n",
       "      <td>True       Pred\n",
       "0   36.299999  36.672...</td>\n",
       "      <td>...</td>\n",
       "      <td>1.403558</td>\n",
       "      <td>0.431673</td>\n",
       "      <td>True       Pred\n",
       "0   36.299999  36.171...</td>\n",
       "      <td>0.467467</td>\n",
       "      <td>0.525373</td>\n",
       "      <td>1.530577</td>\n",
       "      <td>0.351356</td>\n",
       "      <td>True       Pred\n",
       "0   36.299999  36.699...</td>\n",
       "      <td>['Target', 'TMUS', 'INTU']</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>3</td>\n",
       "      <td>3</td>\n",
       "      <td>0.041269</td>\n",
       "      <td>-5</td>\n",
       "      <td>33.142119</td>\n",
       "      <td>0.315066</td>\n",
       "      <td>0.432751</td>\n",
       "      <td>1.265961</td>\n",
       "      <td>0.562824</td>\n",
       "      <td>True       Pred\n",
       "0   36.299999  36.310...</td>\n",
       "      <td>...</td>\n",
       "      <td>1.481581</td>\n",
       "      <td>0.428186</td>\n",
       "      <td>True       Pred\n",
       "0   36.299999  36.613...</td>\n",
       "      <td>0.453607</td>\n",
       "      <td>0.534512</td>\n",
       "      <td>1.555020</td>\n",
       "      <td>0.370588</td>\n",
       "      <td>True       Pred\n",
       "0   36.299999  36.755...</td>\n",
       "      <td>['Target', 'TMUS', 'INTU']</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>5 rows × 22 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "   lookback  granger_lags  granger_pval  cross_lag_max    ls_corr  \\\n",
       "0         8             5      0.156241             -7  18.461274   \n",
       "1         6             4      0.092686             -4  24.377353   \n",
       "2         7             4      0.097010             -6  18.843823   \n",
       "3         4             5      0.149273             -3  35.099774   \n",
       "4         3             3      0.041269             -5  33.142119   \n",
       "\n",
       "   result_Cat_mse  result_Cat_mae  result_Cat_mape  result_Cat_R2  \\\n",
       "0        0.499196        0.584276         1.696125       0.307331   \n",
       "1        0.509682        0.575972         1.685484       0.292781   \n",
       "2        0.401006        0.546323         1.588377       0.443576   \n",
       "3        0.329603        0.454062         1.324876       0.542653   \n",
       "4        0.315066        0.432751         1.265961       0.562824   \n",
       "\n",
       "                                   Cat_data_act_pred  ...  result_Xgb_mape  \\\n",
       "0           True       Pred\n",
       "0   36.299999  36.924...  ...         1.306573   \n",
       "1           True       Pred\n",
       "0   36.299999  36.493...  ...         1.442724   \n",
       "2           True       Pred\n",
       "0   36.299999  36.649...  ...         1.229129   \n",
       "3           True       Pred\n",
       "0   36.299999  36.672...  ...         1.403558   \n",
       "4           True       Pred\n",
       "0   36.299999  36.310...  ...         1.481581   \n",
       "\n",
       "   result_Xgb_R2                                  Xgb_data_act_pred  \\\n",
       "0       0.510202           True       Pred\n",
       "0   36.299999  36.456...   \n",
       "1       0.402126           True       Pred\n",
       "0   36.299999  36.217...   \n",
       "2       0.604572           True       Pred\n",
       "0   36.299999  36.188...   \n",
       "3       0.431673           True       Pred\n",
       "0   36.299999  36.171...   \n",
       "4       0.428186           True       Pred\n",
       "0   36.299999  36.613...   \n",
       "\n",
       "   result_Lgb_mse result_Lgb_mae  result_Lgb_mape  result_Lgb_R2  \\\n",
       "0        0.641888       0.584613         1.711977       0.109335   \n",
       "1        0.493983       0.556832         1.628692       0.314563   \n",
       "2        0.462211       0.529034         1.544198       0.358649   \n",
       "3        0.467467       0.525373         1.530577       0.351356   \n",
       "4        0.453607       0.534512         1.555020       0.370588   \n",
       "\n",
       "                                   Lgb_data_act_pred  \\\n",
       "0           True       Pred\n",
       "0   36.299999  36.446...   \n",
       "1           True       Pred\n",
       "0   36.299999  36.843...   \n",
       "2           True       Pred\n",
       "0   36.299999  36.237...   \n",
       "3           True       Pred\n",
       "0   36.299999  36.699...   \n",
       "4           True       Pred\n",
       "0   36.299999  36.755...   \n",
       "\n",
       "                     features n_features  \n",
       "0  ['Target', 'TMUS', 'INTU']          3  \n",
       "1  ['Target', 'INTU', 'BKNG']          3  \n",
       "2   ['Target', 'AMD', 'INTU']          3  \n",
       "3  ['Target', 'TMUS', 'INTU']          3  \n",
       "4  ['Target', 'TMUS', 'INTU']          3  \n",
       "\n",
       "[5 rows x 22 columns]"
      ]
     },
     "execution_count": 97,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "models = Model_filter(data)\n",
    "models = models.output_model_filter()\n",
    "models.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 98,
   "id": "bb4c0461-76f7-4569-9891-4165b9bde4aa",
   "metadata": {
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>True</th>\n",
       "      <th>Pred</th>\n",
       "      <th>Index</th>\n",
       "      <th>Correlation</th>\n",
       "      <th>Mape</th>\n",
       "      <th>MSE</th>\n",
       "      <th>RMSE</th>\n",
       "      <th>R2</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>[36.299999, 36.049999, 35.950001, 35.41, 35.43...</td>\n",
       "      <td>[36.53306742857143, 36.34014114285714, 36.5574...</td>\n",
       "      <td>Cat4, Cat3, Cat2, Cat0, Cat1, Lgb4, Lgb2, Lgb3...</td>\n",
       "      <td>0.848827</td>\n",
       "      <td>1.424240</td>\n",
       "      <td>0.380678</td>\n",
       "      <td>0.616991</td>\n",
       "      <td>0.471782</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>[36.299999, 36.049999, 35.950001, 35.41, 35.43...</td>\n",
       "      <td>[36.504745428571425, 36.34671657142857, 36.533...</td>\n",
       "      <td>Cat4, Cat3, Cat2, Cat0, Cat1, Lgb4, Lgb2, Lgb3...</td>\n",
       "      <td>0.845665</td>\n",
       "      <td>1.424377</td>\n",
       "      <td>0.384903</td>\n",
       "      <td>0.620406</td>\n",
       "      <td>0.465919</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>[36.299999, 36.049999, 35.950001, 35.41, 35.43...</td>\n",
       "      <td>[36.53634342857143, 36.33894228571429, 36.5308...</td>\n",
       "      <td>Cat4, Cat3, Cat2, Cat0, Cat1, Lgb4, Lgb2, Lgb3...</td>\n",
       "      <td>0.848872</td>\n",
       "      <td>1.429032</td>\n",
       "      <td>0.382619</td>\n",
       "      <td>0.618562</td>\n",
       "      <td>0.469089</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>[36.299999, 36.049999, 35.950001, 35.41, 35.43...</td>\n",
       "      <td>[36.51598821428571, 36.33939835714286, 36.5365...</td>\n",
       "      <td>Cat4, Cat3, Cat2, Cat0, Cat1, Lgb4, Lgb2, Lgb3...</td>\n",
       "      <td>0.845935</td>\n",
       "      <td>1.430887</td>\n",
       "      <td>0.384869</td>\n",
       "      <td>0.620378</td>\n",
       "      <td>0.465967</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>[36.299999, 36.049999, 35.950001, 35.41, 35.43...</td>\n",
       "      <td>[36.53509057142857, 36.3335145, 36.53153935714...</td>\n",
       "      <td>Cat4, Cat3, Cat2, Cat0, Cat1, Lgb4, Lgb2, Lgb3...</td>\n",
       "      <td>0.841251</td>\n",
       "      <td>1.441996</td>\n",
       "      <td>0.394402</td>\n",
       "      <td>0.628015</td>\n",
       "      <td>0.452739</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>[36.299999, 36.049999, 35.950001, 35.41, 35.43...</td>\n",
       "      <td>[36.516684, 36.34074592857143, 36.525925142857...</td>\n",
       "      <td>Cat4, Cat3, Cat2, Cat0, Cat1, Lgb4, Lgb2, Lgb3...</td>\n",
       "      <td>0.852404</td>\n",
       "      <td>1.402233</td>\n",
       "      <td>0.368241</td>\n",
       "      <td>0.606828</td>\n",
       "      <td>0.489040</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>[36.299999, 36.049999, 35.950001, 35.41, 35.43...</td>\n",
       "      <td>[36.48829657142857, 36.33206257142857, 36.5608...</td>\n",
       "      <td>Cat4, Cat3, Cat2, Cat0, Cat1, Lgb4, Lgb2, Lgb3...</td>\n",
       "      <td>0.847185</td>\n",
       "      <td>1.418004</td>\n",
       "      <td>0.378889</td>\n",
       "      <td>0.615540</td>\n",
       "      <td>0.474264</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>[36.299999, 36.049999, 35.950001, 35.41, 35.43...</td>\n",
       "      <td>[36.49860628571428, 36.3237725, 36.54450542857...</td>\n",
       "      <td>Cat4, Cat3, Cat2, Cat0, Cat1, Lgb4, Lgb2, Lgb1...</td>\n",
       "      <td>0.848713</td>\n",
       "      <td>1.413612</td>\n",
       "      <td>0.376966</td>\n",
       "      <td>0.613976</td>\n",
       "      <td>0.476933</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>[36.299999, 36.049999, 35.950001, 35.41, 35.43...</td>\n",
       "      <td>[36.53163214285714, 36.32238507142857, 36.5349...</td>\n",
       "      <td>Cat4, Cat3, Cat2, Cat0, Cat1, Lgb4, Lgb3, Lgb1...</td>\n",
       "      <td>0.848822</td>\n",
       "      <td>1.421420</td>\n",
       "      <td>0.378437</td>\n",
       "      <td>0.615172</td>\n",
       "      <td>0.474892</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>[36.299999, 36.049999, 35.950001, 35.41, 35.43...</td>\n",
       "      <td>[36.49462628571428, 36.32576100000001, 36.5342...</td>\n",
       "      <td>Cat4, Cat3, Cat2, Cat0, Cat1, Lgb2, Lgb3, Lgb1...</td>\n",
       "      <td>0.847494</td>\n",
       "      <td>1.410549</td>\n",
       "      <td>0.378579</td>\n",
       "      <td>0.615288</td>\n",
       "      <td>0.474694</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>[36.299999, 36.049999, 35.950001, 35.41, 35.43...</td>\n",
       "      <td>[36.51335592857143, 36.34546185714286, 36.5654...</td>\n",
       "      <td>Cat4, Cat3, Cat2, Cat0, Lgb4, Lgb2, Lgb3, Lgb1...</td>\n",
       "      <td>0.847893</td>\n",
       "      <td>1.408587</td>\n",
       "      <td>0.376209</td>\n",
       "      <td>0.613359</td>\n",
       "      <td>0.477983</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>[36.299999, 36.049999, 35.950001, 35.41, 35.43...</td>\n",
       "      <td>[36.48257492857143, 36.303897642857144, 36.545...</td>\n",
       "      <td>Cat4, Cat3, Cat2, Cat1, Lgb4, Lgb2, Lgb3, Lgb1...</td>\n",
       "      <td>0.842503</td>\n",
       "      <td>1.404140</td>\n",
       "      <td>0.377672</td>\n",
       "      <td>0.614550</td>\n",
       "      <td>0.475953</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>[36.299999, 36.049999, 35.950001, 35.41, 35.43...</td>\n",
       "      <td>[36.5021865, 36.32335742857143, 36.55855735714...</td>\n",
       "      <td>Cat4, Cat3, Cat0, Cat1, Lgb4, Lgb2, Lgb3, Lgb1...</td>\n",
       "      <td>0.842882</td>\n",
       "      <td>1.410299</td>\n",
       "      <td>0.382447</td>\n",
       "      <td>0.618423</td>\n",
       "      <td>0.469327</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>[36.299999, 36.049999, 35.950001, 35.41, 35.43...</td>\n",
       "      <td>[36.50053464285715, 36.342831714285715, 36.566...</td>\n",
       "      <td>Cat4, Cat2, Cat0, Cat1, Lgb4, Lgb2, Lgb3, Lgb1...</td>\n",
       "      <td>0.843924</td>\n",
       "      <td>1.430842</td>\n",
       "      <td>0.387407</td>\n",
       "      <td>0.622420</td>\n",
       "      <td>0.462446</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>[36.299999, 36.049999, 35.950001, 35.41, 35.43...</td>\n",
       "      <td>[36.526370642857145, 36.360670428571424, 36.59...</td>\n",
       "      <td>Cat3, Cat2, Cat0, Cat1, Lgb4, Lgb2, Lgb3, Lgb1...</td>\n",
       "      <td>0.844723</td>\n",
       "      <td>1.436711</td>\n",
       "      <td>0.390888</td>\n",
       "      <td>0.625210</td>\n",
       "      <td>0.457615</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                                                 True  \\\n",
       "0   [36.299999, 36.049999, 35.950001, 35.41, 35.43...   \n",
       "1   [36.299999, 36.049999, 35.950001, 35.41, 35.43...   \n",
       "2   [36.299999, 36.049999, 35.950001, 35.41, 35.43...   \n",
       "3   [36.299999, 36.049999, 35.950001, 35.41, 35.43...   \n",
       "4   [36.299999, 36.049999, 35.950001, 35.41, 35.43...   \n",
       "5   [36.299999, 36.049999, 35.950001, 35.41, 35.43...   \n",
       "6   [36.299999, 36.049999, 35.950001, 35.41, 35.43...   \n",
       "7   [36.299999, 36.049999, 35.950001, 35.41, 35.43...   \n",
       "8   [36.299999, 36.049999, 35.950001, 35.41, 35.43...   \n",
       "9   [36.299999, 36.049999, 35.950001, 35.41, 35.43...   \n",
       "10  [36.299999, 36.049999, 35.950001, 35.41, 35.43...   \n",
       "11  [36.299999, 36.049999, 35.950001, 35.41, 35.43...   \n",
       "12  [36.299999, 36.049999, 35.950001, 35.41, 35.43...   \n",
       "13  [36.299999, 36.049999, 35.950001, 35.41, 35.43...   \n",
       "14  [36.299999, 36.049999, 35.950001, 35.41, 35.43...   \n",
       "\n",
       "                                                 Pred  \\\n",
       "0   [36.53306742857143, 36.34014114285714, 36.5574...   \n",
       "1   [36.504745428571425, 36.34671657142857, 36.533...   \n",
       "2   [36.53634342857143, 36.33894228571429, 36.5308...   \n",
       "3   [36.51598821428571, 36.33939835714286, 36.5365...   \n",
       "4   [36.53509057142857, 36.3335145, 36.53153935714...   \n",
       "5   [36.516684, 36.34074592857143, 36.525925142857...   \n",
       "6   [36.48829657142857, 36.33206257142857, 36.5608...   \n",
       "7   [36.49860628571428, 36.3237725, 36.54450542857...   \n",
       "8   [36.53163214285714, 36.32238507142857, 36.5349...   \n",
       "9   [36.49462628571428, 36.32576100000001, 36.5342...   \n",
       "10  [36.51335592857143, 36.34546185714286, 36.5654...   \n",
       "11  [36.48257492857143, 36.303897642857144, 36.545...   \n",
       "12  [36.5021865, 36.32335742857143, 36.55855735714...   \n",
       "13  [36.50053464285715, 36.342831714285715, 36.566...   \n",
       "14  [36.526370642857145, 36.360670428571424, 36.59...   \n",
       "\n",
       "                                                Index  Correlation      Mape  \\\n",
       "0   Cat4, Cat3, Cat2, Cat0, Cat1, Lgb4, Lgb2, Lgb3...     0.848827  1.424240   \n",
       "1   Cat4, Cat3, Cat2, Cat0, Cat1, Lgb4, Lgb2, Lgb3...     0.845665  1.424377   \n",
       "2   Cat4, Cat3, Cat2, Cat0, Cat1, Lgb4, Lgb2, Lgb3...     0.848872  1.429032   \n",
       "3   Cat4, Cat3, Cat2, Cat0, Cat1, Lgb4, Lgb2, Lgb3...     0.845935  1.430887   \n",
       "4   Cat4, Cat3, Cat2, Cat0, Cat1, Lgb4, Lgb2, Lgb3...     0.841251  1.441996   \n",
       "5   Cat4, Cat3, Cat2, Cat0, Cat1, Lgb4, Lgb2, Lgb3...     0.852404  1.402233   \n",
       "6   Cat4, Cat3, Cat2, Cat0, Cat1, Lgb4, Lgb2, Lgb3...     0.847185  1.418004   \n",
       "7   Cat4, Cat3, Cat2, Cat0, Cat1, Lgb4, Lgb2, Lgb1...     0.848713  1.413612   \n",
       "8   Cat4, Cat3, Cat2, Cat0, Cat1, Lgb4, Lgb3, Lgb1...     0.848822  1.421420   \n",
       "9   Cat4, Cat3, Cat2, Cat0, Cat1, Lgb2, Lgb3, Lgb1...     0.847494  1.410549   \n",
       "10  Cat4, Cat3, Cat2, Cat0, Lgb4, Lgb2, Lgb3, Lgb1...     0.847893  1.408587   \n",
       "11  Cat4, Cat3, Cat2, Cat1, Lgb4, Lgb2, Lgb3, Lgb1...     0.842503  1.404140   \n",
       "12  Cat4, Cat3, Cat0, Cat1, Lgb4, Lgb2, Lgb3, Lgb1...     0.842882  1.410299   \n",
       "13  Cat4, Cat2, Cat0, Cat1, Lgb4, Lgb2, Lgb3, Lgb1...     0.843924  1.430842   \n",
       "14  Cat3, Cat2, Cat0, Cat1, Lgb4, Lgb2, Lgb3, Lgb1...     0.844723  1.436711   \n",
       "\n",
       "         MSE      RMSE        R2  \n",
       "0   0.380678  0.616991  0.471782  \n",
       "1   0.384903  0.620406  0.465919  \n",
       "2   0.382619  0.618562  0.469089  \n",
       "3   0.384869  0.620378  0.465967  \n",
       "4   0.394402  0.628015  0.452739  \n",
       "5   0.368241  0.606828  0.489040  \n",
       "6   0.378889  0.615540  0.474264  \n",
       "7   0.376966  0.613976  0.476933  \n",
       "8   0.378437  0.615172  0.474892  \n",
       "9   0.378579  0.615288  0.474694  \n",
       "10  0.376209  0.613359  0.477983  \n",
       "11  0.377672  0.614550  0.475953  \n",
       "12  0.382447  0.618423  0.469327  \n",
       "13  0.387407  0.622420  0.462446  \n",
       "14  0.390888  0.625210  0.457615  "
      ]
     },
     "execution_count": 98,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "comb_models = pd.read_parquet(FILES_CONSTS.get('comb_models'))\n",
    "comb_models"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 99,
   "id": "11b46b8e-275b-47fd-b2e8-8309a0a79239",
   "metadata": {
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "('Cat4, Cat3, Cat2, Cat0, Cat1, Lgb4, Lgb2, Lgb3, Lgb1, Xgb2, Xgb0, Xgb3, Xgb4, Xgb1',\n",
       " 'Cat4, Cat3, Cat2, Cat0, Cat1, Lgb4, Lgb2, Lgb3, Lgb1, Lgb0, Xgb2, Xgb0, Xgb4, Xgb1')"
      ]
     },
     "execution_count": 99,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "selected_models = Selected_models(comb_models)\n",
    "selected_models = selected_models.selected_models_output()\n",
    "selected_models"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 100,
   "id": "5961a04f-6c3e-4c19-a543-a101eb2bb701",
   "metadata": {
    "tags": []
   },
   "outputs": [],
   "source": [
    "df_predictors = pd.read_csv(FILES_CONSTS.get('df_predictors'))\n",
    "df_target = pd.read_csv(FILES_CONSTS.get('df_target'), usecols=['Date', 'CSX'])\n",
    "columns_predictors = df_predictors.columns"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 101,
   "id": "b7cd527e-a04b-4a69-9d17-1d5c123b5885",
   "metadata": {
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Date</th>\n",
       "      <th>CSX</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>2023-07-17</td>\n",
       "      <td>33.220001</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2023-07-18</td>\n",
       "      <td>33.750000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>2023-07-19</td>\n",
       "      <td>33.799999</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>2023-07-20</td>\n",
       "      <td>33.709999</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>2023-07-21</td>\n",
       "      <td>32.459999</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>202</th>\n",
       "      <td>2024-05-03</td>\n",
       "      <td>33.849998</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>203</th>\n",
       "      <td>2024-05-06</td>\n",
       "      <td>33.680000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>204</th>\n",
       "      <td>2024-05-07</td>\n",
       "      <td>33.959999</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>205</th>\n",
       "      <td>2024-05-08</td>\n",
       "      <td>34.220001</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>206</th>\n",
       "      <td>2024-05-09</td>\n",
       "      <td>34.459999</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>207 rows × 2 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "           Date        CSX\n",
       "0    2023-07-17  33.220001\n",
       "1    2023-07-18  33.750000\n",
       "2    2023-07-19  33.799999\n",
       "3    2023-07-20  33.709999\n",
       "4    2023-07-21  32.459999\n",
       "..          ...        ...\n",
       "202  2024-05-03  33.849998\n",
       "203  2024-05-06  33.680000\n",
       "204  2024-05-07  33.959999\n",
       "205  2024-05-08  34.220001\n",
       "206  2024-05-09  34.459999\n",
       "\n",
       "[207 rows x 2 columns]"
      ]
     },
     "execution_count": 101,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df_target"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 102,
   "id": "d71dd7a9-31e9-46ba-952f-88ed69191128",
   "metadata": {
    "tags": []
   },
   "outputs": [],
   "source": [
    "# Создание объекта класса DataFrameProcessor и выполнение обработки данных\n",
    "processor = DataFrameProcessor(df_predictors, df_target, columns_predictors, constants)\n",
    "processor.handle_exceptions(processor.transform_and_sort_dates)\n",
    "processor.handle_exceptions(processor.process_data)\n",
    "processor.handle_exceptions(processor.post_process_data)\n",
    "processor.handle_exceptions(processor.merge_dfs)\n",
    "processed_df, retransform = processor.handle_exceptions(processor.get_processed_data)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 103,
   "id": "51a158cd-9c25-42cb-bfd5-898371957d43",
   "metadata": {
    "tags": []
   },
   "outputs": [],
   "source": [
    "ensemble_models = Ensemble_prediction(processed_df, selected_models, comb_models, models)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 104,
   "id": "241e7ebe-569b-451b-9b87-8ea4e2eba8e5",
   "metadata": {
    "tags": []
   },
   "outputs": [],
   "source": [
    "ensemble_models = ensemble_models.select_features_models()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 105,
   "id": "d0731ea0-4407-479e-865f-7107df0f9d70",
   "metadata": {
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Model</th>\n",
       "      <th>Back</th>\n",
       "      <th>Real</th>\n",
       "      <th>Pred</th>\n",
       "      <th>Correlation</th>\n",
       "      <th>Mape</th>\n",
       "      <th>MSE</th>\n",
       "      <th>MAE</th>\n",
       "      <th>RMSE</th>\n",
       "      <th>R2</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>Lgb1</td>\n",
       "      <td>[36.85, 36.54, 36.32, 36.46, 36.06, 36.02, 35....</td>\n",
       "      <td>[36.41999816894531, 36.119998931884766, 36.299...</td>\n",
       "      <td>[36.58881386673433, 36.334959542103086, 36.565...</td>\n",
       "      <td>0.933307</td>\n",
       "      <td>0.897623</td>\n",
       "      <td>0.176533</td>\n",
       "      <td>0.308889</td>\n",
       "      <td>0.420159</td>\n",
       "      <td>0.800288</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Xgb4</td>\n",
       "      <td>[36.51, 36.42, 36.12, 36.3, 36.05, 35.95, 35.4...</td>\n",
       "      <td>[36.41999816894531, 36.119998931884766, 36.299...</td>\n",
       "      <td>[37.34099, 37.01132, 36.65155, 36.39804, 36.48...</td>\n",
       "      <td>0.938878</td>\n",
       "      <td>0.755606</td>\n",
       "      <td>0.125856</td>\n",
       "      <td>0.259630</td>\n",
       "      <td>0.354762</td>\n",
       "      <td>0.857620</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Lgb4</td>\n",
       "      <td>[36.89, 36.89, 36.36, 36.55, 36.09, 36.23, 35....</td>\n",
       "      <td>[36.41999816894531, 36.119998931884766, 36.299...</td>\n",
       "      <td>[37.294889357198635, 36.893219835518224, 36.84...</td>\n",
       "      <td>0.917272</td>\n",
       "      <td>1.094298</td>\n",
       "      <td>0.236667</td>\n",
       "      <td>0.377778</td>\n",
       "      <td>0.486484</td>\n",
       "      <td>0.732259</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Xgb1</td>\n",
       "      <td>[36.51, 36.42, 36.12, 36.3, 36.05, 35.95, 35.4...</td>\n",
       "      <td>[36.41999816894531, 36.119998931884766, 36.299...</td>\n",
       "      <td>[37.005047, 36.670074, 36.51793, 36.635826, 36...</td>\n",
       "      <td>0.938878</td>\n",
       "      <td>0.755606</td>\n",
       "      <td>0.125856</td>\n",
       "      <td>0.259630</td>\n",
       "      <td>0.354762</td>\n",
       "      <td>0.857620</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Cat2</td>\n",
       "      <td>[36.53, 36.45, 36.16, 36.31, 36.07, 35.97, 35....</td>\n",
       "      <td>[36.41999816894531, 36.119998931884766, 36.299...</td>\n",
       "      <td>[36.93699926274345, 36.79724571457963, 36.5166...</td>\n",
       "      <td>0.938917</td>\n",
       "      <td>0.784742</td>\n",
       "      <td>0.130911</td>\n",
       "      <td>0.269629</td>\n",
       "      <td>0.361816</td>\n",
       "      <td>0.851900</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>Xgb0</td>\n",
       "      <td>[36.51, 36.42, 36.12, 36.3, 36.05, 35.95, 35.4...</td>\n",
       "      <td>[36.41999816894531, 36.119998931884766, 36.299...</td>\n",
       "      <td>[36.932686, 37.085217, 36.729424, 36.753, 36.4...</td>\n",
       "      <td>0.938878</td>\n",
       "      <td>0.755606</td>\n",
       "      <td>0.125856</td>\n",
       "      <td>0.259630</td>\n",
       "      <td>0.354762</td>\n",
       "      <td>0.857620</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>Lgb0</td>\n",
       "      <td>[36.73, 36.53, 36.08, 36.35, 36.11, 35.98, 35....</td>\n",
       "      <td>[36.41999816894531, 36.119998931884766, 36.299...</td>\n",
       "      <td>[36.67968162514189, 36.686345098729745, 36.670...</td>\n",
       "      <td>0.923290</td>\n",
       "      <td>0.932712</td>\n",
       "      <td>0.175385</td>\n",
       "      <td>0.320741</td>\n",
       "      <td>0.418790</td>\n",
       "      <td>0.801587</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>Cat1</td>\n",
       "      <td>[36.56, 36.48, 36.15, 36.31, 36.03, 35.97, 35....</td>\n",
       "      <td>[36.41999816894531, 36.119998931884766, 36.299...</td>\n",
       "      <td>[36.78498777625197, 36.55639143311089, 36.2973...</td>\n",
       "      <td>0.939900</td>\n",
       "      <td>0.775871</td>\n",
       "      <td>0.130452</td>\n",
       "      <td>0.266666</td>\n",
       "      <td>0.361181</td>\n",
       "      <td>0.852420</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>Xgb3</td>\n",
       "      <td>[36.51, 36.42, 36.12, 36.3, 36.05, 35.95, 35.4...</td>\n",
       "      <td>[36.41999816894531, 36.119998931884766, 36.299...</td>\n",
       "      <td>[37.09349, 36.773106, 37.009727, 36.727512, 36...</td>\n",
       "      <td>0.938878</td>\n",
       "      <td>0.755606</td>\n",
       "      <td>0.125856</td>\n",
       "      <td>0.259630</td>\n",
       "      <td>0.354762</td>\n",
       "      <td>0.857620</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>Lgb3</td>\n",
       "      <td>[36.74, 36.63, 36.33, 36.53, 36.23, 36.13, 35....</td>\n",
       "      <td>[36.41999816894531, 36.119998931884766, 36.299...</td>\n",
       "      <td>[37.123679794342884, 36.68446263122268, 36.533...</td>\n",
       "      <td>0.919486</td>\n",
       "      <td>1.041270</td>\n",
       "      <td>0.211619</td>\n",
       "      <td>0.358889</td>\n",
       "      <td>0.460020</td>\n",
       "      <td>0.760596</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>Cat4</td>\n",
       "      <td>[36.55, 36.52, 36.25, 36.29, 36.02, 35.99, 35....</td>\n",
       "      <td>[36.41999816894531, 36.119998931884766, 36.299...</td>\n",
       "      <td>[36.583349900189866, 36.1943435526105, 35.8769...</td>\n",
       "      <td>0.941264</td>\n",
       "      <td>0.807961</td>\n",
       "      <td>0.134304</td>\n",
       "      <td>0.277778</td>\n",
       "      <td>0.366475</td>\n",
       "      <td>0.848062</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>Xgb2</td>\n",
       "      <td>[36.51, 36.42, 36.12, 36.3, 36.05, 35.95, 35.4...</td>\n",
       "      <td>[36.41999816894531, 36.119998931884766, 36.299...</td>\n",
       "      <td>[37.20577, 37.014744, 36.636585, 36.567825, 36...</td>\n",
       "      <td>0.938878</td>\n",
       "      <td>0.755606</td>\n",
       "      <td>0.125856</td>\n",
       "      <td>0.259630</td>\n",
       "      <td>0.354762</td>\n",
       "      <td>0.857620</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>Lgb2</td>\n",
       "      <td>[36.59, 36.45, 36.11, 36.2, 36.05, 36.03, 35.4...</td>\n",
       "      <td>[36.41999816894531, 36.119998931884766, 36.299...</td>\n",
       "      <td>[36.82553419333914, 36.50910974962964, 36.5208...</td>\n",
       "      <td>0.928340</td>\n",
       "      <td>0.841507</td>\n",
       "      <td>0.153311</td>\n",
       "      <td>0.288889</td>\n",
       "      <td>0.391550</td>\n",
       "      <td>0.826559</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>Cat3</td>\n",
       "      <td>[36.57, 36.49, 36.23, 36.31, 36.08, 35.98, 35....</td>\n",
       "      <td>[36.41999816894531, 36.119998931884766, 36.299...</td>\n",
       "      <td>[36.79421670284456, 36.479663602290906, 36.483...</td>\n",
       "      <td>0.943511</td>\n",
       "      <td>0.769875</td>\n",
       "      <td>0.128819</td>\n",
       "      <td>0.264815</td>\n",
       "      <td>0.358913</td>\n",
       "      <td>0.854268</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>Cat0</td>\n",
       "      <td>[36.53, 36.45, 36.17, 36.31, 36.09, 35.99, 35....</td>\n",
       "      <td>[36.41999816894531, 36.119998931884766, 36.299...</td>\n",
       "      <td>[37.022599345956884, 37.01830662959171, 36.875...</td>\n",
       "      <td>0.939049</td>\n",
       "      <td>0.788641</td>\n",
       "      <td>0.132178</td>\n",
       "      <td>0.271111</td>\n",
       "      <td>0.363563</td>\n",
       "      <td>0.850467</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>Cat4, Cat3, Cat2, Cat0, Cat1, Lgb4, Lgb2, Lgb3...</td>\n",
       "      <td>[36.6, 36.5, 36.19, 36.34, 36.07, 36.0, 35.5, ...</td>\n",
       "      <td>[36.41999816894531, 36.119998931884766, 36.299...</td>\n",
       "      <td>[36.97, 36.72, 36.58, 36.49, 36.37, 36.09, 36....</td>\n",
       "      <td>0.937989</td>\n",
       "      <td>0.820693</td>\n",
       "      <td>0.138282</td>\n",
       "      <td>0.282222</td>\n",
       "      <td>0.371862</td>\n",
       "      <td>0.843562</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>Cat4, Cat3, Cat2, Cat0, Cat1, Lgb4, Lgb2, Lgb3...</td>\n",
       "      <td>[36.61, 36.51, 36.19, 36.34, 36.07, 36.01, 35....</td>\n",
       "      <td>[36.41999816894531, 36.119998931884766, 36.299...</td>\n",
       "      <td>[36.94, 36.71, 36.55, 36.47, 36.34, 36.05, 36....</td>\n",
       "      <td>0.937017</td>\n",
       "      <td>0.831496</td>\n",
       "      <td>0.141259</td>\n",
       "      <td>0.285926</td>\n",
       "      <td>0.375845</td>\n",
       "      <td>0.840194</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>(Cat4, Cat3, Cat2, Cat0, Cat1, Lgb4, Lgb2, Lgb...</td>\n",
       "      <td>[36.61, 36.5, 36.19, 36.34, 36.07, 36.0, 35.5,...</td>\n",
       "      <td>[36.41999816894531, 36.119998931884766, 36.299...</td>\n",
       "      <td>[36.96, 36.72, 36.56, 36.48, 36.36, 36.07, 36....</td>\n",
       "      <td>0.937597</td>\n",
       "      <td>0.823963</td>\n",
       "      <td>0.139419</td>\n",
       "      <td>0.283333</td>\n",
       "      <td>0.373388</td>\n",
       "      <td>0.842276</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                                                Model  \\\n",
       "0                                                Lgb1   \n",
       "1                                                Xgb4   \n",
       "2                                                Lgb4   \n",
       "3                                                Xgb1   \n",
       "4                                                Cat2   \n",
       "5                                                Xgb0   \n",
       "6                                                Lgb0   \n",
       "7                                                Cat1   \n",
       "8                                                Xgb3   \n",
       "9                                                Lgb3   \n",
       "10                                               Cat4   \n",
       "11                                               Xgb2   \n",
       "12                                               Lgb2   \n",
       "13                                               Cat3   \n",
       "14                                               Cat0   \n",
       "15  Cat4, Cat3, Cat2, Cat0, Cat1, Lgb4, Lgb2, Lgb3...   \n",
       "16  Cat4, Cat3, Cat2, Cat0, Cat1, Lgb4, Lgb2, Lgb3...   \n",
       "17  (Cat4, Cat3, Cat2, Cat0, Cat1, Lgb4, Lgb2, Lgb...   \n",
       "\n",
       "                                                 Back  \\\n",
       "0   [36.85, 36.54, 36.32, 36.46, 36.06, 36.02, 35....   \n",
       "1   [36.51, 36.42, 36.12, 36.3, 36.05, 35.95, 35.4...   \n",
       "2   [36.89, 36.89, 36.36, 36.55, 36.09, 36.23, 35....   \n",
       "3   [36.51, 36.42, 36.12, 36.3, 36.05, 35.95, 35.4...   \n",
       "4   [36.53, 36.45, 36.16, 36.31, 36.07, 35.97, 35....   \n",
       "5   [36.51, 36.42, 36.12, 36.3, 36.05, 35.95, 35.4...   \n",
       "6   [36.73, 36.53, 36.08, 36.35, 36.11, 35.98, 35....   \n",
       "7   [36.56, 36.48, 36.15, 36.31, 36.03, 35.97, 35....   \n",
       "8   [36.51, 36.42, 36.12, 36.3, 36.05, 35.95, 35.4...   \n",
       "9   [36.74, 36.63, 36.33, 36.53, 36.23, 36.13, 35....   \n",
       "10  [36.55, 36.52, 36.25, 36.29, 36.02, 35.99, 35....   \n",
       "11  [36.51, 36.42, 36.12, 36.3, 36.05, 35.95, 35.4...   \n",
       "12  [36.59, 36.45, 36.11, 36.2, 36.05, 36.03, 35.4...   \n",
       "13  [36.57, 36.49, 36.23, 36.31, 36.08, 35.98, 35....   \n",
       "14  [36.53, 36.45, 36.17, 36.31, 36.09, 35.99, 35....   \n",
       "15  [36.6, 36.5, 36.19, 36.34, 36.07, 36.0, 35.5, ...   \n",
       "16  [36.61, 36.51, 36.19, 36.34, 36.07, 36.01, 35....   \n",
       "17  [36.61, 36.5, 36.19, 36.34, 36.07, 36.0, 35.5,...   \n",
       "\n",
       "                                                 Real  \\\n",
       "0   [36.41999816894531, 36.119998931884766, 36.299...   \n",
       "1   [36.41999816894531, 36.119998931884766, 36.299...   \n",
       "2   [36.41999816894531, 36.119998931884766, 36.299...   \n",
       "3   [36.41999816894531, 36.119998931884766, 36.299...   \n",
       "4   [36.41999816894531, 36.119998931884766, 36.299...   \n",
       "5   [36.41999816894531, 36.119998931884766, 36.299...   \n",
       "6   [36.41999816894531, 36.119998931884766, 36.299...   \n",
       "7   [36.41999816894531, 36.119998931884766, 36.299...   \n",
       "8   [36.41999816894531, 36.119998931884766, 36.299...   \n",
       "9   [36.41999816894531, 36.119998931884766, 36.299...   \n",
       "10  [36.41999816894531, 36.119998931884766, 36.299...   \n",
       "11  [36.41999816894531, 36.119998931884766, 36.299...   \n",
       "12  [36.41999816894531, 36.119998931884766, 36.299...   \n",
       "13  [36.41999816894531, 36.119998931884766, 36.299...   \n",
       "14  [36.41999816894531, 36.119998931884766, 36.299...   \n",
       "15  [36.41999816894531, 36.119998931884766, 36.299...   \n",
       "16  [36.41999816894531, 36.119998931884766, 36.299...   \n",
       "17  [36.41999816894531, 36.119998931884766, 36.299...   \n",
       "\n",
       "                                                 Pred  Correlation      Mape  \\\n",
       "0   [36.58881386673433, 36.334959542103086, 36.565...     0.933307  0.897623   \n",
       "1   [37.34099, 37.01132, 36.65155, 36.39804, 36.48...     0.938878  0.755606   \n",
       "2   [37.294889357198635, 36.893219835518224, 36.84...     0.917272  1.094298   \n",
       "3   [37.005047, 36.670074, 36.51793, 36.635826, 36...     0.938878  0.755606   \n",
       "4   [36.93699926274345, 36.79724571457963, 36.5166...     0.938917  0.784742   \n",
       "5   [36.932686, 37.085217, 36.729424, 36.753, 36.4...     0.938878  0.755606   \n",
       "6   [36.67968162514189, 36.686345098729745, 36.670...     0.923290  0.932712   \n",
       "7   [36.78498777625197, 36.55639143311089, 36.2973...     0.939900  0.775871   \n",
       "8   [37.09349, 36.773106, 37.009727, 36.727512, 36...     0.938878  0.755606   \n",
       "9   [37.123679794342884, 36.68446263122268, 36.533...     0.919486  1.041270   \n",
       "10  [36.583349900189866, 36.1943435526105, 35.8769...     0.941264  0.807961   \n",
       "11  [37.20577, 37.014744, 36.636585, 36.567825, 36...     0.938878  0.755606   \n",
       "12  [36.82553419333914, 36.50910974962964, 36.5208...     0.928340  0.841507   \n",
       "13  [36.79421670284456, 36.479663602290906, 36.483...     0.943511  0.769875   \n",
       "14  [37.022599345956884, 37.01830662959171, 36.875...     0.939049  0.788641   \n",
       "15  [36.97, 36.72, 36.58, 36.49, 36.37, 36.09, 36....     0.937989  0.820693   \n",
       "16  [36.94, 36.71, 36.55, 36.47, 36.34, 36.05, 36....     0.937017  0.831496   \n",
       "17  [36.96, 36.72, 36.56, 36.48, 36.36, 36.07, 36....     0.937597  0.823963   \n",
       "\n",
       "         MSE       MAE      RMSE        R2  \n",
       "0   0.176533  0.308889  0.420159  0.800288  \n",
       "1   0.125856  0.259630  0.354762  0.857620  \n",
       "2   0.236667  0.377778  0.486484  0.732259  \n",
       "3   0.125856  0.259630  0.354762  0.857620  \n",
       "4   0.130911  0.269629  0.361816  0.851900  \n",
       "5   0.125856  0.259630  0.354762  0.857620  \n",
       "6   0.175385  0.320741  0.418790  0.801587  \n",
       "7   0.130452  0.266666  0.361181  0.852420  \n",
       "8   0.125856  0.259630  0.354762  0.857620  \n",
       "9   0.211619  0.358889  0.460020  0.760596  \n",
       "10  0.134304  0.277778  0.366475  0.848062  \n",
       "11  0.125856  0.259630  0.354762  0.857620  \n",
       "12  0.153311  0.288889  0.391550  0.826559  \n",
       "13  0.128819  0.264815  0.358913  0.854268  \n",
       "14  0.132178  0.271111  0.363563  0.850467  \n",
       "15  0.138282  0.282222  0.371862  0.843562  \n",
       "16  0.141259  0.285926  0.375845  0.840194  \n",
       "17  0.139419  0.283333  0.373388  0.842276  "
      ]
     },
     "execution_count": 105,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "ensemble_models"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 106,
   "id": "9c710ef4-9370-44ef-9fc1-f243c4de3230",
   "metadata": {
    "tags": []
   },
   "outputs": [],
   "source": [
    "keep_data = Output_ensemble(processed_df, ensemble_models)\n",
    "keep_data = keep_data.last_keep()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 107,
   "id": "2678ed27-686c-4785-9e8d-21dc07b68f48",
   "metadata": {
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "image/png": "iVBORw0KGgoAAAANSUhEUgAAAjEAAAGxCAYAAACTN+exAAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjcuMSwgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy/bCgiHAAAACXBIWXMAAA9hAAAPYQGoP6dpAACCfElEQVR4nO3dd1gU19fA8e/usiwdKwKKWLArNiwYu8GWGKMxseQ1plfT20+NiSYxptuSmKJRk9hijCl2LFhiLxjsFbGAiIo0abvz/jGCEhVYWBh2OZ/n2YfZZfbO2esIh5lz79UpiqIghBBCCGFn9FoHIIQQQghRFJLECCGEEMIuSRIjhBBCCLskSYwQQggh7JIkMUIIIYSwS5LECCGEEMIuSRIjhBBCCLskSYwQQggh7JIkMUIIIYSwS5LECOGAZs+ejU6ny/OoWrUqXbt2ZenSpSV67K5du9K0adMSPUZRde3aNU+fuLq60rx5cyZPnozFYinx40dERKDT6YiIiCjxYwlRHkgSI4QDmzVrFlu3bmXLli18//33GAwG+vXrx99//611aJqpU6cOW7duZevWrSxcuJDq1avz6quvMmrUKK1DE0JYyUnrAIQQJadp06aEhITkPu/duzcVK1Zk/vz59OvXT8PItOPq6kr79u1zn/fp04eGDRvy1Vdf8eGHH2I0Gm95j6IopKen4+rqWpqhCiEKIFdihChHXFxccHZ2vuUX9fjx42nXrh2VKlXCy8uLVq1aMXPmTG63Puy8efMIDQ3Fw8MDDw8PWrRowcyZM/M97pIlS3Bzc+PJJ58kOzv7tvu88soruLu7k5SUdMv3Bg8eTLVq1cjKygJg3bp1dO3alcqVK+Pq6krNmjV54IEHSEtLK2xX5DIajbRu3Zq0tDQuXrwIgE6nY+TIkXz77bc0atQIk8nEnDlzADh27BjDhg3Dx8cHk8lEo0aN+Prrr29p9/Dhw/Tu3Rs3NzeqVKnCs88+S3JystXxCSHuTK7ECOHAzGYz2dnZKIrChQsX+Oyzz0hNTWXYsGF59ouOjuaZZ56hZs2aAGzbto0XX3yRc+fO8e677+bu9+677/LBBx8wcOBAXn/9dby9vdm/fz+nT5++YwyTJk3izTffZNy4cbzzzjt33O/xxx9nypQp/Prrrzz55JO5rycmJvLnn3/ywgsvYDQaiY6O5p577qFTp078+OOPVKhQgXPnzrFy5UoyMzNxc3Ozup9OnDiBk5MTFStWzH3tjz/+YNOmTbz77rv4+vri4+PDwYMH6dChAzVr1uSLL77A19eXVatW8dJLL5GQkMB7770HwIULF+jSpQtGo5FvvvmGatWqMXfuXEaOHGl1bEKIfChCCIcza9YsBbjlYTKZlG+++Sbf95rNZiUrK0t5//33lcqVKysWi0VRFEU5efKkYjAYlIcffjjf93fp0kVp0qSJYjablZEjRyrOzs7KL7/8Uqi4W7VqpXTo0CHPa998840CKFFRUYqiKMpvv/2mAEpkZGSh2rxdbFlZWUpWVpZy/vx55X//+58CKA8++GDufoDi7e2tXL58Oc/7e/XqpdSoUUO5evVqntdHjhypuLi45O7/9ttvKzqd7pYYw8LCFEBZv3691bELIW4lt5OEcGA//fQTO3fuZOfOnaxYsYIRI0bwwgsv8NVXX+XZb926ddx99914e3tjMBgwGo28++67XLp0ifj4eADCw8Mxm8288MILBR43PT2d+++/n7lz57J69WoefvjhQsX72GOPsWXLFo4cOZL72qxZs2jTpk3uiKcWLVrg7OzM008/zZw5czh58mRhuwOAAwcOYDQaMRqN+Pv788UXX/Dwww/zww8/5Nmve/fuea7MpKens3btWgYMGICbmxvZ2dm5j759+5Kens62bdsAWL9+PU2aNKF58+Z52vzvFTAhRPFIEiOEA2vUqBEhISGEhITQu3dvvvvuO3r27Mlbb71FYmIiADt27KBnz54A/PDDD/zzzz/s3LmTMWPGAHDt2jWA3HqRGjVqFHjc+Ph4Vq1aRWhoKB06dCh0vA8//DAmk4nZs2cDcPDgQXbu3Mljjz2Wu0/dunVZs2YNPj4+vPDCC9StW5e6desyZcqUQh2jbt267Ny5k127drF//34SExP55Zdf8Pb2zrOfn59fnueXLl0iOzubadOm5SZBOY++ffsCkJCQkLuvr6/vLce+3WtCiKKTmhghypng4GBWrVrF0aNHadu2LQsWLMBoNLJ06VJcXFxy9/vjjz/yvK9q1aoAnD17loCAgHyPUbNmTb788ksGDBjAwIEDWbRoUZ6276RixYr079+fn376iQ8//JBZs2bh4uLC0KFD8+zXqVMnOnXqhNlsZteuXUybNo1XXnmFatWqMWTIkHyP4eLikmfE1p3odLpbYjMYDAwfPvyOV6Nq164NQOXKlYmLi7vl+7d7TQhRdHIlRohyJjIyEriRlOh0OpycnDAYDLn7XLt2jZ9//jnP+3r27InBYGD69OmFOk7Pnj1ZtWoVGzdu5N577yU1NbVQ73vsscc4f/48y5cv55dffmHAgAFUqFDhtvsaDAbatWuXOzpoz549hTpGUbi5udGtWzf27t1LcHBw7hWumx+VK1cGoFu3bhw4cIB9+/blaWPevHklFp8Q5ZFciRHCge3fvz93SPOlS5f4/fffCQ8PZ8CAAblXDe655x6+/PJLhg0bxtNPP82lS5f4/PPPMZlMedqqVasWo0eP5oMPPuDatWsMHToUb29vDh48SEJCAuPHj7/l+B07dmTt2rX07t2bnj17snz58ltu2/xXz549qVGjBs8//zxxcXF5biUBfPvtt6xbt4577rmHmjVrkp6ezo8//gjA3XffXeS+KowpU6bQsWNHOnXqxHPPPUetWrVITk7m+PHj/P3336xbtw5Qh4v/+OOP3HPPPXz44Ye5o5MOHz5covEJUe5oXVkshLC9241O8vb2Vlq0aKF8+eWXSnp6ep79f/zxR6VBgwaKyWRS6tSpo0ycOFGZOXOmAiinTp3Ks+9PP/2ktGnTRnFxcVE8PDyUli1bKrNmzcr9fs4IoJvt379f8fX1VVq1aqVcvHixwPhHjx6tAEpAQIBiNpvzfG/r1q3KgAEDlMDAQMVkMimVK1dWunTpovz1118Ftnu72G4HUF544YXbfu/UqVPK448/rlSvXl0xGo1K1apVlQ4dOigffvhhnv0OHjyohIWFKS4uLkqlSpWUJ554Qvnzzz9ldJIQNqRTlNvMZiWEEEIIUcZJTYwQQggh7JIkMUIIIYSwS5LECCGEEMIuSRIjhBBCCLskSYwQQggh7JIkMUIIIYSwSw4z2Z3FYuH8+fN4enreMl24EEIIIcomRVFITk7G398fvd66aysOk8ScP3++wPVchBBCCFE2nTlzplALzN7MYZIYT09PQO0ELy8vm7WblZXF6tWr6dmzJ0aj0WbtivxJv2tD+l0b0u/akH7Xxn/7PSkpiYCAgNzf49ZwmCQm5xaSl5eXzZMYNzc3vLy85CQvRdLv2pB+14b0uzak37Vxp34vSimIFPYKIYQQwi5JEiOEEEIIuyRJjBBCCCHsksPUxAghhBC2pigK2dnZmM1mrUOxWwaDAScnpxKZ/kSSGCGEEOI2MjMziY2NJS0tTetQ7J6bmxt+fn44OzvbtF1JYoQQQoj/sFgsnDp1CoPBgL+/P87OzjKRahEoikJmZiYXL17k1KlT1KtXz6btW5XETJ8+nenTpxMdHQ1AkyZNePfdd+nTpw9w5+FRn376KW+++eYd2128eDFjx47lxIkT1K1blwkTJjBgwABrQhNCCCFsJjMzE4vFQkBAAG5ublqHY9dcXV0xGo2cPn2azMxMDAaDzdq2qrC3Ro0afPzxx+zatYtdu3bRvXt3+vfvz4EDBwCIjY3N8/jxxx/R6XQ88MADd2xz69atDB48mOHDh7Nv3z6GDx/OQw89xPbt24v3yYQQQohisnYafHF7JdWPVl2J6devX57nEyZMYPr06Wzbto0mTZrg6+ub5/t//vkn3bp1o06dOndsc/LkyYSFhTFq1CgARo0axYYNG5g8eTLz58+3JjwhhBBClCNFrokxm80sWrSI1NRUQkNDb/n+hQsXWLZsGXPmzMm3na1bt/Lqq6/mea1Xr15Mnjw53/dlZGSQkZGR+zwpKQlQZwLMysoq5KcoWE5btmxTFEz6XRvS79qQftdGfv2elZWFoihYLBYsFktph+ZwLBYLiqKQlZWV25+2OO+tTmKioqIIDQ0lPT0dDw8PlixZQuPGjW/Zb86cOXh6ejJw4MB824uLi6NatWp5XqtWrRpxcXH5vm/ixImMHz/+ltdXr15dIvcvw8PDbd6mKJj0uzak37Uh/a6N2/W7k5MTvr6+pKSkkJmZqUFUZVtwcDDPPfcczz33XKH2z8zM5Nq1a2zcuJHs7GzgRr8XZ/SX1UlMgwYNiIyMJDExkcWLFzNixAg2bNhwSyLz448/8vDDD+Pi4lJgm/8tCFYUpcAq8FGjRvHaa6/lPs9ZQKpnz542XzspPDycsLAwWVujFEm/a0P6XRvS79rIr9/T09M5c+YMHh4ehfo9VpY89thj/PTTT7nPK1WqREhICJ988gnBwcE2OYZer8fFxaXQv2/T09NxdXWlc+fOGAyGPP2ecyelKKxOYpydnQkKCgIgJCSEnTt3MmXKFL777rvcfTZt2sSRI0dYuHBhge35+vrectUlPj7+lqsz/2UymTCZTLe8bjQabfpDYMuJS3x3SE+PML38cNGArf89ReFIv2tD+l0bt+t3s9mMTqdDr9fbXXGvTqejd+/ezJo1C1DveLzzzjvcd999xMTE2PQ4he0bvV6PTqfDaDTmjk7K6ffinPPF/pdRFCVPbQrAzJkzad26Nc2bNy/w/aGhobdcylu9ejUdOnQobmjFlpaZzauL/uVgop43F+/HYlG0DkkIIYQGFEUhLTNbk4eiWP+7x2Qy4evri6+vLy1atODtt9/mzJkzXLx4EYC3336b+vXr4+bmRp06dRg7duwttSl//fUXISEhuLi4UKVKlXzLQ2bNmoW3t3ep3xK16krM6NGj6dOnDwEBASQnJ7NgwQIiIiJYuXJl7j5JSUksWrSIL7744rZtPPLII1SvXp2JEycC8PLLL9O5c2c++eQT+vfvz59//smaNWvYvHlzMT6Wbbg5OzF1cHNGzNrJigMXmLjiEGPuubX+RwghhGO7lmWm8burNDn2wfd74eZc9LlpU1JSmDt3LkFBQVSuXBkAT09PZs+ejb+/P1FRUTz11FN4enry1ltvAbBs2TIGDhzImDFj+Pnnn8nMzGTZsmW3bf/zzz9n4sSJrFq1ivbt2xc5zqKwqlcuXLjA8OHDiY2Nxdvbm+DgYFauXElYWFjuPgsWLEBRFIYOHXrbNmJiYvJcfurQoQMLFizgnXfeYezYsdStW5eFCxfSrl27In4k22pXuxLD6lr4+biBHzadonoFVx69q7bWYQkhhBB3tHTpUjw8PABITU3Fz8+PpUuX5v7+feedd3L3rVWrFq+//joLFy7MTWImTJjAkCFD8gygud3dlVGjRjFnzhwiIiJo1qxZSX6k27IqiZk5c2aB+zz99NM8/fTTd/x+RETELa8NGjSIQYMGWRNKqQqpquBTK4gv1hxn/NKD+FdwpWcT34LfKIQQwiG4Gg0cfL+XZse2Vrdu3Zg+fToAly9f5ptvvqFPnz7s2LGDwMBAfvvtNyZPnszx48dJSUkhOzs7T5FuZGQkTz31VL7H+OKLL0hNTWXXrl35zgdXkuyrWklDz3SuzbB2NVEUeGnBXvbGXNE6JCGEEKVEp9Ph5uykyaMoaza5u7sTFBREUFAQbdu2ZebMmaSmpvLDDz+wbds2hgwZQp8+fVi6dCl79+5lzJgxeYaSu7q6FniMTp06YTab+fXXX62Oz1YkiSkknU7H+/c1oVuDqqRnWXhyzi5OX0rVOiwhhBCiQDkjia5du8Y///xDYGAgY8aMISQkhHr16nH69Ok8+wcHB7N27dp822zbti0rV67ko48+4rPPPivJ8O9IVrG2gpNBz1fDWjHk+21EnbvKo7N2svi5DlRyt+3S4kIIIURxZGRk5E5fcuXKFb766itSUlLo168fV69eJSYmhgULFtCmTRuWLVvGkiVL8rz/vffeo0ePHtStW5chQ4aQnZ3NihUrcmtmcoSGhrJixQp69+6Nk5PTLTPwlzS5EmMld5MTMx8NoXoFV04lpPLUT7tIzzJrHZYQQgiRa+XKlfj5+eHn50e7du3YuXMnixYtomvXrvTv359XX32VkSNH0qJFC7Zs2cLYsWPzvL9r164sWrSIv/76ixYtWtC9e/c7Lsx81113sWzZMsaOHcvUqVNL4+PlkisxReDj6cKcx9sw8Jst7D59hVcXRvL1sFbo9dbftxRCCCFsafbs2cyePTvffT799FM+/fTTPK+98soreZ4PHDjwjnPDREdH53neuXNnUlJSrA212ORKTBEF+XjywyMhOBv0rNgfx4Tlh7QOSQghhChXJIkphnZ1KvP5Q+q4+ZmbT/Hj5lMaRySEEEKUH5LEFNN9zf35X5+GAHyw7CAr9+e/+rYQQgghbEOSGBt4pnMd/q+9OofMywv2skfmkBFCCCFKnCQxNqDT6RjXrwk9GvqQka3OIROdIHPICCGEECVJkhgbcTLomTasJcE1vLmcmsmjs3ZwKSWj4DcKIYQQokgkibEhN2cnZo5oQ42KrkRfSuNJmUNGCCGEKDGSxNhYVU8Tsx9ri7erkb0xiby8YC9mi6J1WEIIIYTDkSSmBAT5eKhzyDjpWXXgAh8uO6h1SEIIIYTDkSSmhLStXYkvr88hM+ufaGbKHDJCCCEcxLhx42jRooXWYUgSU5LuDfZndF91DpkPlx1kRVSsxhEJIYRwdI8++ig6nQ6dToeTkxM1a9bkueee48oVx5v+Q5KYEvZUpzo8EhqIosArCyPZffqy1iEJIYRwcL179yY2Npbo6GhmzJjB33//zfPPP691WDYnSUwJ0+l0vNevCXc3qkZGtoXHZu1k3eELWoclhBDCGooCmanaPBTrB4eYTCZ8fX2pUaMGPXv2ZPDgwaxevTr3+7NmzaJRo0a4uLjQsGFDvvnmmzzvf/vtt6lfvz5ubm7UqVOHsWPHkpWVVexutDVZxboUGPQ6pg1tyfCZ29l1+gqPz97F813r8lpYfZwMkkcKIUSZl5UGH/lrc+zR58HZvchvP3nyJCtXrsRoNALwww8/8N577/HVV1/RsmVL9u7dy1NPPYW7uzsjRowAwNPTk9mzZ+Pv709UVBRPPfUUnp6evPXWWzb5SLYiSUwpcXU2MPepdkxcfpjZW6L5JuIEu09fYdrQlvh4uWgdnhBCCAeydOlSPDw8MJvNpKenA/Dll18C8MEHH/DFF18wcOBAAGrXrs3Bgwf57rvvcpOYd955J7etWrVq8frrr7Nw4UJJYsozk5OBcfc1IaRWRd7+7V+2n7pM36mbmTq0BR3qVtE6PCGEEHdidFOviGh1bCt169aN6dOnk5aWxowZMzh69CgvvvgiFy9e5MyZMzzxxBM89dRTuftnZ2fj7e2d+/y3335j8uTJHD9+nJSUFLKzs/Hy8rLJx7ElSWI0cG+wP439vHh+7h4OxyXzfzO28+rd9XmhWxB6vU7r8IQQQvyXTlesWzqlzd3dnaCgIACmTp1Kt27dGD9+PCNHjgTUW0rt2rXL8x6DwQDAtm3bGDJkCOPHj6dXr154e3uzYMECvvjii9L9EIUgBRkaqVPVgyXP38WDrWtgUeCL8KM8Nnsnl1MztQ5NCCGEg3nvvff4/PPPMZvNVK9enZMnTxIUFJTnUbt2bQD++ecfAgMDGTNmDCEhIdSrV4/Tp09r/AluT67EaMjV2cBnDzanTe1KjP1jPxuOXuTeqZuYNqwVrQMrah2eEEIIB9G1a1eaNGnCRx99xLhx43jppZfw8vKiT58+ZGRksGvXLq5cucJrr71GUFAQMTExLFiwgDZt2rBs2TKWLFmi9Ue4LbkSUwY8FBLAHy/cRe0q7py/ms7g77Yyc/MplCIMqxNCCCFu57XXXuOHH36gV69ezJgxg9mzZ9OsWTO6dOnC7Nmzc6/E9O/fn1dffZWRI0fSokULtmzZwtixYzWO/vYkiSkjGvl58dfIu7inmR/ZFoUPlh7kuV/2kJRe9sblCyGEKLtmz57NH3/8ccvrw4YNIyMjg4CAAIYNG8bevXvJyMjg8uXLbNiwgQEDBuTu++mnn5KQkEBycjILFizglVdeITExMff748aNIzIysuQ/TAEkiSlDPF2MfDWsJePva4LRoGPlgTj6TdvMgfNXtQ5NCCGEKHMkiSljdDodIzrUYtGzHahewZXTl9IY8M0W5u+IkdtLQgghxE0kiSmjWgRUYNlLHene0IfMbAujfo/i9V/3kZaZrXVoQgghRJkgSUwZVsHNmRmPhPBW7wbodfD73nP0/+ofjscnax2aEEIIoTlJYso4vV7H812DmPdUe3w8TRyLT+G+r/7hz8hzWocmhBAOT27j20ZJ9aMkMXaifZ3KLHupEx3qViYt08zLCyJ57pfdbD6WgMUi/8mEEMKWchZLTEtL0zgSx5DTjzn9aisy2Z0dqepp4ucn2jF5zVGmrTvOiv1xrNgfR/UKrjzQugYPtq5BQCXr19gQQgiRl8FgoEKFCsTHxwPg5uaGTifLwlhLURTS0tKIj4+nQoUKGAwGLBaLzdqXJMbOGPQ6Xu/ZgF5NfFmwM4Y/I89zLvEaU9ceY+raY4TWqcyDITXo09QPV2eD1uEKIYTd8vX1BchNZETRVahQIbc/bcmqJGb69OlMnz6d6OhoAJo0acK7775Lnz59cvc5dOgQb7/9Nhs2bMBisdCkSRN+/fVXataseds2Z8+ezWOPPXbL69euXcPFxcWa8MqVptW9+bB6M965pzGrDsTx2+6zbD6ewNaTl9h68hLv/nmAfs39eDAkgJYBFeQvCCGEsJJOp8PPzw8fHx+ysmTi0aIyGo25i0vamlVJTI0aNfj4449zV8acM2cO/fv3Z+/evTRp0oQTJ07QsWNHnnjiCcaPH4+3tzeHDh0qMBnx8vLiyJEjeV6TBKZwXIwG+reoTv8W1TmXeI3Fu8+yaPcZzly+xvwdZ5i/4wx1q7rzYEgAA1tWx8dL+lUIIaxhMBhK7JewKB6rkph+/frleT5hwgSmT5/Otm3baNKkCWPGjKFv3758+umnufvUqVOnwHZ1Ol2JXGYqb6pXcOWlHvUY2S2I7acus2j3GZZHxXLiYiofrzjMZ6uO0LV+VR4MCaB7Qx+cnaSuWwghhP0qck2M2Wxm0aJFpKamEhoaisViYdmyZbz11lv06tWLvXv3Urt2bUaNGsX999+fb1spKSkEBgZiNptp0aIFH3zwAS1btsz3PRkZGWRkZOQ+T0pKAiArK8uml/1y2rK3S4khNb0IqdmEd/o0YMX+OH7bc469Z66y9nA8aw/HU9HNyP0t/HmgpT8NfD21DvcW9trv9k76XRvS79qQftfGf/u9OP2vU6wcvB0VFUVoaCjp6el4eHgwb948+vbtS1xcHH5+fri5ufHhhx/SrVs3Vq5cyejRo1m/fj1dunS5bXvbtm3j+PHjNGvWjKSkJKZMmcLy5cvZt28f9erVu2Mc48aNY/z48be8Pm/ePNzcZITO7Vy4Btvj9ey8qCMp60aNTIC7Qg9/Cy0qK0jpjBBCiNKUlpbGsGHDuHr1Kl5eXla91+okJjMzk5iYGBITE1m8eDEzZsxgw4YNVKhQgerVqzN06FDmzZuXu/99992Hu7s78+fPL1T7FouFVq1a0blzZ6ZOnXrH/W53JSYgIICEhASrOyE/WVlZhIeHExYWZvPx7VrJNlvYePwSi/ecY/2Ri2SZ1VMgJLACo/s0oFl1b40jdMx+twfS79qQfteG9Ls2/tvvSUlJVKlSpUhJjNW3k5ydnXMLe0NCQti5cydTpkxh2rRpODk50bhx4zz7N2rUiM2bNxe6fb1eT5s2bTh27Fi++5lMJkwm0y2vG43GEjkZS6pdLRiN0KupP72a+nMpJYOftp7mu40n2HU6kYHfbmdQ6xq82asB1cpAEbAj9bs9kX7XhvS7NqTftZHT78Xp+2JXdiqKQkZGBs7OzrRp0+aWUUZHjx4lMDDQqvYiIyPx8/MrbmiiECp7mHg1rD7r3+jKgJbVAfht91m6fR7BV+uOkZ5l1jhCIYQQ4vasuhIzevRo+vTpQ0BAAMnJySxYsICIiAhWrlwJwJtvvsngwYPp3Llzbk3M33//TURERG4bjzzyCNWrV2fixIkAjB8/nvbt21OvXj2SkpKYOnUqkZGRfP3117b7lKJAft6uTBrcgkdCA3l/6UH2xiTy+eqjzN9xhv/1aci9wX4y14wQQogyxaok5sKFCwwfPpzY2Fi8vb0JDg5m5cqVhIWFATBgwAC+/fZbJk6cyEsvvUSDBg1YvHgxHTt2zG0jJiYGvf7GBaDExESefvpp4uLi8Pb2pmXLlmzcuJG2bdva6CMKa7SsWZHfn+vAX/vO8/GKw5xLvMaL8/cyZ0s0Y+9tTPOAClqHKIQQQgBWJjEzZ84scJ/HH3+cxx9//I7fv/mqDMCkSZOYNGmSNWGIEqbT6ejfojo9G/vy/caTfLvhBLtOX6H/1/8wsFV13u7dsEzUywghhCjfZLYzcUeuzgZevrse697owsDr9TK/7zlH188imLZW6mWEEEJoS5IYUSA/b1e+HNyCP164i1Y1K3Aty8wX4Ufp8cUG/tp3HitH6QshhBA2IUmMKLQWARVY/FwHpg5tib+3C+cSr/HS/L0M+nYr+84kah2eEEKIckaSGGEVnU7Hfc39Wft6V14Pq4+r0cDu6/Uyr/0aSdzVdK1DFEIIUU5IEiOKxNXZwIs96rH+ja480KoGoNbLdPs8gs3HEjSOTgghRHkgSYwoFl9vF754qDl/3lQv88rCvVxMzij4zUIIIUQxSBIjbKJ5QAXmPdWehr6eJKRk8vqifVgsUvArhBCi5EgSI2zGxWhg2tCWuBj1bDx6kR//OaV1SEIIIRyYJDGFIUOIC61eNU/G3qsuAvrJysNEnb2qcURCCCEclSQxBdCdWEvoiU8h65rWodiNYW1r0ruJL1lmhZcW7CU1I1vrkIQQQjggSWLyk5mK4e8X8Uk+gOHvkWCxaB2RXdDpdHz8QDP8vF04lZDKe38d0DokIYQQDkiSmPw4u2MeOAOLzoD+0J8QMVHriOxGBTdnJg9ugV4Hv+0+y5+R57QOSQghhIORJKYASs0O7At4TH2y8VP4d5G2AdmRdnUq82L3egCMWbKfmEtpGkckhBDCkUgSUwgxlTtjDn1RffLnC3Bmh7YB2ZEXuwcREliRlIxsXlqwlyyz3JITQghhG5LEFJKl21hocA+YM2DBMEiM0Toku+Bk0DN5SAu8XJyIPJPIpPCjWockhBDCQUgSU1g6PQz8Hqo1g9SLMG8wZCRrHZVdqFHRjY8fCAZg+oYTbDkuyxIIIYQoPklirGHygGELwKMaxB+E354Ai1nrqOxC32Z+DG0bgKLAKwsjuZyaqXVIQggh7JwkMdbyrgFD54OTCxxbBeHvah2R3Xj33iYE+XgQn5zBW7/tQ5FJBIUQQhSDJDFFUb013D9d3d76FeyerWk49sLV2cDUIS1xNuhZcyien7ae1jokIYQQdkySmKJqOhC6jla3l70OpzZqG4+daOzvxei+DQGYsPwQB88naRyREEIIeyVJTHF0eQuaDgJLNiwcDgnHtY7ILozoUIseDX3IzLbw4vw9XMuUuiIhhBDWkySmOHQ66P811GgD6YkwfzCkXdY6qjJPp9Px6aBgfDxNnLiYyvtLD2odkhBCCDskSUxxGV1gyDzwDoBLx2HRCDBnaR1VmVfZw8SkwS3Q6WD+jhiWR8VqHZIQQgg7I0mMLXj4wNAF4Oyh1sYsfwNk5E2B7gqqwrNd6gLwv8X/ci5RVgoXQghReJLE2IpvU3hgJqBTRyttm651RHbhtbD6NA+oQFJ6Nq8s2Eu2LEsghBCikCSJsaUGvaHnh+r2qtFwdJW28dgBo0HPtCEt8TA5sTP6CtPWSXG0EEKIwpEkxtZCX4BWjwAK/PY4XDigdURlXs3KbkwY0BSAaeuOseOUFEcLIYQomCQxtqbTQd8voFYnyEyBeUMg5aLWUZV5/VtUZ2Cr6lgUeGXBXhLTpDhaCCFE/iSJKQlOzvDQT1CpLlyNUVe9zkrXOqoy7/3+TalV2Y3zV9MZ8+cBqY0WQgiRL0liSopbJRj2K7h4w9kd8NdIGbFUAA+TE9OGtsJo0LH6YDxb43VahySEEKIMkySmJFUJUq/I6AwQtQg2fq51RGVesxrevNmrAQC/ndLz5E97mP3PKaITUjWOTAghRFnjpHUADq9OV7jnc1j6Kqz/ECrXVdddEnf0ZMc67I6+zKqD8Ww4lsCGYwnw90FqV3GnS/2qdG1QlfZ1KuNiNGgdqhBCCA1JElMaQh6HhGOw7Rt1xNKBJdDpNfBvqXVkZZJer2PakObM/G0FFt9GbDp+iV3RVziVkMqphFRmb4nGxainfZ3KdK1fla4NfKhVxV3rsIUQQpQyq24nTZ8+neDgYLy8vPDy8iI0NJQVK1bk2efQoUPcd999eHt74+npSfv27YmJicm33cWLF9O4cWNMJhONGzdmyZIl1n+Ssq7nh9DiYUCBQ3/B913h54EQ/Y/UytyGTqfD3x2e7lSbBU+HsvfdML79v1YMaROAr5cL6VkWIo5cZNzfB+n6eQRdP1vPuL8OEHEknvQsWVBSCCHKA6uuxNSoUYOPP/6YoKAgAObMmUP//v3Zu3cvTZo04cSJE3Ts2JEnnniC8ePH4+3tzaFDh3Bxcbljm1u3bmXw4MF88MEHDBgwgCVLlvDQQw+xefNm2rVrV7xPV5boDXD/NxA6Ev6ZDFG/wYm16iOgHXR6Her1VIdoi1t4uhjp3dSP3k39UBSFIxeSiThykYgj8eyKvkL0pTRmb4lm9pZoTE56QuvKVRohhHB0OkUp3mWASpUq8dlnn/HEE08wZMgQjEYjP//8c6HfP3jwYJKSkvJc0enduzcVK1Zk/vz5hW4nKSkJb29vrl69ipeXl1WfIT9ZWVksX76cvn37YjQabdYuV6Lhn6mw9xcwZ6ivVWsGnV6FxverSU85Zk2/J6dn8c/xS2w4Gk/EkYvEXs07nL1WZTcGt6nJs13qoJMkMV8ldr6LfEm/a0P6XRv/7ffi/P4uck2M2Wxm0aJFpKamEhoaisViYdmyZbz11lv06tWLvXv3Urt2bUaNGsX9999/x3a2bt3Kq6++mue1Xr16MXny5HyPn5GRQUZGRu7zpKQkQO2crCzbTZSW05Yt2wTAozr0+gQ6vIp+x7fo98xCdyEKfnscpeIHmENfQmn2EDiZbHtcO2FNv7sYoEeDyvRoUBnl3oYci09hw7EENh5NYHdMItGX0vhk5WHMZjPPdK5d0qHbtRI730W+pN+1If2ujf/2e3H63+orMVFRUYSGhpKeno6Hhwfz5s2jb9++xMXF4efnh5ubGx9++CHdunVj5cqVjB49mvXr19OlS5fbtufs7Mzs2bMZNmxY7mvz5s3jsccey5Ok/Ne4ceMYP378La/PmzcPNzc3az5SmWDMTqH2xTXUvbgKZ7M6nPiasSLHffpwunI3zIbymcwUV7oZNsbqWHbGgA6Fx+pbaF5ZapCEEKKsSEtLY9iwYUW6EmN1EpOZmUlMTAyJiYksXryYGTNmsGHDBipUqED16tUZOnQo8+bNy93/vvvuw93d/Y63hpydnZkzZw5Dhw7NfW3u3Lk88cQTpKffeZbb212JCQgIICEhwea3k8LDwwkLCyudy42ZKej3/ox+29foUuIAUFwrYWnzNJaQJ8G1QsnHUAbYut/HLz3EL9vP4GrUM//JtjTxt9054khK/XwXgPS7VqTftfHffk9KSqJKlSqlczvJ2dk5t7A3JCSEnTt3MmXKFKZNm4aTkxONGzfOs3+jRo3YvHnzHdvz9fUlLi4uz2vx8fFUq1Yt3zhMJhMm061XJ4xGY4mcjCXV7q0HqggdX4L2z8C+BbB5ErorpzBs/BjDtq+gzRPQ/gXwzL9/HIWt+n3cfU05ffkam44l8OzcSP4ceRfVvO5ccF7eldr5LvKQfteG9Ls2cvq9OH1f7Bl7FUUhIyMDZ2dn2rRpw5EjR/J8/+jRowQGBt7x/aGhoYSHh+d5bfXq1XTo0KG4odk3JxO0HgEjd8EDM8Gnibqg5D9TYHIzWPoaJMVqHaXdcDLo+WpYK+pWdScuKZ2nftrFtUwZii2EEPbMqiRm9OjRbNq0iejoaKKiohgzZgwRERE8/PDDALz55pssXLiQH374gePHj/PVV1/x999/8/zzz+e28cgjjzBq1Kjc5y+//DKrV6/mk08+4fDhw3zyySesWbOGV155xTaf0N4ZnKDZIHjuHxi6EGq0VUcz7ZoJP98PFovWEdoNb1cjPz7ahopuRv49e5XXF0VisUh9jBBC2CurkpgLFy4wfPhwGjRoQI8ePdi+fTsrV64kLCwMgAEDBvDtt9/y6aef0qxZM2bMmMHixYvp2LFjbhsxMTHExt64gtChQwcWLFjArFmzCA4OZvbs2SxcuNCx5oixBZ0OGvSGJ1bDo8vA5AUXD0P0Jq0jsyuBld35bngIRoOO5VFxTFpzVOuQhBBCFJFVNTEzZ84scJ/HH3+cxx9//I7fj4iIuOW1QYMGMWjQIGtCKb90OqjVUb06s+tH2Psz1Ln9yC9xe21rV+KjAc1487d/mbbuOHWrenB/y+pahyWEEMJKsoq1vWr1iPr14F+QdlnbWOzQgyEBPNulLgBvLf6X3aevaByREEIIa0kSY6/8WoBvM7U+JmqR1tHYpbd6NaBn42pkZlt45uddnLmcpnVIQgghrCBJjL3S6aDl9asxe36SRSSLQK/XMWlwCxr7eZGQksmTc3aRnC4zdwohhL2QJMaeBT8IBhNc2A/n92odjV1yNzkx89EQfDxNHLmQzMsLIjHLiCUhhLALksTYM9eK0Li/ur3nJ21jsWN+3q788EgIJic96w7H89HyQ1qHJIQQohAkibF3rYarX6N+g8xUbWOxY80DKvDlQy0AmLn5FPN3xGgbkBBCiAJJEmPvAjtCxdqQmQwH/9Q6Grt2T7Afr4fVB2DsH/vZcjxB44iEEELkR5IYe6fX37gaI7eUim1k9yDub+FPtkXh2V92c/JiitYhCSGEuANJYhxB82Gg00PMVrgoM9AWh06n4+MHgmlVswJJ6dk8MWcXiWmZWoclhBDiNiSJcQReflCvl7q992dtY3EALkYD3w0PoXoFV04lpPL83D1kmWWNKiGEKGskiXEUOTP47psP2XLloLiqepqY+WgI7s4Gtpy4xLt/HkCRuXiEEKJMkSTGUdTrCR7VIPUiHF2pdTQOoaGvF9OGtUSvg/k7Ypi5+ZTWIQkhhLiJJDGOwuAELYap23JLyWa6N6zGmHsaAzBh+SHWHb6gcURCCCFySBLjSFpeH6V0fA1cPattLA7k8btqMbRtTRQFXpy3l8NxSVqHJIQQAkliHEvluuq8MYoFIudpHY3D0Ol0vN+/CR3qViY108zzc/eQmS2FvkIIoTVJYhxNToHv3p/BIr9obcVo0PPNw62o4uHMyYupzNkSrXVIQghR7kkS42ga3wcmb0iMgVMbtI7GoVRwc+at3g0BmLL2GPHJ6RpHJIQQ5ZskMY7G6Kqubg0yg28JGNSqBs1reJOSkc1nK49oHY4QQpRrksQ4opxbSoeXQtplbWNxMHq9jvfuawLAot1niTyTqG1AQghRjkkS44j8mqsPcyb8u1DraBxOq5oVGdiqOgDj/jqAxSKT4AkhhBYkiXFULW9aFFJmmrW5//VuiLuzgcgziSzZe07rcIQQolySJMZRNXsQnFwg/iCc2611NA7Hx8uFF3vUA+DjlYdJycjWOCIhhCh/JIlxVK4VoPH96rYU+JaIx+6qRe0q7lxMzmDaumNahyOEEOWOJDGOrNX1W0r7F0NGiraxOCCTk4Gx9zYC4MfNpzh5UfpYCCFKkyQxjizwLqhUBzJT4MASraNxSN0bVqNbg6pkmRU+XHZI63CEEKJckSTGkel0eWfwFSVi7L2NMRp0rDscz/rD8VqHI4QQ5YYkMY6u+TDQGeDMdog/rHU0DqlOVQ8ev6s2AO8vPSjrKgkhRCmRJMbReVaD+r3VbbkaU2JGdg+iioeJUwmpzPrnlNbhCCFEuSBJTHmQc0tp33zIztQ2Fgfl6WLkf33UdZWmrj1GfJKsqySEECVNkpjyIOhu8PCFtEtwZLnW0TisgS2r0zygAqmZZj6RdZWEEKLESRJTHhicoOXD6rbMGVNi9Hod4/o1BmDxnrPsjbmicURCCOHYJIkpL1r+n/r1xDpIPKNtLA6sZc2KDGpdA5B1lYQQoqRJElNeVKoDtToBCkTO1Toah/ZW7wZ4mJzYd/Yqi/ec1TocIYRwWJLElCetRqhf9/4CFrO2sTgwH08XXuoRBMAnK4+QnJ6lcURCCOGYrEpipk+fTnBwMF5eXnh5eREaGsqKFStyv//oo4+i0+nyPNq3b59vm7Nnz77lPTqdjvR0Gd1hc436gUsFuHoGTkZoHY1De7RDbepUcSchJYNp645rHY4QQjgkq5KYGjVq8PHHH7Nr1y527dpF9+7d6d+/PwcOHMjdp3fv3sTGxuY+li8veDSMl5dXnvfExsbi4uJi/acR+TO6QPBD6rYU+JYoZyc9Y68X+f64+RQnZF0lIYSwOauSmH79+tG3b1/q169P/fr1mTBhAh4eHmzbti13H5PJhK+vb+6jUqVKBbar0+nyvMfX19f6TyIKJ2fOmMPLIDVB21gcXLcGPnRv6EO2ReH9vw+iKFLkK4QQtuRU1DeazWYWLVpEamoqoaGhua9HRETg4+NDhQoV6NKlCxMmTMDHxyfftlJSUggMDMRsNtOiRQs++OADWrZsme97MjIyyMjIyH2elJQEQFZWFllZtqtByGnLlm1qqnJDDH4t0MdGYt47D0u757SO6LYcpd9H9a7HpmMX2XD0IqsPxNK9QVWtQ8qXo/S7vZF+14b0uzb+2+/F6X+dYuWfh1FRUYSGhpKeno6Hhwfz5s2jb9++ACxcuBAPDw8CAwM5deoUY8eOJTs7m927d2MymW7b3rZt2zh+/DjNmjUjKSmJKVOmsHz5cvbt20e9evXuGMe4ceMYP378La/PmzcPNzc3az5SuVMrYR3Nz8wmyaU66xt+pC4UKUrMX6f1rD2vp4qLwqjmZpyknF4IIXKlpaUxbNgwrl69ipeXl1XvtTqJyczMJCYmhsTERBYvXsyMGTPYsGEDjRs3vmXf2NhYAgMDWbBgAQMHDixU+xaLhVatWtG5c2emTp16x/1udyUmICCAhIQEqzshP1lZWYSHhxMWFobRaLRZu5pKT8JpShN02dfIHrECpUYbrSO6hSP1e0pGNj0nb+ZiSiZvhNXjmc61tQ7pjhyp3+2J9Ls2pN+18d9+T0pKokqVKkVKYqy+neTs7ExQkDp8NCQkhJ07dzJlyhS+++67W/b18/MjMDCQY8eOFbp9vV5PmzZtCnyPyWS67dUdo9FYIidjSbWrCWNlaDIA9s3D6d+5ULuD1hHdkSP0e0Wjkf/1acTri/YxfcNJHmxTk2peZbtw3RH63R5Jv2tD+l0bOf1enL4v9oVtRVHyXBG52aVLlzhz5gx+fn5WtRcZGWnVe0QRtBquft2/BDKStY2lHBjQsjota15fV2nFYa3DEUIIh2BVEjN69Gg2bdpEdHQ0UVFRjBkzhoiICB5++GFSUlJ444032Lp1K9HR0URERNCvXz+qVKnCgAEDctt45JFHGDVqVO7z8ePHs2rVKk6ePElkZCRPPPEEkZGRPPvss7b7lOJWNUOhchBkpcL+37WOxuGp6yo1AeD3vefYfVrWVRJCiOKy6nbShQsXGD58OLGxsXh7exMcHMzKlSsJCwvj2rVrREVF8dNPP5GYmIifnx/dunVj4cKFeHp65rYRExODXn8jd0pMTOTpp58mLi4Ob29vWrZsycaNG2nbtq3tPqW4lU6nDrcOf1edM6b1iILfYzGrw7JT4iAlHlIuQPJN2ykXIDtdnVSv1aPgXrnEP4Y9aR5QgYdCavDrrrOM//sAfzx/F3q9FFULIURRWZXEzJw5847fc3V1ZdWqVQW2ERERkef5pEmTmDRpkjVhCFtpPhTWvg/ndsHxNWB0uzUpyXkkX4C0BFAsBbd7fi9EfALNHoR2T4Nf85L/LHbizV4NWREVx79nr/Lb7rM81CZA65CEEMJuFXmeGOEAPHygfm84vBR+eaBw79Hpwb2q+l6PauDhq257Xv+akQI7Z0BsJET+oj5qhkK7Z6DhvWAo38VzVT1NvHx3PT5cdohPVx2mdzNfvFzKd58IIURRSRJT3t31MpxYr257VruemPj8Jzm56TW3ymAo4LRp+X9wdids/xYO/gkxW9WHV3UIeRxaPwruVUr8o5VVj4TWYt6OGE5eTOWb9Sf4X5+GWockhBB2SZKY8i6gLYw6C3obzsCm06ntBrSFpFjY9aP6SDoH6z6ADZ9Cs0Hq1ZlyeKvJ2UnPqD6NeOqnXfyy7TTPd6srV2OEEKIIZO5QYdsE5r+8/KD7GHjtIAz4DvxagDkDIufCd53hx97q6Chz+Zr2u0dDH4J8PEjJyGb+9hitwxFCCLskSYwoHU4maD4Eno6AJ8Kh6SDQO6m3mX57DCYHw8bPys2ilHq9jqc71QFg1j/RZGYXomBaCCFEHpLEiNKVc6tp0Ex4ZT90eVstFE4+D+s+hC8bw5LnIHaf1pGWuP4t/fHxNBGXlM5f+85rHY4QQtgdSWKEdrz8oNtoePWAeqvJv6V6q2nfPIw/9uCuYx+pNTUOyuRk4NG7agHww8aTWLmMmRBClHuSxAjt5dxqemo9PLEGmg5C0TtRJeUwTj/3gyuntY6wxDzcLhB3ZwNHLiQTcfSi1uEIIYRdkSRGlB06HQS0gUEzyX52K6nOPugSo9Xi34TCLyJqT7xdjQxpWxOA7zec1DgaIYSwL5LEiLKpYm021x+DUqW+Wi8zqw/E7dc6qhLxeMfaGPQ6tp68RNTZq1qHI4QQdkOSGFFmpRsrkv1/f4FvMKRehNl94ewurcOyueoVXOkXrK7a/t3GExpHI4QQ9kOSGFG2uVeBEX9DjbaQfhV+6g+nNmkdlc093bkuAMujYjlzOU3jaIQQwj5IEiPKPtcKMHwJ1O4MmSkwdxAcC9c6Kptq7O9Fp3pVsCgwc/MprcMRQgi7IEmMsA8mDxi2SF2wMjsd5g9V12VyIE93Vie/W7jzDFdSMzWORgghyj5JYoT9MLrA4F+gyQCwZMGiR2HfAq2jspmOQVVo7OfFtSwzv2xz3GHlQghhK5LECPtiMMIDM6HF/4FigSXPwM6ZWkdlEzqdLvdqzJyt0aRnmTWOSAghyjZJYoT90RvgvmnQ9hn1+bLX4J+p2sZkI/cE++Hv7UJCSia/7zmndThCCFGmSRIj7JNeD30+gY6vqc/Dx8L6iWDnU/cbDXoe71gbgBmbTmKx2PfnEUKIkiRJjLBfOh3c/R50H6s+3/AxrH7H7hOZIW1r4unixMmEVMIPXdA6HCGEKLMkiRH2r/Mb0PsTdXvrV7D0VbBYtI2pGDxMTvxf+0AAvt8oSxEIIcSdSBIjHEP7Z+G+rwAd7J4FfzwL5mytoyqyxzrUwtmgZ/fpK+w+fVnrcIQQokySJEY4jlbDYdBM0DvBvwth0QjIztA6qiLx8XLh/pb+AHwnC0MKIcRtSRIjHEvTB9S5ZAwmOLwU5g+BTPucxj9nuHX4oQucvJiicTRCCFH2SBIjHE+DPvDwr2B0gxPr4JcHID1J66isFuTjSY+GPigK/LBJliIQQoj/kiRGOKY6XdX1lkxeELMFfhlol7eWcq7GLN5zlovJ9he/EEKUJElihOOq2V5dAdulApzdCesnaB2R1drWrkTzgApkZlv4aWu01uEIIUSZIkmMcGz+LaD/1+r2P1MherOm4VhLp9PxzPWrMT9vO01apv2OuBJCCFuTJEY4vkb3QsvhgAJLnoX0q1pHZJVeTXwJrOxGYloWv+48o3U4opwwWxQ2Hr1IxJF4Dp5P4mJyBmaZQVqUMU5aByBEqeg9EaI3wZVoWP4mDPxe64gKzaDX8WTH2oz98wAzNp/i/9oH4mSQvz9EyTken8Kbv+1jb0xintcNeh2V3Z2p6mnCx9NE1esPH0+XW15zc5ZfL6LkyVkmygeTJwz8AX7spc4hU7+XOhzbTgxqHcCkNcc4e+UaK/bH0a+5v9YhCQdktijM2HSSL8KPkpltwdPkRPWKriSkZHApNROzRSE+OYP45AwOFNCWh8lJTWg8TFT1MlGjoivPdK5LJXfnUvksonyQJEaUHwFtodMbsPFTdWmCgPbgXV3rqArF1dnA8PaBTFl7jO83nuTeYD90Op3WYQkHcjw+mTcW/UvkmUQAujaoysSBzfDzdgUg22zhUmomF5MzuJicQXxy+k3b6teLKRnEJ2VwLctMSkY2KRnZnEpIzT2GxaIw5p7GWnw84aAkiRHlS5e34PgaOL8H/ngOhv+hrohtBx4JDeTbDSeIOneVrScv0aFuFa1DEg7AbFH4YdNJvsy5+uLixNh7G/Ng6xp5EmUng55qXi5U83LJtz1FUUjNNBOflJ6b2Ow+fYVZ/0SzPCqO0X0bSQIubMY+fnoLYSsGo3pbyegGpzbA9ulaR1RolT1MPBhSA5CFIYVtHI9P5oHpW/h4xWEysy10a1CV1a925qGQgCInGjqdDg+TE3WqetCuTmXuDfbnrV4NcTUaOJd4jf3n7G/iSVF2SRIjyp8qQdDr+pwxa8bDhYPaxmOFJzvWQaeDiCMXORKXrHU4wk5lmy18u+EEfaduJvJMIp4uTnw2KJgfH22Te/vIllydDXRtUBWAFftjbd6+KL+sSmKmT59OcHAwXl5eeHl5ERoayooVK3K//+ijj6LT6fI82rdvX2C7ixcvpnHjxphMJho3bsySJUus/yRCWKP1Y1C/N5gz4Pen7GY231pV3OndxBeQqzGiaI7HJ/PAt1vzXH0Jf7ULDxbj6kth9G6qnrcr98ehKDJUW9iGVUlMjRo1+Pjjj9m1axe7du2ie/fu9O/fnwMHbtSp9+7dm9jY2NzH8uXL821z69atDB48mOHDh7Nv3z6GDx/OQw89xPbt24v2iYQoDJ0O7psGblXgwn5Y94HWERVazlIEf+07R9zVdI2jEfYi22xheoR69WXf9asvnz/YnB8fbYOvd/51LrbQvaEPzgY9JxNSORYvC5oK27AqienXrx99+/alfv361K9fnwkTJuDh4cG2bdty9zGZTPj6+uY+KlWqlG+bkydPJiwsjFGjRtGwYUNGjRpFjx49mDx5cpE+kBCF5uGjJjIAW76CUxu1jaeQWtasSNtalcgyK8z6RxaGFAU7dkG9+vLJSvXqS/eGPoS/2oVB/yneLUmeLkY61lOL0VdExZXKMYXjK/LoJLPZzKJFi0hNTSU0NDT39YiICHx8fKhQoQJdunRhwoQJ+Pj43LGdrVu38uqrr+Z5rVevXgUmMRkZGWRk3LgFkJSkFotlZWWRlZVVhE90ezlt2bJNUbBS6/e6YRhaDEcf+TPKkmfJfmojuHiX7DFt4PG7arIj+jJzt8fwTKdaeLrYZqChnO/aKKl+zzZbmPnPaaasO06WWcHTxYl3+jZgQAt/dDpdqf87hzWqyrrD8ayIOs/zXWqV6rFvR853bfy334vT/zrFypuTUVFRhIaGkp6ejoeHB/PmzaNv374ALFy4EA8PDwIDAzl16hRjx44lOzub3bt3YzKZbtues7Mzs2fPZtiwYbmvzZs3j8ceeyxPkvJf48aNY/z48be8Pm/ePNzc3Kz5SKKcM5jT6XpkLB4ZFzhTMZQ9tZ7TOqQCWRT4eJ+BC9d09A80091fagxEXnFpMPe4gZhU9UpL4woWBtexUOH2P4pLRWoWvLPLgAUd77TIpqrta4iFHUpLS2PYsGFcvXoVLy8vq95r9Z9vDRo0IDIyksTERBYvXsyIESPYsGEDjRs3ZvDgwbn7NW3alJCQEAIDA1m2bBkDBw68Y5v/vZypKEqBlzhHjRrFa6+9lvs8KSmJgIAAevbsaXUn5CcrK4vw8HDCwsIwGo02a1fkr7T7XdcqEGVOXwKubMWvy6MoTcr+bL7XfM8y+o+DbL/ixsTHOmG0wVIEcr5rw5b9nnv1ZYd69cXLxYl3+jbk/hZlY4LEpVd2seXEZTJ8GtG3U21NY5HzXRv/7fecOylFYXUS4+zsTFBQEAAhISHs3LmTKVOm8N13392yr5+fH4GBgRw7duyO7fn6+hIXl/f+aHx8PNWqVcs3DpPJdNurO0ajsUROxpJqV+Sv1Pq9Vnt1IryIiTiteAtqdwTvGiV/3GJ4IKQmk9aeIC4pg5UHLzKwle3ilfNdG8Xpd4tFYd3heCavPZo7F0v3hj5MHNiswAnqSlPfZv5sOXGZ1Ycu8kL3+lqHA8j5rpWcfi9O3xf7TzdFUe542+fSpUucOXMGPz+/O74/NDSU8PDwPK+tXr2aDh06FDc0IazT6Q2oHgIZV9XVri0WrSPKl8nJwKMdagHqcGsZtlo+ZZst/Bl5jj5TNvHkT7vYfy4JLxcnvnyoOTNHhJSpBAagZ5Nq6HSw70wi5xOvaR2OsHNWJTGjR49m06ZNREdHExUVxZgxY4iIiODhhx8mJSWFN954g61btxIdHU1ERAT9+vWjSpUqDBgwILeNRx55hFGjRuU+f/nll1m9ejWffPIJhw8f5pNPPmHNmjW88sorNvuQQhSKwUld3dropq54ve1rrSMq0P+1C8TN2cDhuGR+2XZa63BEKcrINjNvewzdv9jAywsiOXIhGQ+TE891rcu6N7oysFXpjTyyho+nCyGBFQF1zhghisOq20kXLlxg+PDhxMbG4u3tTXBwMCtXriQsLIxr164RFRXFTz/9RGJiIn5+fnTr1o2FCxfi6emZ20ZMTAz6m9aq6dChAwsWLOCdd95h7Nix1K1bl4ULF9KuXTvbfUohCqtyXeg9Ef5+Gda+D3W6gW9TraO6I283I091qsOUtccY++cBrl7L4oVuQWXyl5ewjdSMbOZtj+GHTSeJT1avgldyd+bxu2oxPLQW3q5l/7ZI76Z+7Iy+wsr9cTzeUdu6GGHfrEpiZs6cecfvubq6smrVqgLbiIiIuOW1QYMGMWjQIGtCEaLktBoBR1fBkeXqbL5PrQdj2bokf7NX7q5HltnCNxEn+Hz1UeKTM3ivXxMMeklkHMmV1Exmb4lmztZoEtPUIal+3i483bkOg9sE4OZsP+v59m7qywdLD7Lz9GUuJmdQ1VPDIVPCrtnPWS9EadHpoN9UOLsT4g+qs/nmrLVUBul0Ot7q3RAfTxPjlx7kp62nSUjJYNLgFpicDFqHJ4rpQlI6MzadZO72GNIyzQDUruLOc13qcn/L6jg72d8SeNUruNK8hjf7zl5l9cE4Hm4XqHVIwk7Z39kvRGnwqAr9r9fEbP0KTkZoGk5hPHpXbaYNbYnRoGN5VByP/riTpHSZxMtenb6Uyqjfo+j0yXp+2HSKtEwzjfy8+GpYS9a81oWH2gTYZQKTo9dNaykJUVT2+z9AiJJWv5e6UCTAkufg2hVt4ymEe4P9mf1YWzxMTmw9eYkh320jPlnWV7Inh+OSeHnBXrp9HsH8HTFkmi2EBFZk1mNtWP5SR+4N9neIW4V9mqqjVreeuERiWqbG0Qh7JUmMEPnpNQEq1YXk87D0NbCDYcx3BVVhwdPtqeJh4mBsEg9M38KphFStwxIFiE6GZ37ZS+/Jm/gz8jwWBbrUr8qvz4Ty23Md6NbAx6EKtmtXcaehryfZFoXwgxe0DkfYKUlihMiPszsM/AF0BjjwO0Qt0jqiQmla3Zvfn+tAYGU3zly+xqDpW/j3bKLWYYnbOJWQyuNzdjNpvxPrjlxEp4N7mvmx9MWOzHm8LW1r57+Irj3rff2W0qoDcktJFI0kMUIUpEZr6Po/dXvZG5AYo208hVSzshu/PduBptW9uJSayZDvt7Hx6EWtwxLXZWSbmbLmGL0mb2TT8UvodQoPtPJnzWtd+PrhVjStXvYXIi2unFtKG48lkJKRrXE0wh5JEiNEYXR8DWq0UWfzXf6m1tEUWlVPEwueDqVjUBXSMs08Pnsnf+w9p3VY5d6W4wn0mbyJSWuOkplt4a66lRnd3MzHA5pSt6qH1uGVmvrVPKhdxZ3MbAvrDsdrHY6wQ5LECFEYBie47yt1+1g4pF3WNh4reJic+PHRNtzX3J9si8IrCyOZsemk1mGVSxeTM3h1YSTDZmznZEIqVT1NTBvaklkjWpXLFZ11Ol3uLaWV+2M1jkbYI0lihCgsn4bg0xgUs5rI2BFnJz2TB7fg8bvU2VE/XHaIicsPYbGU/UJlR2CxKMzdfpoeX0SwZO85dDp4JDSQNa91oV9zf4cq2LVWn+tJzPrDF7l2fR4cIQpLkhghrNGgr/r1yDJt4ygCvV7H2Hsb8b8+DQH4buNJ3li0jyxz2V7o0t4dPJ/EA99uYcyS/SSlZ9PE34s/nr+L9/s3tYslAkpas+reVK/gyrUsMxuPSc2WsI4kMUJYo+H1JOb4Wsi+/ertZZlOp+PZLnX54sHmGPQ6ft97jifn7CJViiptLjUjmwnLDtLvq83sjUnE3dnAu/c25s8X7qJ5QAWtwysz8t5SklFKwjqSxAhhDb+W4OkPmSlwaqPW0RTZA61rMOOREFyNBjYcvciwGdu5nCoTjtnK6gNxhH25gR82ncJsUejT1Je1r3fl8Y61cTLIj93/yrmltObQBTKz5cqgKDz53ySENfR6aNBH3T68VNtYiqlbQx/mPdWOim5G9p1JZND0LZy9ck3rsOza2StpPDlnF0//vJvzV9OpUdGVWY+2Yfr/tcbXu+wuIqq1VjUrUtXTRHJ6Nv+cSNA6HGFHJIkRwlo5t5SOrACLff/V2LJmRX57rgPVK7hyMiGVwT/s4JxM7mu1LLOF7zeeIOzLjaw5dAEnvY7nu9Yl/NUudGvoo3V4ZZ5er6NXk2oArIySW0qi8CSJEcJatTqBsyekXIDze7SOptjqVvVg8XMdaFDNk/jkDCbvNzB13XGSZfHIQtl9+jL9pm3mo+WHuZZlpm2tSix/uRNv9W6Iq7OsIl5YORPfhR+6QLYUm4tCkiRGCGs5maDe3er2YfsbpXQ7vt4u/PpsKO1rVyTTomPa+pN0+nQ93288QXqWDHu9ncS0TEb9HsUD07dyOC6Zim5GPh0UzMJn2lO/mqfW4dmddrUrUdHNyOXUTHZE2888TEJbksQIURQN7lG/HlmubRw25O1qZM6jITxW30ydKu4kpmXx0fLDdPlsPb9sO61dwWVWOhxfAyllY/itoij8vucsPb7YwPwd6hIUD4XUYO3rXXkoJKBcz/lSHE4GPWGNr99SklFKopAkiRGiKOqFgd4JLh6GSye0jsZm9HodLSorLBsZymeDgqlewZULSRm888d+7v5yA7/vOYu5tCbIy0iGf6bClGD45QH4a2TpHDcfJy6mMOyH7bz26z4upWZSz8eDhU+359NBzank7qx1eHbv5qHWMhGjKAwnrQMQwi65VoBaHeFkhHo1psOLWkdkU04GPQ+GBHBfC38W7jzD1LXHibmcxmu/7mN6xAle79mAXk2qlcxVh7TLsP072P4tpCfeeD36H7WQWl/6f3ulZ5n5Zv1xvt1wkkyzBRejnpd61OPJjnVwdpK/BW3lrqAqeJqciE/OYO+ZRFoHVtQ6JFHGyf8+IYoq55aSg9TF3I7JycAjobXY+FZX3u7dEG9XI8fiU3j2l93c//U/bDp2EUWx0V/MSbGwagxMagobPlYTmEp1od9UcHKFzGS4XPpXvTYevUivyRuZuu44mWYLXRtUJfzVLjzfNUgSGBszORno3kgdzSVrKYnCkP+BQhRVznwxZ7ZDqmPPbeHm7MRzXeuy8a1uvNg9CDdnA/vOXmX4zB0M/WEbu09fKXrjl0/C3y+rt422fgVZqeDbDB6cDSN3QusR4Bes7ns+0hYfp1Dik9J5cf5eHvlxB6cvpVHNy8T0h1sx69E2BFRyK7U4ypucie9W7I+zXYIsHJYkMUIUVYUA8A0GxQJHV2odTanwdjXyes8GbHyrG4/fVRtng55tJy/zwPQtPDF7J4dikwrf2IUDsPhJmNYads8GcybUDIWHf4NnNkGTAaC/PkTZr4X69fxeW3+kW5gtCj9vjabHFxv4e9959Dp47K5arHmtC32a+UnhbgnrUt8HF6Oes1euceC8FeeTKJekJkaI4mh4D8T9C4eXQ8v/0zqaUlPFw8S7/RrzZKfaTFt3jF93nWXt4XjWHo6nX3N/Xr27HnWqetz+zWd2wqYv4OiKG68FhUGn1yCww+3f499C/RobacuPcYv9564yZkkU+85eBSC4hjcfDWhG0+reJXpccYOrs4Gu9X1YeSCOFftjpe9FvuRKjBDFkbOq9Yl1kJmmbSwa8K/gysSBwax5rQv9mvsD8Pe+84RN2sj/Fv/LgfNXuZZpBkVR+2j2vTDz7usJjE692vLMRvi/3+6cwMCNKzGx+0pkluSUjGze//sg9321mX1nr+JpcuL9/k1Y8vxd8ktUA32ayYKQonDkSowQxeHbDLxrwtUYdaRSzpIE5UztKu5MG9qS57rU5cvwI6w5FM+CnWdYuPM0PfW7edn0F40VtSjXrHMiNrA/me1fxK9OcOFmta1SH4xu6sKbl45D1fo2iVtRFFbuj2P83weJS0oHoF9zf8be0wgfL1nrSCvdG/rgbNBz4mIqxy4kU08mDxR3IEmMEMWh06mJy/Zv4ciycpvE5Gjs78WMEW3YffoKW//+kT4JM6nLOVDgmuLMfHN3fsi+h9jDleHweeA8vl4uBFZ2o3YVdwIru1O7ihuBld2pVdn9RoJjcFITxjPb1VtKNkhizlxO490/97P+iDqJXmBlN97v35Qu9asWu21RPJ4uRjrWq8K6w/Gs2B8nSYy4I0lihCiuBjlJzEqwmG8Uo5ZjrdP+oXXC+wAoJi8uNHyEPX5DuJpsot2lVE5dSuP0pVQS07KIS0onLimd7adunWq+mpeJWtcTmgezAglhO/t3beBARnvcnJ1wNxlwd3bC3eSEm7Mh96ubsxMG/e0LcDOzLczYfJKpa4+RnmXBaNDxXJe6PN8tCBej/NuVFb2b+uYmMS/1qKd1OKKMkiRGiOIK7AAu3pCWAGd2QGCo1hFp60o0/Pm8ut1yOLpeH+Hr4kVf4L/XqRLTMom+lEZ0QirRl1KJTsib4FxIyuBCUgbbT10mW1+JEGdIjd7F20ejCgzD1WjA3aQmNDcnOOeuXONkgrpUd/s6lfjw/mYE+dyhCFloJqxRNQx6HYdikzh9KZXAyu5ahyTKIElihCgugxHq9YKoX9VbSuU5icnOhEWPQfpVqNEG7p2k9s8dVHBzpoWbMy0CKtzyvZsTnNOX0nC+rMDBb2luOM3dDaqQkmUhLdNMakY2qRlmUjOzScs05y6LcC3LzLUsM5B5S9uV3Z0Zc08jBrSsLkOmy6iK7s60r1OJf45fYuX+OJ7pUlfrkEQZJEmMELbQsK+axBxeDmEfqLUy5VH4u3B+D7hUgEE/5pvAFOSWBMdSBya64ZKVxox7K962LkZRFDKybyQ3aZlmUjKySctUE520zGwUBXo08qGCm6x1VNb1burHP8cvsUKSGHEHksQIYQtBd4PBWZ0WP+EoVG2gdUSl79DfsH26uj3gW6hQ07bt6w0FFvfqdDpcjAZcjAZZkNEB9GpSjXf/3E/kmURir17Dz9tV65BEGSPzxAhhCyZPqN1Z3XbgtZTu6Eo0/PGCut3hxRtLMtha7sy9kSXTvihTfDxdCLm+CKTMGSNuR5IYIWyloeMvCHlbOXUwGdfrYHq8V3LH8m+pfi2F5QdE2dC7qR+grqUkxH9ZlcRMnz6d4OBgvLy88PLyIjQ0lBUrVtx232eeeQadTsfkyZPzbXP27NnodLpbHunp6daEJoT26l+/+nBuFySXox+44WNvqoOZVaw6mALlLD8Q92+JzNwryp5eTaoBsDP6MheTMzSORpQ1ViUxNWrU4OOPP2bXrl3s2rWL7t27079/fw4cOJBnvz/++IPt27fj7+9fqHa9vLyIjY3N83BxkdkyhZ3x8oPqrdXtI7dP7h3Owb/UOXIABnynLopZkv47c69weDUquhFcwxtFgfCDF7QOR5QxViUx/fr1o2/fvtSvX5/69eszYcIEPDw82LZtW+4+586dY+TIkcydOxejsXB/kel0Onx9ffM8hLBLOWspHVmubRyl4fIp+HOkut3hJWjQu+SPmVPcCyW+GKQoO3o3VX8nrNgfq3Ekoqwp8ugks9nMokWLSE1NJTRUnRfDYrEwfPhw3nzzTZo0aVLotlJSUggMDMRsNtOiRQs++OADWrZsme97MjIyyMi4cWkxKUldsj0rK4usrKwifKLby2nLlm2Kgtltvwf1wrjuA5STG8hOvQLO9jWJWqH7PTsDw6JH0WdcxVK9DebOo6CU/q30vs0xnNmO+ewuLI0GlMoxS5rdnu+lJKxhFT5deYStJy6RkJSGt6ttbllKv2vjv/1enP63OomJiooiNDSU9PR0PDw8WLJkCY0bNwbgk08+wcnJiZdeeqnQ7TVs2JDZs2fTrFkzkpKSmDJlCnfddRf79u2jXr07TzU9ceJExo8ff8vrq1evxs3NzdqPVaDw8HCbtykKZnf9rij0cPbBIzOevb99QWyFNlpHVCQF9XvTs79Q92IkmQZ3IioM5dqq0vt3CrgErYArByL4J8uxrnjZ3fleivzcDMSmwaRf19C2qmLTtqXftZHT72lpaUVuQ6coilVnQ2ZmJjExMSQmJrJ48WJmzJjBhg0buHbtGvfccw979uzJrYWpVasWr7zyCq+88kqh27dYLLRq1YrOnTszderUO+53uysxAQEBJCQk4OXlZc1HyldWVhbh4eGEhYUV+vaYKD577nf9mrEYtk/H0uwhzPd9o3U4VilMv+sO/43T4scAyH5oLkq9XqUZIlw8jPH7jijO7mS/cQp09j/I0p7P99Iydd1xpq0/SY+GVfn24fyv1BeW9Ls2/tvvSUlJVKlShatXr1r9+9vqKzHOzs4EBQUBEBISws6dO5kyZQqNGjUiPj6emjVvTHBlNpt5/fXXmTx5MtHR0YVqX6/X06ZNG44dO5bvfiaTCZPJdMvrRqOxRE7GkmpX5M8u+73xfbB9Ovpjq9HrKdnROiXkjv1++RQsfVnd7vASTo3vLd3AAHwbg9ENXWYqxqunbbKidVlhl+d7KbmneXWmrT/JpuOXyLDo8DDZbq5W6fdCuHoOEk+ra8XZSE6/F6fvi/0njKIoZGRkMHz4cP79918iIyNzH/7+/rz55pusWrXKqvYiIyPx8/MrbmhCaCOgHbhVhvREiNmqdTS2k50Bix6FjCT1M/Z4V5s49AbwDVa3Zb6YcqNBNU9qV3EnM9vC+sPxWodTvqRfhbkPwk/91aVVyhCrkpjRo0ezadMmoqOjiYqKYsyYMURERPDwww9TuXJlmjZtmudhNBrx9fWlQYMbU7A/8sgjjBo1Kvf5+PHjWbVqFSdPniQyMpInnniCyMhInn32Wdt9SiFKk94A9a+P1Clj/+GLZfVYdUSQa8Vir4tUbDnzxcgIpXJDp9PljlKS2XtLUXYm/PoIxB9Q/+/7NtU6ojysSmIuXLjA8OHDadCgAT169GD79u2sXLmSsLCwQrcRExNDbOyNYXKJiYk8/fTTNGrUiJ49e3Lu3Dk2btxI27ZtrQlNiLIld6j1MrCu7KxsOvAH7PhO3R7wHXjX0DQcWX6gfOpzPYlZfySe9CyzxtGUA4oCf78EJyPA6A7DfrX9mmjFZNVNxZkzZ1rV+O3qYCIiIvI8nzRpEpMmTbKqXSHKvLrdwMkFEmPgwoEy99eLVS6fhL9eVLfvehnql3Ih7+3kmbnXrF79Eg6vWXVvqldw5VziNX7ZdponO9XROiTHFjER9s0HnQEemnPj/10ZYv9l/UKURc7uUKebum3PE9/lqYNpD93Hah2RSmbuLZd0Oh0ju6sDSz5ffYTohFSNI3Jge36GDZ+o2/d+CfUKf8elNEkSI0RJaXj9lpI9Lwi5+h2I3QeulWDQzLIz0ipPcW+kpqGI0jWkTQB3BVUmPcvC24v/xWJxgNu1Zc3xNfD39VGInd6A1o9qGk5+JIkRoqTU7wPo1OLTq2dL7jjbpsPUVvDrCNj+HcRev8VSXAf+gB3fq9tloQ7mv6S4t1zS6XR8PDAYV6OB7acuM3dHjNYhOZbYf9WfJYoZggdD93e0jihfksQIUVI8qqpDkaHkFoTcPQdW/g8un4CDf8CKt+C7TvBJLfjlAdj4OZzeAllWrgp/5dRNdTCvQP2eNg7cBnKLe2WYdXkTUMmNt3uro14/Xn6Is1eKPuOruEniGXUodWYK1OoE930FOp3WUeXLdrMFCSFu1bAvnNmm3lJq+5Rt2z70Nyx9Rd1u8yR4+sLprXBmh1rDcnyN+gAwOKsrbNcMVSerCmgLLt63bVZvycRp8eM31cGU0b/E/K/P2horxb3l0SOhtVj6byy7Tl9h1O9R/PR4W3Rl/BdumXYtUU1gUuKgaiMY/As4OWsdVYEkiRGiJDW4B8LfhejN6oRRd0gcrHZqE/z2BCgWaDkc+n5+4y8mixku7FcTmpgt6tfUeHXivZitsPlLQAfVmkJg6I3ExlMdvtrk3AJ0CVHX62A0ng8mP1XqqcM+s1LV4t6qDQp+j3AYer2OTwcF02fKJjYdS2DRrrM81CZA67DsU3Ym/DocLh4CD194eBG4VtA6qkKRJEaIklQlSB1Jk3AUjoVDs0HFbzN2H8wfCuYMaHgv3Ds57yVfvQH8mquP9s+qcz1cPqneVorZpiY2l0/ChSj1kVP3UrE2hqqNqJNw/erNwO/Bu3rx4y0pegP4NlOvdJ2PlCSmHKpT1YPXe9bno+WH+WDZQTrXr4qvt4vWYdkXRVFvHZ/aCM4e8PCvUMF+kkGpiRGipOVOfGeDodaXTqi1LpnJENgRHpgJhgL+FtHpoHJdaDUc7v8aXtoLrx+BB2dD22fURAAdXDmF/qgao7nDy2V2SGUeOcW9UhdTbj3RsQ7NAyqQnJ7NmCVRWLmmsVg/Af5dcGMuGL/mWkdkFUlihChpDe9Rvx4LVy/bFlVyHPwyEFIvQrVmMHQeGIv4V6enLzQZAH0/hWc3w/9Ow8OLMXd4lcO+92PpMqrgNsqC3LqYSE3DENox6HV8NigYo0HH2sPx/LXvvNYh2Y/dc2DjZ+p2v8kQdLem4RSFJDFClLTqIeDuoxbKRm8qWhvXEuGXQXAlGirWgv9bbLv6GlDbqnc3lm5jOOI3EPR2cqc5Z4SSrYaVC7tUv5onL3WvB8B7fx3gYnKGxhHZgWPhsPRVdbvzW9DqEW3jKSJJYoQoaXo9NOijbhflllLWNVgwTK1fcfeB4UvAs5ptY7RX/y3uFeXWs13r0tjPi8S0LN77a7/W4ZRt5yNvmgtmCHQbrXVERSZJjBClIeeW0pEV1i0Iac5WRyGd/gdMXuoVmEqyXkyunOJekLqYcs5o0PPZg8E46XUsj4pjeVRswW8qjxJjYN5DauJfuwvcN63MzwWTH0lihCgNtbuoVwySzhW+fkNRYOnL6krYBhMMnQ9+wSUapl3KqYuR5QfKvSb+3jzXtS4A7/65nyupxahBc0S5c8FcAJ/GMPhnu5gLJj+SxAhRGowuENRd3T5cyFtKa8fD3l9Ap1fna6nVseTis2ey/IC4ycjuQdTz8SAhJZPxfx/QOpyyIzsDFv4fXDwMnn7qXDC2rKvTiCQxQpSWBjm3lAqRxGz5CjZPUrf7TYFG95ZcXPZOinvFTUxOBj4dFIxeB39EnmfNwQtah6Q9RYE/X1AHFjh7qglMWVsLrYgkiRGitNTvpc7FcGG/OsroTvYtgNVj1O0e79ntqIFSc3Nxb8IxraMRZUDLmhV5spNaOzbmjyiuXsvSOCKNrfsAohapow4fmnOjjswBSBIjRGlxq6RO7w93vqV0dBX88by63f4F6Phq6cRmz/SGG7VCcktJXPdaWH1qV3HnQlIGHy07pHU42tk1CzZ9oW73mwJBPbSNx8YkiRGiNOU3e2/MtpuGPQ6Gnh/a9aiBUpW7onWkllGIMsTFqN5W0ulg4a4zbDp2UeuQSt+xcFj2urrd5X/Q8v+0jacESBIjRGlqeD2JOb0F0i7feP3CQXXYY/Y1CAqD/l+r88uIwpHiXnEbbWpVYkRoLQD+tziKlIxsbQMqTRePwm+Pq38UNR8GXf+ndUQlQn5KClGaKtYCnybqD5Zjq9XXrpxWlxNIvwo12qr3rMvqytFlVe7yA/ukuFfk8WavBtSo6Mq5xGt8suKw1uGUjvSr6gSZGUnqKvX9pjjsVV1JYoQobTlXYw4vg5SL8PMASI6Fqg1h2EJwdtc2PntUOeh6cW+aFPeKPNxNTnzygFoz9fO202w7eUnjiEqYxQyLn4JLx8CrOjz0k93PBZMfSWKEKG05dTHH18LcQXD5BHgHwP/9rhb/CutJca/Ix11BVRjatiYAby/+l2uZDny1bv0EOLYKnFxgyFzw8NE6ohIlSYwQpc2/JXj6q0OCYyPBrbK6HpJ3da0js29S3CvyMapvQ/y8XTh9KY3PVx/ROpyScWDJjZFI9027cZvVgUkSI0Rp0+lu3FIyuqsTT1Wpp21MjiB3+QFZQ0ncysvFyEcD1PlRfvznFLtPX9E4IhuLi7oxPUPoSAh+SNt4SokkMUJo4a6XodmD8H+/QfXWWkfjGHJGKMXJzL3i9ro19GFgq+ooCrz12z4yshzkPEm9pBbyZqVBnW5w93itIyo1ksQIoYUKNeGBGTcmvxPFJ8W9ohDevbcxVT1NnLiYylcRJ7UOp/jM2fDbo+rq1BVrqeusGZy0jqrUSBIjhHAMNxf3yi0lcQcV3Jz58P6mAPywOZozKRoHVFyr34FTG9UEfsj8cjc4QJIYIYTjyJ0vJlLTMETZ1quJL/cG+2G2KMw9YbDf20qR82D7dHV74HdQrbG28WhAkhghhOOQEUqikMbf14SKbkZi03R8tNIORyud3Q1/v6Jud3kbGvXTNBytSBIjhHAcUtwrCqmyh4nPB6mjlebtOMvf+85rHJEVkuNg4cNgzoAG96jrIpVTksQIIRxHnuLeo1pHI8q4zvWqcHd1CwCjfo/iVEKqxhEVQnYGLByuzvJdpQEM+LZcr7NWfj+5EMLx6A3g11zdlltKohD6BlgICaxASkY2L8zdQ3pZro9RFFj+BpzdAS7eMHQ+uHhpHZWmJIkRQjgWWdFaWMGgg0kPBVPJ3ZmDsUl8uOyg1iHd2c4ZsOcn0OnhgR+hcl2tI9KcJDFCCMcixb3CSr5eLkwa3AKAX7bFlM36mOh/YOX12pce70G9u7WNp4ywKomZPn06wcHBeHl54eXlRWhoKCtWrLjtvs888ww6nY7JkycX2O7ixYtp3LgxJpOJxo0bs2TJEmvCEkKIG0qruPfwcljwMKwZB/t/h0snwGIpueOJEtWlflVe6KZe2fjf4n/LVn1M4hn49RGwZEPTQeqM3wIAq6b1q1GjBh9//DFBQUEAzJkzh/79+7N3716aNGmSu98ff/zB9u3b8ff3L7DNrVu3MnjwYD744AMGDBjAkiVLeOihh9i8eTPt2rWz8uMIIcq9ykHg7AGZKWpxr08j2x8j5SIseQYykvK+7uwB1Zqqk+75NgPfYPX4TibbxyBs7tW767Mz+go7Tl3m+bl7WPJ8B1yMBm2DykxTlxRIS1DPp/umqeuvCcDKKzH9+vWjb9++1K9fn/r16zNhwgQ8PDzYtm1b7j7nzp1j5MiRzJ07F6PRWGCbkydPJiwsjFGjRtGwYUNGjRpFjx49CnUFRwghbqE3qD/soeRuKa0dryYwVRtC60fV9a+cXNTE6cw22PE9/PUifN8FPvKH6R1hyXOwbbp6WyD9asnEJYrFyaBn2tCWVHZ35lBsEh8s1bg+RlHU8yjuX3W1+yFzwdlN25jKmCIvsGA2m1m0aBGpqamEhoYCYLFYGD58OG+++WaeKzP52bp1K6+++mqe13r16lVgEpORkUFGRkbu86Qk9S+irKwssrKyrPgk+ctpy5ZtioJJv2vDUfpd79sMQ8wWzOf2YGkyyKZt687vxbD3F3RAdp8vUAKuXzG2ZMOl4+ji/kV3YT+6C1Ho4qLQpSfChSj1sW9ebjtKhVoovs1QqjXFXKUxLllXyMrMtGmsIn+3O98ruRr4bFBTnvhpD3O3x9C6pjf9gv00iU+/dSqG/b+h6J0wD/wRxd0P7Pz/Jtza78X5eWN1EhMVFUVoaCjp6el4eHiwZMkSGjdWpzr+5JNPcHJy4qWXXip0e3FxcVSrVi3Pa9WqVSMuLi7f902cOJHx429dqXP16tW4udk+Uw0PD7d5m6Jg0u/asPd+r3EZWgOJB9ezOXu57RpWFDod+4BKKJyp2IE9UZcg6r/tewDtoWJ7qKDgmnUJ77TTeF+7/kiLwS3rErrEaHSJ0XD4bwxALyD98FiuuNbkqmsgiW6BJLkGkmKqpo5GESXmdud7mL+e1ef0jFr8L5eO7cXHtXRj8kn6l/YnvgAgyn8Ypw5chQM2PJfLgJx+T0tLK3IbVicxDRo0IDIyksTERBYvXsyIESPYsGED165dY8qUKezZswedlffr/ru/oigFtjFq1Chee+213OdJSUkEBATQs2dPvLxsN24+KyuL8PBwwsLCCnV7TNiG9Ls2HKbfE+rBd99RKfMcfXv3Um8x2YAu6lecIo+jGN3x/b/v6OtVtL/Qs9Iu37hacyEKYv9Fd+kYLtlJuCTvxyd5f+6+itEdpVoTlGrqVRvFtxlUlTobW8jvfO9ptjBi9m52RF9hcVxFFj3dtvTqYy6fwOnHkehQsDR/mEb3fEEjB6qD+W+/59xJKQqrkxhnZ+fcwt6QkBB27tzJlClTaNSoEfHx8dSsWTN3X7PZzOuvv87kyZOJjo6+bXu+vr63XHWJj4+/5erMf5lMJkymW/8TG43GEvnhW1LtivxJv2vD7vu9WkNw9kCXmYLx6inbFPdmJMO69wHQdX4dY+WaBbwhH97V1Ef9HoD6Q33V0iX0bhmIU8IBiP0X4qLgwgF0Wanozu5QJzjLoXdSZ2v1C1brf3ybqQ/XCsX4gOXX7c53oxGmDWtF3ymbOByXzMRVx/hoQLOSDyYjGRY9otZc1WiLvt8k9E7OJX9cDeT0e3F+1hS5JiaHoihkZGQwfPhw7r4777j1Xr16MXz4cB577LE7vj80NJTw8PA8dTGrV6+mQ4cOxQ1NCFFe6fXqL/eYLWpxry2SmE1fQEocVKwN7V8ofnv/YdabUKq3glo3jco0q3U2xEVB3L7ryc2/cO0KxB9QH/vm39i/QqCazLR6BOr3snmM5U216/PHjJi1g3nbY2hXuxL9W1QvuQPmFPImHAFPPxj8s1xxK4BVSczo0aPp06cPAQEBJCcns2DBAiIiIli5ciWVK1emcuXKefY3Go34+vrSoEGD3NceeeQRqlevzsSJEwF4+eWX6dy5M5988gn9+/fnzz//ZM2aNWzevNkGH08IUW75t7iexOyFFkOL19alE7D1a3W710dgdCl2eIVicAKfhuoj+EH1NUWBpHM3rtbE/atuX42BxNPq4+QGeOskOOhf8KWpc/2qjOwWxLR1xxn9exRNq3tTt6pHyRxs10w4sES90vbQT+DpWzLHcSBWJTEXLlxg+PDhxMbG4u3tTXBwMCtXriQsLKzQbcTExKC/abGqDh06sGDBAt555x3Gjh1L3bp1WbhwocwRI4QoHv+W6ldbLD+wagyYM6FuD2jQp/jtFYdOB9411EfDvjdev3ZFTWp+exxSL0LMVqjTRbs4HcjLPeqx49Rltp+6zAtz9/DHC3fZvj4mdh+sHKVu3z0eAtratn0HZVUSM3PmTKsav10dTERExC2vDRo0iEGDbDsMUghRzuUsPxAXpc7cW9Ti3mNr4OgK9a/j3h+X3YnGXCtC7c4QFKYO5T62WpIYG8mZP6bvVLU+ZvzfB5k40Ib1MelJ8OsINVGu3wdCbX+70lHJuD0hhGPKmbk3K02dubcosjNvrFfT7lmoWt928ZWUetevjB9fo20cDsbnen2MTgfzd8TwZ+Q52zScUwdz5RR4B8D935TdRLkMkiRGCOGYcop7Qa2LKYod38GlY+BeFbq8ZbvYSlLdbqAzwMXDcOW01tE4lE71qvJiN3V07ujfozhxMaX4je6cAQf/UK/0DZoFbpWK32Y5IkmMEMJx5dTFFGX5geQLEPGJut3jPXDxtllYJcq1IuTMInzcvictLItevrs+7etUIjXTzAtz95CeVYxFRs9HwqrR6nbY+xDQxiYxlieSxAghHFfOitZFKe5d+z5kJquJUIuHbRlVyat3fbqLY3JLydYMeh1Th7Skiofz9fqYA0VrKP0qLHpUrYNp0BfaP2/TOMsLSWKEEI4rp7g39l91zpXCOrsbIn9Rt/t8qt6asif1eqpfT22ArHRtY3FAPl4uTB7c8np9zBn+2GtlfYyiwF8vXa+DqQn9vy5TdTBZZgtxV9OJOnuVtYcusGBHDNPWHmPsH/uJTy5b51OxJ7sTQogyK6e4NzNFLe6t1rjg91gssOJ6/UvwEPsc6lqtqTpZWnIsnP4HgnpoHVGZpNv7E3Xjd4I5TJ2i1wod61Xhxe71mLr2GKOXqPPHBPkUcv6Ym+tgHiydOhhFUUjOyOZicgbxSRlcTMlQt5PTuZickedxOS0TRbl9O/e3rI6PZynNk1QIksQIIRyXXg9+zdVf5LGRhUti/l0I53apyc/d40o6wpKh06mjlPb8BMfCJYm5ncj5OC1/jaaAZf4ZdXI598oFvu1mL/eox85Tl9l68lLu/DGuzgYURSE9y0JqZjapGdmkZphJy8wmNdOMU1wk7SNGYQA2136JbQc8Sd17gLQMM6mZ2aRlqvta7pBEWCvLbCHhesKSnmUp9PsMeh1VPJyp6mnCx9OFqh4mfLxMVPUoWzMISxIjhHBsfi3UJOZ8JLQYlv++Gcmw5j11u/MbUMQFHsuEoOtJzPFw4GOtoylbLh6BZeoCwgo69Kc3ww9dYcg8ddmGQjLodUwZ2oK+UzZz5EIy7T5ag0WB1Mzs217J8CSNpc6jMeizWG1uzdMHWsOB4zb6UIXjaXKiqqcp9+Hj6XLT9o3XK7k5o9eXnVtcdyJJjBDCseUU9xZmmPXGzyDlAlSqY/+FlnW6qrcrLh1Xl02oXFfriMqGzDR1YrmsNCy1OrHBpRddL8xEd+UUzOyp1qc0HVjo5nw8XZgypAUjftxBUvqtdVfuzgbcTE64G/V8kPU1gVnxJBiqsbrOezzoWgF3kxNuzgbcTU65+7oaDRhslEDodTqqejpT1UNNVlydS2kl7lIiSYwQwrHdPHOvOVtdj+h2Eo7D1m/U7V4T7X/hPRcvqBkK0ZvUie8kiVGteBMuHgJ3H8z9vyVp426yH1uN8c9n4MQ6+O0x9Vzp/k6hZ3m+K6gK69/oSlJ6Fu7OTriZDHiYnHBxMty4mrHjB1j+D+iNVHlsPp/XaF2CH7L8sLOSeyGEsFJOcW/2tfxn7l01GixZ6m0YR1kBOmf23mOrtY2jrIicD3t/AZ0eBs0Ej2rq664VYdgi6PCi+nzzlzB/qDoMupACKrnRxN+bWlXc8fF0wc3Z6UYCc35v3vlgJIGxGUlihBCOLae4F+48X8zR1XBs1fX1kSaWqeGuxZIz1Dp6s3obpTyLP5xbB0OX/6nrTN3M4AQ9P4SBP4CTi3o+/NAdLhZxyYoc1xJvrIvU8F5o/1zx2hN5SBIjhHB8ObeUblcXc/P6SO2fgyr1Si2sEle1oboeT3a6msiUV5mpsEitg6F2F7Vo+06CH4LHV4JXdbWeaEYPOLKyaMfNWRcp8TRUqAn9v3KcBLmMkCRGCOH4cot7I2/93vbpcPkEuPtAZztZH6mwcoZaQ/m+pbT8LXUtKY9q8MCMgmtd/FvC0xFqTVFGEswfohZ932nylDvZ8QMc+gv0Rhg0W71tJWxKkhghhOPLWUMpp7g3R3IcbPhU3b57nFoM62iCcla1Drf+l7AjiJynzr6s06sJjIdP4d7n4QOP/AUhTwAKrPtQvZqTUchFH8/tgdVj1O2eH0gdTAmRJEYI4fgq1QVnz1uLe9eMV2fzrd4amg/VLr6SVLszGJzhSrR6e6Q8iT8My15Xt7uOurUOpiBOznDvl9Bvino15eCf6jDsK9H5v+9a4o11kRreC+2eLULwojAkiRFCOD69HvyC1e2cupizu2DfPHXbHtdHKiyTBwTepW6Xp1tKN9fB1OkKnV4velutH4VHl6q3HOMPwPdd4WTE7fdVFPhr5E11MGVrXSRH46D/a4UQ4j9yF4OMVNdHWv6m+rz5MKgRolVUpaM81sUsf/NGHczAHwo958sd1Wyv1sn4t4RrV+Dngeq8Qv+9Rbfjezj0t3rl5sHZ4FqheMcV+ZIkRghRPuTUxZyPhH3z4fwe9RbT3e9pGlapyBlqfXpL4Ws67NneuRA593odzMzC18EUxLs6PLZCXRhUMcOqUfDHczdWCj+3B1bl1MF8qN6mFCVKkhghRPmQM0IpLgrWjFO3u7wJnr5aRVR6KgdBxVpqjcapjVpHU7LiD91UBzMaaneybftGVxjwrTqrs06vJsSz+qjHXfSoOmFio37Q7hnbHlfcliQxQojy4ebi3tR49Rd7u3Iy8ZhOd+NqjCPfUspMVROJ7GtQpxt0eq1kjqPTQejz8H+/q8Omz++Bb0Kv18EEwn0yH0xpkSRGCFE+3FzcC9fXR3LWLp7SljPU+pgDD7XOrYPxtU0dTEHqdoOn1oNPE0CROhgNSBIjhCg/AtqqX+v1gvo9tY2ltNXqqE6nn3RW/UXvaG6ugxk0Ezyqls5xK9WGJ1ZDt3dg2EKo3qp0jisAWcVaCFGe3PUKePpD8INaR1L6nN2gVid10rtjq8GnkdYR2c7NdTDdRqsJW2kyeaj1VaLUyZUYIUT54VoB2j1dfqd/z62LCdc2DlvKTFUXWMypg+lYjPlghN2RJEYIIcqLenerX2O2QnqStrHYyrI3IOHITXUw8mutPJF/bSGEKC8q1VFHZVmy7zzjrD3ZO1eddbm062BEmSFJjBBClCeOMtQ6Tx3MmNKvgxFlgiQxQghRngRdv6V0fI39DrXOSLlRB1O3O3QsoflgRJknSYwQQpQngXeB0Q2SY+HCfq2jsZ6iqFdgEo6Apx8M+F7qYMox+ZcXQojyxOgCtbuo2/Z4SylyLvy74KZ1kaQOpjyTJEYIIcqbejfN3mtPUi/BytHqdrcxUOsubeMRmpMkRgghypucJObMDrh2RdtYrBHxEWRcBd9m0PFVraMRZYAkMUIIUd5UqAlVG4JihhPrtY6mcOIPwa5Z6naviSW/LpKwC1YlMdOnTyc4OBgvLy+8vLwIDQ1lxYoVud8fN24cDRs2xN3dnYoVK3L33Xezffv2fNucPXs2Op3ulkd6enrRPpEQQoiC2dstpVVj1KSr4b1Qu5PW0YgywqokpkaNGnz88cfs2rWLXbt20b17d/r378+BAwcAqF+/Pl999RVRUVFs3ryZWrVq0bNnTy5evJhvu15eXsTGxuZ5uLi4FP1TCSGEyF/OqtbHw8Fi0TaWghwLhxNr1VWiw97XOhpRhli1AGS/fv3yPJ8wYQLTp09n27ZtNGnShGHDhuX5/pdffsnMmTP5999/6dGjxx3b1el0+Pr6WhOKEEKI4qgZCs4ekHoR4vaBf0utI7o9cxasul7M2/5ZqFxX23hEmVLkVazNZjOLFi0iNTWV0NDQW76fmZnJ999/j7e3N82bN8+3rZSUFAIDAzGbzbRo0YIPPviAli3z/w+VkZFBRkZG7vOkJHUdkKysLLKysorwiW4vpy1btikKJv2uDel3bWjT7zoMtbugP7IM8+GVWKo2LcVjF55+5wwMCUdR3CqTHfoqyM93u/fffi9O/+sUxbopG6OioggNDSU9PR0PDw/mzZtH3759c7+/dOlShgwZQlpaGn5+fvzxxx+0adPmju1t27aN48eP06xZM5KSkpgyZQrLly9n37591KtX747vGzduHOPHj7/l9Xnz5uHm5mbNRxJCiHKpZkIELc/8yGW3umxq8J7W4dzCmJ3K3QffwNmcyr4aI4iueucr+sJ+paWlMWzYMK5evYqXl5dV77U6icnMzCQmJobExEQWL17MjBkz2LBhA40bNwYgNTWV2NhYEhIS+OGHH1i3bh3bt2/Hx8enUO1bLBZatWpF586dmTp16h33u92VmICAABISEqzuhPxkZWURHh5OWFgYRqPRZu2K/Em/a0P6XRua9XvSeYzTglHQkf3qYXCrXHrHLgR9+BgMO75DqdqQ7CcjQF/kmwe3Jee7Nv7b70lJSVSpUqVISYzVZ4SzszNBQUEAhISEsHPnTqZMmcJ3330HgLu7O0FBQQQFBdG+fXvq1avHzJkzGTVqVKHa1+v1tGnThmPHjuW7n8lkwmQy3fK60WgskZOxpNoV+ZN+14b0uzZKvd8rB0K1pugu7Md4ehMEP1h6xy5IwjHYNRMAXa+PMJpcS+xQcr5rI6ffi9P3xZ4nRlGUPFdErP3+7faPjIzEz8+vuKEJIYQoSO5Q6zK2BMHqsWDJhnq9IEhuI4nbs+pKzOjRo+nTpw8BAQEkJyezYMECIiIiWLlyJampqUyYMIH77rsPPz8/Ll26xDfffMPZs2d58MEb2f0jjzxC9erVmThxIgDjx4/PvWKTlJTE1KlTiYyM5Ouvv7btJxVCCHGroDDYPEld1dpiLhuTyJ1YD0dXqLePen6odTSiDLMqiblw4QLDhw8nNjYWb29vgoODWblyJWFhYaSnp3P48GHmzJlDQkIClStXpk2bNmzatIkmTZrkthETE4P+phVHExMTefrpp4mLi8Pb25uWLVuyceNG2rZta7tPKYQQ4vYC2oLJG65dhvN7oUaItvGYs28MqW7zJFStr208okyzKomZOXPmHb/n4uLC77//XmAbEREReZ5PmjSJSZMmWROGEEIIWzEYoW43OPiHektJ6yRm708QfxBcKkCXt7WNRZR5snaSEEKUd/V6ql+1rotJvwrrJqjbXUeBWyVt4xFlniQxQghR3gXdrX49vxdS4rWLY+PnkJYAletBmye0i0PYDUlihBCivPOsBn7XZ1Y/vlabGC6fhO3fqtu9Jqi3uYQogCQxQgghtL+lFP4umDOhTrcbsQhRAElihBBC3EgcTqxVRwiVpujNcOhv0Omh10eg05Xu8YXdkiRGCCEEVG8NrhXV4tqzO0vvuBYzrLw+o3vrR6Fa49I7trB7ksQIIYRQJ7mre31m3OPhpXfcffMh7l8weUG3MaV3XOEQJIkRQgihKu26mIxkWPu+ut35TXCvUjrHFQ5DkhghhBCqoB6ADuKiICm25I+3eTKkXICKtaHdMyV/POFwJIkRQgihcq8C1Vup28fXlOyxEmNgyzR1u+cH4GQq2eMJhyRJjBBCiBtK65bSmnFgzoDAjtDw3pI9lnBYksQIIYS4oV6Y+vXEejBnlcwxYrbD/sWADnrLkGpRdJLECCGEuMGvJbhVgcxkiNlm+/YtFlh1fUh1y4dvzBQsRBFIEiOEEOIGvf7GWkolMdR6/29wbjc4e0D3sbZvX5QrksQIIYTIK+eW0jEbJzGZaWotDEDHV8HT17bti3JHkhghhBB51e2uLgEQfxASz9iu3S3TIOkceNeE0Bds164otySJEUIIkZdbJajRRt3eOUOdNyYlXl0ioKiSzsM/k9XtsHFgdC1ulELgpHUAQgghyqB6YXBmu5p45CQfOgO4VwUPH/CoBp7V1K83P3Jec3bP297a9yErDQLaQZOBpf1phIOSJEYIIcStWj8Gsf/C5ZPqrLqpCaCYISVOfRTE2eNGYuNWCQ4vVV/vPVGGVAubkSRGCCHErdyrwOCfbzw3Z0PqRTWhSYm/nsxcgOQLeV9LvgDZ1yAzBS6nwOUTN9oIHqyuli2EjUgSI4QQomAGJ/DyUx/5URQ1gclNbuLUBCfrGrR5onRiFeWGJDFCCCFsR6cDk6f6qBKkdTTCwcnoJCGEEELYJUlihBBCCGGXJIkRQgghhF2SJEYIIYQQdkmSGCGEEELYJUlihBBCCGGXJIkRQgghhF2SJEYIIYQQdkmSGCGEEELYJUlihBBCCGGXJIkRQgghhF2SJEYIIYQQdkmSGCGEEELYJYdZxVpRFACSkpJs2m5WVhZpaWkkJSVhNBpt2ra4M+l3bUi/a0P6XRvS79r4b7/n/N7O+T1uDYdJYpKTkwEICAjQOBIhhBBCWCs5ORlvb2+r3qNTipL6lEEWi4Xz58/j6emJTqezWbtJSUkEBARw5swZvLy8bNauyJ/0uzak37Uh/a4N6Xdt/LffFUUhOTkZf39/9Hrrqlwc5kqMXq+nRo0aJda+l5eXnOQakH7XhvS7NqTftSH9ro2b+93aKzA5pLBXCCGEEHZJkhghhBBC2CVJYgpgMpl47733MJlMWodSrki/a0P6XRvS79qQfteGLfvdYQp7hRBCCFG+yJUYIYQQQtglSWKEEEIIYZckiRFCCCGEXZIkRgghhBB2SZIYIYQQQtglSWIK8M0331C7dm1cXFxo3bo1mzZt0jokhzZu3Dh0Ol2eh6+vr9ZhOZyNGzfSr18//P390el0/PHHH3m+rygK48aNw9/fH1dXV7p27cqBAwe0CdaBFNTvjz766C3nf/v27bUJ1kFMnDiRNm3a4OnpiY+PD/fffz9HjhzJs4+c77ZXmH63xfkuSUw+Fi5cyCuvvMKYMWPYu3cvnTp1ok+fPsTExGgdmkNr0qQJsbGxuY+oqCitQ3I4qampNG/enK+++uq23//000/58ssv+eqrr9i5cye+vr6EhYXlLrQqiqagfgfo3bt3nvN/+fLlpRih49mwYQMvvPAC27ZtIzw8nOzsbHr27ElqamruPnK+215h+h1scL4r4o7atm2rPPvss3lea9iwofK///1Po4gc33vvvac0b95c6zDKFUBZsmRJ7nOLxaL4+voqH3/8ce5r6enpire3t/Ltt99qEKFj+m+/K4qijBgxQunfv78m8ZQX8fHxCqBs2LBBURQ530vLf/tdUWxzvsuVmDvIzMxk9+7d9OzZM8/rPXv2ZMuWLRpFVT4cO3YMf39/ateuzZAhQzh58qTWIZUrp06dIi4uLs+5bzKZ6NKli5z7pSAiIgIfHx/q16/PU089RXx8vNYhOZSrV68CUKlSJUDO99Ly337PUdzzXZKYO0hISMBsNlOtWrU8r1erVo24uDiNonJ87dq146effmLVqlX88MMPxMXF0aFDBy5duqR1aOVGzvkt537p69OnD3PnzmXdunV88cUX7Ny5k+7du5ORkaF1aA5BURRee+01OnbsSNOmTQE530vD7fodbHO+O5VEwI5Ep9Plea4oyi2vCdvp06dP7nazZs0IDQ2lbt26zJkzh9dee03DyMofOfdL3+DBg3O3mzZtSkhICIGBgSxbtoyBAwdqGJljGDlyJP/++y+bN2++5XtyvpecO/W7Lc53uRJzB1WqVMFgMNySicfHx9+SsYuS4+7uTrNmzTh27JjWoZQbOaPB5NzXnp+fH4GBgXL+28CLL77IX3/9xfr166lRo0bu63K+l6w79fvtFOV8lyTmDpydnWndujXh4eF5Xg8PD6dDhw4aRVX+ZGRkcOjQIfz8/LQOpdyoXbs2vr6+ec79zMxMNmzYIOd+Kbt06RJnzpyR878YFEVh5MiR/P7776xbt47atWvn+b6c7yWjoH6/naKc73I7KR+vvfYaw4cPJyQkhNDQUL7//ntiYmJ49tlntQ7NYb3xxhv069ePmjVrEh8fz4cffkhSUhIjRozQOjSHkpKSwvHjx3Ofnzp1isjISCpVqkTNmjV55ZVX+Oijj6hXrx716tXjo48+ws3NjWHDhmkYtf3Lr98rVarEuHHjeOCBB/Dz8yM6OprRo0dTpUoVBgwYoGHU9u2FF15g3rx5/Pnnn3h6euZecfH29sbV1RWdTifnewkoqN9TUlJsc74Xa2xTOfD1118rgYGBirOzs9KqVas8w8OE7Q0ePFjx8/NTjEaj4u/vrwwcOFA5cOCA1mE5nPXr1yvALY8RI0YoiqIOO33vvfcUX19fxWQyKZ07d1aioqK0DdoB5NfvaWlpSs+ePZWqVasqRqNRqVmzpjJixAglJiZG67Dt2u36G1BmzZqVu4+c77ZXUL/b6nzXXT+YEEIIIYRdkZoYIYQQQtglSWKEEEIIYZckiRFCCCGEXZIkRgghhBB2SZIYIYQQQtglSWKEEEIIYZckiRFCCCGEXZIkRgghhBB2SZIYIYQQQtglSWKEEEIIYZckiRFCCCGEXfp/3VV8Z4VupyQAAAAASUVORK5CYII=",
      "text/plain": [
       "<Figure size 640x480 with 1 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "plt.plot(keep_data['Back'], label='Back')\n",
    "plt.plot(keep_data['Real'], label='Real')\n",
    "plt.legend()\n",
    "plt.title('Back vs Pred')\n",
    "plt.grid()\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 108,
   "id": "57889943-dbf6-463c-9e25-21d78c78723b",
   "metadata": {
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>date</th>\n",
       "      <th>Back</th>\n",
       "      <th>Real</th>\n",
       "      <th>2W</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>2024-04-05</td>\n",
       "      <td>36.96</td>\n",
       "      <td>36.299999</td>\n",
       "      <td>36.56</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2024-04-08</td>\n",
       "      <td>36.72</td>\n",
       "      <td>36.049999</td>\n",
       "      <td>36.48</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>2024-04-09</td>\n",
       "      <td>36.56</td>\n",
       "      <td>35.950001</td>\n",
       "      <td>36.36</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>2024-04-10</td>\n",
       "      <td>36.48</td>\n",
       "      <td>35.410000</td>\n",
       "      <td>36.07</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>2024-04-11</td>\n",
       "      <td>36.36</td>\n",
       "      <td>35.430000</td>\n",
       "      <td>36.01</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>2024-04-12</td>\n",
       "      <td>36.07</td>\n",
       "      <td>35.340000</td>\n",
       "      <td>35.76</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>2024-04-15</td>\n",
       "      <td>36.01</td>\n",
       "      <td>35.139999</td>\n",
       "      <td>35.40</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>2024-04-16</td>\n",
       "      <td>35.76</td>\n",
       "      <td>34.840000</td>\n",
       "      <td>34.94</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>2024-04-17</td>\n",
       "      <td>35.40</td>\n",
       "      <td>34.160000</td>\n",
       "      <td>34.75</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>2024-04-18</td>\n",
       "      <td>34.94</td>\n",
       "      <td>34.389999</td>\n",
       "      <td>34.64</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>2024-04-19</td>\n",
       "      <td>34.75</td>\n",
       "      <td>34.340000</td>\n",
       "      <td>34.61</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>2024-04-22</td>\n",
       "      <td>34.64</td>\n",
       "      <td>34.619999</td>\n",
       "      <td>34.60</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>2024-04-23</td>\n",
       "      <td>34.61</td>\n",
       "      <td>34.720001</td>\n",
       "      <td>34.73</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>2024-04-24</td>\n",
       "      <td>34.60</td>\n",
       "      <td>33.669998</td>\n",
       "      <td>34.86</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>2024-04-25</td>\n",
       "      <td>34.73</td>\n",
       "      <td>34.029999</td>\n",
       "      <td>34.96</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>2024-04-26</td>\n",
       "      <td>34.86</td>\n",
       "      <td>33.990002</td>\n",
       "      <td>35.10</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>2024-04-29</td>\n",
       "      <td>34.96</td>\n",
       "      <td>33.950001</td>\n",
       "      <td>35.08</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>2024-04-30</td>\n",
       "      <td>35.10</td>\n",
       "      <td>33.220001</td>\n",
       "      <td>34.43</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18</th>\n",
       "      <td>2024-05-01</td>\n",
       "      <td>35.08</td>\n",
       "      <td>33.200001</td>\n",
       "      <td>34.11</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>2024-05-02</td>\n",
       "      <td>34.43</td>\n",
       "      <td>33.570000</td>\n",
       "      <td>33.83</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>20</th>\n",
       "      <td>2024-05-03</td>\n",
       "      <td>34.11</td>\n",
       "      <td>33.849998</td>\n",
       "      <td>33.84</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21</th>\n",
       "      <td>2024-05-06</td>\n",
       "      <td>33.83</td>\n",
       "      <td>33.680000</td>\n",
       "      <td>33.84</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>22</th>\n",
       "      <td>2024-05-07</td>\n",
       "      <td>33.84</td>\n",
       "      <td>33.959999</td>\n",
       "      <td>33.86</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>23</th>\n",
       "      <td>2024-05-08</td>\n",
       "      <td>33.84</td>\n",
       "      <td>34.220001</td>\n",
       "      <td>34.09</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24</th>\n",
       "      <td>2024-05-09</td>\n",
       "      <td>33.86</td>\n",
       "      <td>34.459999</td>\n",
       "      <td>34.30</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "          date   Back       Real     2W\n",
       "0   2024-04-05  36.96  36.299999  36.56\n",
       "1   2024-04-08  36.72  36.049999  36.48\n",
       "2   2024-04-09  36.56  35.950001  36.36\n",
       "3   2024-04-10  36.48  35.410000  36.07\n",
       "4   2024-04-11  36.36  35.430000  36.01\n",
       "5   2024-04-12  36.07  35.340000  35.76\n",
       "6   2024-04-15  36.01  35.139999  35.40\n",
       "7   2024-04-16  35.76  34.840000  34.94\n",
       "8   2024-04-17  35.40  34.160000  34.75\n",
       "9   2024-04-18  34.94  34.389999  34.64\n",
       "10  2024-04-19  34.75  34.340000  34.61\n",
       "11  2024-04-22  34.64  34.619999  34.60\n",
       "12  2024-04-23  34.61  34.720001  34.73\n",
       "13  2024-04-24  34.60  33.669998  34.86\n",
       "14  2024-04-25  34.73  34.029999  34.96\n",
       "15  2024-04-26  34.86  33.990002  35.10\n",
       "16  2024-04-29  34.96  33.950001  35.08\n",
       "17  2024-04-30  35.10  33.220001  34.43\n",
       "18  2024-05-01  35.08  33.200001  34.11\n",
       "19  2024-05-02  34.43  33.570000  33.83\n",
       "20  2024-05-03  34.11  33.849998  33.84\n",
       "21  2024-05-06  33.83  33.680000  33.84\n",
       "22  2024-05-07  33.84  33.959999  33.86\n",
       "23  2024-05-08  33.84  34.220001  34.09\n",
       "24  2024-05-09  33.86  34.459999  34.30"
      ]
     },
     "execution_count": 108,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "keep_data"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 109,
   "id": "54b2f086-b2c0-4bb5-ac87-8e3e385517e0",
   "metadata": {
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>date</th>\n",
       "      <th>Back</th>\n",
       "      <th>Real</th>\n",
       "      <th>2W</th>\n",
       "      <th>Real_pct_change</th>\n",
       "      <th>Back_change</th>\n",
       "      <th>2W_change</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>2024-04-05</td>\n",
       "      <td>36.96</td>\n",
       "      <td>36.299999</td>\n",
       "      <td>36.56</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2024-04-08</td>\n",
       "      <td>36.72</td>\n",
       "      <td>36.049999</td>\n",
       "      <td>36.48</td>\n",
       "      <td>-0.688705</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>2024-04-09</td>\n",
       "      <td>36.56</td>\n",
       "      <td>35.950001</td>\n",
       "      <td>36.36</td>\n",
       "      <td>-0.277388</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>2024-04-10</td>\n",
       "      <td>36.48</td>\n",
       "      <td>35.410000</td>\n",
       "      <td>36.07</td>\n",
       "      <td>-1.502089</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>2024-04-11</td>\n",
       "      <td>36.36</td>\n",
       "      <td>35.430000</td>\n",
       "      <td>36.01</td>\n",
       "      <td>0.056483</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>2024-04-12</td>\n",
       "      <td>36.07</td>\n",
       "      <td>35.340000</td>\n",
       "      <td>35.76</td>\n",
       "      <td>-0.254022</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>2024-04-15</td>\n",
       "      <td>36.01</td>\n",
       "      <td>35.139999</td>\n",
       "      <td>35.40</td>\n",
       "      <td>-0.565933</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>2024-04-16</td>\n",
       "      <td>35.76</td>\n",
       "      <td>34.840000</td>\n",
       "      <td>34.94</td>\n",
       "      <td>-0.853726</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>2024-04-17</td>\n",
       "      <td>35.40</td>\n",
       "      <td>34.160000</td>\n",
       "      <td>34.75</td>\n",
       "      <td>-1.951780</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>2024-04-18</td>\n",
       "      <td>34.94</td>\n",
       "      <td>34.389999</td>\n",
       "      <td>34.64</td>\n",
       "      <td>0.673301</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>2024-04-19</td>\n",
       "      <td>34.75</td>\n",
       "      <td>34.340000</td>\n",
       "      <td>34.61</td>\n",
       "      <td>-0.145389</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>2024-04-22</td>\n",
       "      <td>34.64</td>\n",
       "      <td>34.619999</td>\n",
       "      <td>34.60</td>\n",
       "      <td>0.815372</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>2024-04-23</td>\n",
       "      <td>34.61</td>\n",
       "      <td>34.720001</td>\n",
       "      <td>34.73</td>\n",
       "      <td>0.288857</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>2024-04-24</td>\n",
       "      <td>34.60</td>\n",
       "      <td>33.669998</td>\n",
       "      <td>34.86</td>\n",
       "      <td>-3.024202</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>2024-04-25</td>\n",
       "      <td>34.73</td>\n",
       "      <td>34.029999</td>\n",
       "      <td>34.96</td>\n",
       "      <td>1.069203</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>2024-04-26</td>\n",
       "      <td>34.86</td>\n",
       "      <td>33.990002</td>\n",
       "      <td>35.10</td>\n",
       "      <td>-0.117535</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>2024-04-29</td>\n",
       "      <td>34.96</td>\n",
       "      <td>33.950001</td>\n",
       "      <td>35.08</td>\n",
       "      <td>-0.117684</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>2024-04-30</td>\n",
       "      <td>35.10</td>\n",
       "      <td>33.220001</td>\n",
       "      <td>34.43</td>\n",
       "      <td>-2.150220</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18</th>\n",
       "      <td>2024-05-01</td>\n",
       "      <td>35.08</td>\n",
       "      <td>33.200001</td>\n",
       "      <td>34.11</td>\n",
       "      <td>-0.060206</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>2024-05-02</td>\n",
       "      <td>34.43</td>\n",
       "      <td>33.570000</td>\n",
       "      <td>33.83</td>\n",
       "      <td>1.114455</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>20</th>\n",
       "      <td>2024-05-03</td>\n",
       "      <td>34.11</td>\n",
       "      <td>33.849998</td>\n",
       "      <td>33.84</td>\n",
       "      <td>0.834074</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21</th>\n",
       "      <td>2024-05-06</td>\n",
       "      <td>33.83</td>\n",
       "      <td>33.680000</td>\n",
       "      <td>33.84</td>\n",
       "      <td>-0.502210</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>22</th>\n",
       "      <td>2024-05-07</td>\n",
       "      <td>33.84</td>\n",
       "      <td>33.959999</td>\n",
       "      <td>33.86</td>\n",
       "      <td>0.831350</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>23</th>\n",
       "      <td>2024-05-08</td>\n",
       "      <td>33.84</td>\n",
       "      <td>34.220001</td>\n",
       "      <td>34.09</td>\n",
       "      <td>0.765613</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24</th>\n",
       "      <td>2024-05-09</td>\n",
       "      <td>33.86</td>\n",
       "      <td>34.459999</td>\n",
       "      <td>34.30</td>\n",
       "      <td>0.701338</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "          date   Back       Real     2W  Real_pct_change  Back_change  \\\n",
       "0   2024-04-05  36.96  36.299999  36.56              NaN            0   \n",
       "1   2024-04-08  36.72  36.049999  36.48        -0.688705            0   \n",
       "2   2024-04-09  36.56  35.950001  36.36        -0.277388            0   \n",
       "3   2024-04-10  36.48  35.410000  36.07        -1.502089            0   \n",
       "4   2024-04-11  36.36  35.430000  36.01         0.056483            0   \n",
       "5   2024-04-12  36.07  35.340000  35.76        -0.254022            0   \n",
       "6   2024-04-15  36.01  35.139999  35.40        -0.565933            0   \n",
       "7   2024-04-16  35.76  34.840000  34.94        -0.853726            0   \n",
       "8   2024-04-17  35.40  34.160000  34.75        -1.951780            0   \n",
       "9   2024-04-18  34.94  34.389999  34.64         0.673301            0   \n",
       "10  2024-04-19  34.75  34.340000  34.61        -0.145389            0   \n",
       "11  2024-04-22  34.64  34.619999  34.60         0.815372            0   \n",
       "12  2024-04-23  34.61  34.720001  34.73         0.288857            0   \n",
       "13  2024-04-24  34.60  33.669998  34.86        -3.024202            0   \n",
       "14  2024-04-25  34.73  34.029999  34.96         1.069203            1   \n",
       "15  2024-04-26  34.86  33.990002  35.10        -0.117535            1   \n",
       "16  2024-04-29  34.96  33.950001  35.08        -0.117684            1   \n",
       "17  2024-04-30  35.10  33.220001  34.43        -2.150220            1   \n",
       "18  2024-05-01  35.08  33.200001  34.11        -0.060206            0   \n",
       "19  2024-05-02  34.43  33.570000  33.83         1.114455            0   \n",
       "20  2024-05-03  34.11  33.849998  33.84         0.834074            0   \n",
       "21  2024-05-06  33.83  33.680000  33.84        -0.502210            0   \n",
       "22  2024-05-07  33.84  33.959999  33.86         0.831350            1   \n",
       "23  2024-05-08  33.84  34.220001  34.09         0.765613            0   \n",
       "24  2024-05-09  33.86  34.459999  34.30         0.701338            1   \n",
       "\n",
       "    2W_change  \n",
       "0           0  \n",
       "1           0  \n",
       "2           0  \n",
       "3           0  \n",
       "4           0  \n",
       "5           0  \n",
       "6           0  \n",
       "7           0  \n",
       "8           0  \n",
       "9           0  \n",
       "10          0  \n",
       "11          0  \n",
       "12          1  \n",
       "13          1  \n",
       "14          1  \n",
       "15          1  \n",
       "16          0  \n",
       "17          0  \n",
       "18          0  \n",
       "19          0  \n",
       "20          1  \n",
       "21          0  \n",
       "22          1  \n",
       "23          1  \n",
       "24          1  "
      ]
     },
     "execution_count": 109,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Вычисляем процентное изменение для столбца 'Real'\n",
    "keep_data['Real_pct_change'] = keep_data['Real'].pct_change()*100\n",
    "\n",
    "# Создаем новые столбцы для 'Back' и '2W'\n",
    "keep_data['Back_change'] = (keep_data['Back'].diff() > 0).astype(int)\n",
    "keep_data['2W_change'] = (keep_data['2W'].diff() > 0).astype(int)\n",
    "\n",
    "keep_data"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 110,
   "id": "a0c81649-4f74-476b-95ab-405d58f7e503",
   "metadata": {
    "tags": []
   },
   "outputs": [],
   "source": [
    "# Наш депозит 1000 бачей\n",
    "result = 0\n",
    "\n",
    "# Запускаем итератор для просмотра результата\n",
    "for i in range(1,len(keep_data)):\n",
    "    if keep_data['Back_change'][i] == 0:\n",
    "        result -= keep_data['Real_pct_change'][i]\n",
    "    elif keep_data['Back_change'][i] != 0:\n",
    "        result += keep_data['Real_pct_change'][i]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 111,
   "id": "d7a08fe6-9d61-4c0a-878c-a7d84596fb7e",
   "metadata": {
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Накапало за 34 дня(дней): 5.49% без плеч\n"
     ]
    }
   ],
   "source": [
    "print(f\"Накапало за {(keep_data['date'].iloc[-1] - keep_data['date'][0]).days} дня(дней): {round(result,2)}% без плеч\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "713c7a07-48c9-4d6a-a6ef-af2203ff38c2",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.10.9"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
